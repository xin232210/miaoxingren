
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/mainUI/scripts/LevelMap.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'a0eb5kxvh5HA5kUEfXyGaEg', 'LevelMap');
// mainUI/scripts/LevelMap.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    lockNode: cc.Node,
    mapNameLabel: cc.Label,
    mapTipLabel: cc.Label,
    lockMapTipLabel: cc.Label,
    battlePanel: cc.Node,
    sweepBtn: cc.Node,
    battleBtn: cc.Node,
    sweepTimesLabel: cc.Label,
    sweepAdNode: cc.Node,
    boxSpineList: [sp.Skeleton],
    boxLabelList: [cc.Label],
    boxRewardPanel: cc.Node,
    rewardParent: cc.Node
  },
  onHideBoxRewardPanel: function onHideBoxRewardPanel() {
    this.boxRewardPanel.active = !1;
  },
  initLevelMap: function initLevelMap(e) {
    this.boxRewardPanel.active = !1;
    this.curBoxId = -1;
    this.stageLevel = e;
    this.levelJson = cc.JsonControl.getLevelJson(this.stageLevel);
    this.curStageLevel = cc.pvz.PlayerData.getStageLevel();
    this.sweepTimes = cc.pvz.PlayerData.getSweepTimes();
    this.maxWave = cc.pvz.PlayerData.getMaxLevelWave();
    this.isLock = this.stageLevel > this.curStageLevel;
    this.isFinish = this.stageLevel < this.curStageLevel;
    this.mapNameLabel.string = this.levelJson.name;
    this.lockNode.active = this.isLock;
    this.mapTipLabel.node.active = !this.isLock;
    this.lockMapTipLabel.node.active = this.isLock;
    this.battlePanel.active = !this.isLock;
    this.sweepBtn.active = this.isFinish;

    if (this.isFinish) {
      this.mapTipLabel.string = cc.pvz.GameConfig.LevelFinishTip;
      this.sweepTimesLabel.string = this.sweepTimes;
      this.sweepTimesLabel.node.active = this.sweepTimes > 0;
      this.sweepAdNode.active = this.sweepTimes <= 0;
    } else {
      if (this.isLock) {
        this.lockMapTipLabel.string = cc.pvz.GameConfig.LevelLockTip.replace("$", this.stageLevel - 1);
      } else {
        this.mapTipLabel.string = cc.pvz.GameConfig.LevelMaxWaveTip.replace("$", this.maxWave);
      }
    }

    this.levelBoxData = cc.pvz.PlayerData.getLevelBoxData(this.stageLevel);

    for (var t = 0; t < this.boxLabelList.length; t++) {
      var i = this.levelJson["wave" + (t + 1)];
      this.boxLabelList[t].string = cc.pvz.GameConfig.LevelBoxTip.replace("$", i);
      var o = this.boxSpineList[t];

      if (this.isLock) {
        o.setAnimation(0, "baoxiang1", !1);
      } else {
        if (1 == this.levelBoxData[t]) {
          o.setAnimation(0, "baoxiang4", !1);
        } else {
          if (i <= this.maxWave || this.isFinish) {
            o.setAnimation(0, "baoxiang2", !0);
          } else {
            o.setAnimation(0, "baoxiang1", !1);
          }
        }
      }
    }
  },
  onClickBox: function onClickBox(e, t) {
    if (!cc.MainUI.isLookAd) {
      var i = parseInt(t);

      if (1 != this.levelBoxData[i - 1]) {
        var o;
        var a = this.levelJson["wave" + i];
        o = !this.isLock && (a <= this.maxWave || this.isFinish);
        var c = this.levelJson["reward" + i];
        var s = Math.floor(c.length / 2);
        var n = 0;
        this.rewardData = [];

        for (var r = 0; r < s; r++) {
          var h = cc.pvz.utils.getRewardItem(c[n], c[n + 1]);
          this.rewardData.push(h);
          n += 2;
        }

        if (o) {
          this.boxRewardPanel.active = !1;
          cc.pvz.PlayerData.updateLevelBoxData(this.stageLevel, i);
          var p = this.boxSpineList[i - 1];
          p.setAnimation(0, "baoxiang3", !1);
          p.setCompleteListener(function () {
            p.setAnimation(0, "baoxiang4", !1);
            p.setCompleteListener(null);
          });
          cc.popupManager.popup("mainUI", "getrewardUI", "UIReward", {
            ad: !1,
            scale: !1
          }, this.rewardData, cc.pvz.GameConfig.UIFromType["关卡宝箱"]);
        } else {
          if (i != this.curBoxId) {
            this.curBoxId = i;
            this.boxRewardPanel.active = !0;
            this.refreshBoxPanelInfo(i);
          } else {
            this.boxRewardPanel.active = !this.boxRewardPanel.active;
          }
        }
      } else {
        cc.popupManager.showToast("奖励已领取");
      }
    }
  },
  refreshBoxPanelInfo: function refreshBoxPanelInfo(e) {
    this.boxRewardPanel.position = cc.v2(this.boxSpineList[e - 1].node.parent.position.x, this.boxRewardPanel.position.y);

    for (var t = 0; t < this.rewardParent.childrenCount; t++) {
      var i = this.rewardParent.children[t];

      if (t < this.rewardData.length) {
        i.active = !0;
        i.getComponent("RewardItem").initBoxRewardItem(this.rewardData[t]);
      } else {
        i.active = !1;
      }
    }
  },
  onClickSweep: function onClickSweep() {
    var e = this;

    if (cc.MainUI.isLookAd) {//
    } else {
      if (cc.pvz.PlayerData.getPower() < cc.pvz.GameConfig.BattlePower) {
        if (cc.pvz.PlayerData.isHaveBuyPowerTimes()) {
          cc.popupManager.popup("mainUI", "powerbuy", "UIPowerBuy", {
            ad: !1,
            scale: !0
          }, cc.pvz.GameConfig.UIFromType["主界面"]);
        } else {
          cc.popupManager.showToast("体力不足");
        }
      } else {
        cc.pvz.PlayerData.usePlayerPower(-5), cc.MainControl.checkPowerInfo(), this.sweepTimes > 0 ? (cc.pvz.PlayerData.addMissionProgress(cc.pvz.GameConfig.MissionType["扫荡关卡n次"], 1), cc.pvz.PlayerData.updateSweepTimes(), this.sweepTimes--, this.sweepTimesLabel.string = this.sweepTimes, this.sweepTimesLabel.node.active = this.sweepTimes > 0, this.sweepAdNode.active = this.sweepTimes <= 0, cc.popupManager.popup("game", "win", "UIGameEnd", {
          ad: !1,
          scale: !0
        }, this, !1), cc.RedControl.onCheckBattleRed()) : (cc.MainUI.isLookAd = !0, cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType["关卡扫荡"], function (t) {
          e.onAdClose(t);
        }));
      }
    }
  },
  onAdClose: function onAdClose(e) {
    cc.MainUI.isLookAd = !1;

    if (e) {
      cc.pvz.PlayerData.addMissionProgress(cc.pvz.GameConfig.MissionType["扫荡关卡n次"], 1);
      cc.popupManager.popup("game", "win", "UIGameEnd", {
        ad: !1,
        scale: !0
      }, this, !1);
      cc.RedControl.onCheckBattleRed();
    }
  },
  onClickBattle: function onClickBattle() {
    if (cc.MainUI.isLookAd) {//
    } else {
      if (cc.pvz.PlayerData.isEnoughArrayTool()) {
        if (cc.pvz.PlayerData.getPower() < cc.pvz.GameConfig.BattlePower) {
          if (cc.pvz.PlayerData.isHaveBuyPowerTimes()) {
            cc.popupManager.popup("mainUI", "powerbuy", "UIPowerBuy", {
              ad: !1,
              scale: !0
            }, cc.pvz.GameConfig.UIFromType["主界面"]);
          } else {
            cc.popupManager.showToast("体力不足");
          }
        } else {
          cc.pvz.PlayerData.usePlayerPower(-cc.pvz.GameConfig.BattlePower), cc.MainControl.checkPowerInfo(), cc.pvz.PlayerData.addMissionProgress(cc.pvz.GameConfig.MissionType["挑战主线章节1次"], 1), cc.MainUI.setClubBtnVisible(!1), cc.pvz.runtimeData.init(0, this.stageLevel), cc.director.loadScene("game1"), cc.pvz.TAUtils.trackBackpack(this.stageLevel);
        }
      } else {
        cc.popupManager.showToast("还有未上阵的卡皮巴拉！");
      }
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9tYWluVUkvc2NyaXB0cy9MZXZlbE1hcC5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsImxvY2tOb2RlIiwiTm9kZSIsIm1hcE5hbWVMYWJlbCIsIkxhYmVsIiwibWFwVGlwTGFiZWwiLCJsb2NrTWFwVGlwTGFiZWwiLCJiYXR0bGVQYW5lbCIsInN3ZWVwQnRuIiwiYmF0dGxlQnRuIiwic3dlZXBUaW1lc0xhYmVsIiwic3dlZXBBZE5vZGUiLCJib3hTcGluZUxpc3QiLCJzcCIsIlNrZWxldG9uIiwiYm94TGFiZWxMaXN0IiwiYm94UmV3YXJkUGFuZWwiLCJyZXdhcmRQYXJlbnQiLCJvbkhpZGVCb3hSZXdhcmRQYW5lbCIsImFjdGl2ZSIsImluaXRMZXZlbE1hcCIsImUiLCJjdXJCb3hJZCIsInN0YWdlTGV2ZWwiLCJsZXZlbEpzb24iLCJKc29uQ29udHJvbCIsImdldExldmVsSnNvbiIsImN1clN0YWdlTGV2ZWwiLCJwdnoiLCJQbGF5ZXJEYXRhIiwiZ2V0U3RhZ2VMZXZlbCIsInN3ZWVwVGltZXMiLCJnZXRTd2VlcFRpbWVzIiwibWF4V2F2ZSIsImdldE1heExldmVsV2F2ZSIsImlzTG9jayIsImlzRmluaXNoIiwic3RyaW5nIiwibmFtZSIsIm5vZGUiLCJHYW1lQ29uZmlnIiwiTGV2ZWxGaW5pc2hUaXAiLCJMZXZlbExvY2tUaXAiLCJyZXBsYWNlIiwiTGV2ZWxNYXhXYXZlVGlwIiwibGV2ZWxCb3hEYXRhIiwiZ2V0TGV2ZWxCb3hEYXRhIiwidCIsImxlbmd0aCIsImkiLCJMZXZlbEJveFRpcCIsIm8iLCJzZXRBbmltYXRpb24iLCJvbkNsaWNrQm94IiwiTWFpblVJIiwiaXNMb29rQWQiLCJwYXJzZUludCIsImEiLCJjIiwicyIsIk1hdGgiLCJmbG9vciIsIm4iLCJyZXdhcmREYXRhIiwiciIsImgiLCJ1dGlscyIsImdldFJld2FyZEl0ZW0iLCJwdXNoIiwidXBkYXRlTGV2ZWxCb3hEYXRhIiwicCIsInNldENvbXBsZXRlTGlzdGVuZXIiLCJwb3B1cE1hbmFnZXIiLCJwb3B1cCIsImFkIiwic2NhbGUiLCJVSUZyb21UeXBlIiwicmVmcmVzaEJveFBhbmVsSW5mbyIsInNob3dUb2FzdCIsInBvc2l0aW9uIiwidjIiLCJwYXJlbnQiLCJ4IiwieSIsImNoaWxkcmVuQ291bnQiLCJjaGlsZHJlbiIsImdldENvbXBvbmVudCIsImluaXRCb3hSZXdhcmRJdGVtIiwib25DbGlja1N3ZWVwIiwiZ2V0UG93ZXIiLCJCYXR0bGVQb3dlciIsImlzSGF2ZUJ1eVBvd2VyVGltZXMiLCJ1c2VQbGF5ZXJQb3dlciIsIk1haW5Db250cm9sIiwiY2hlY2tQb3dlckluZm8iLCJhZGRNaXNzaW9uUHJvZ3Jlc3MiLCJNaXNzaW9uVHlwZSIsInVwZGF0ZVN3ZWVwVGltZXMiLCJSZWRDb250cm9sIiwib25DaGVja0JhdHRsZVJlZCIsIkFkVXRpbHMiLCJzaG93QWRSZXdhcmRWaWRlbyIsIkFkVHlwZSIsIm9uQWRDbG9zZSIsIm9uQ2xpY2tCYXR0bGUiLCJpc0Vub3VnaEFycmF5VG9vbCIsInNldENsdWJCdG5WaXNpYmxlIiwicnVudGltZURhdGEiLCJpbml0IiwiZGlyZWN0b3IiLCJsb2FkU2NlbmUiLCJUQVV0aWxzIiwidHJhY2tCYWNrcGFjayJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQUEsRUFBRSxDQUFDQyxLQUFILENBQVM7RUFDTCxXQUFTRCxFQUFFLENBQUNFLFNBRFA7RUFFTEMsVUFBVSxFQUFFO0lBQ1JDLFFBQVEsRUFBRUosRUFBRSxDQUFDSyxJQURMO0lBRVJDLFlBQVksRUFBRU4sRUFBRSxDQUFDTyxLQUZUO0lBR1JDLFdBQVcsRUFBRVIsRUFBRSxDQUFDTyxLQUhSO0lBSVJFLGVBQWUsRUFBRVQsRUFBRSxDQUFDTyxLQUpaO0lBS1JHLFdBQVcsRUFBRVYsRUFBRSxDQUFDSyxJQUxSO0lBTVJNLFFBQVEsRUFBRVgsRUFBRSxDQUFDSyxJQU5MO0lBT1JPLFNBQVMsRUFBRVosRUFBRSxDQUFDSyxJQVBOO0lBUVJRLGVBQWUsRUFBRWIsRUFBRSxDQUFDTyxLQVJaO0lBU1JPLFdBQVcsRUFBRWQsRUFBRSxDQUFDSyxJQVRSO0lBVVJVLFlBQVksRUFBRSxDQUFDQyxFQUFFLENBQUNDLFFBQUosQ0FWTjtJQVdSQyxZQUFZLEVBQUUsQ0FBQ2xCLEVBQUUsQ0FBQ08sS0FBSixDQVhOO0lBWVJZLGNBQWMsRUFBRW5CLEVBQUUsQ0FBQ0ssSUFaWDtJQWFSZSxZQUFZLEVBQUVwQixFQUFFLENBQUNLO0VBYlQsQ0FGUDtFQWlCTGdCLG9CQUFvQixFQUFFLGdDQUFZO0lBQzlCLEtBQUtGLGNBQUwsQ0FBb0JHLE1BQXBCLEdBQTZCLENBQUMsQ0FBOUI7RUFDSCxDQW5CSTtFQW9CTEMsWUFBWSxFQUFFLHNCQUFVQyxDQUFWLEVBQWE7SUFDdkIsS0FBS0wsY0FBTCxDQUFvQkcsTUFBcEIsR0FBNkIsQ0FBQyxDQUE5QjtJQUNBLEtBQUtHLFFBQUwsR0FBZ0IsQ0FBQyxDQUFqQjtJQUNBLEtBQUtDLFVBQUwsR0FBa0JGLENBQWxCO0lBQ0EsS0FBS0csU0FBTCxHQUFpQjNCLEVBQUUsQ0FBQzRCLFdBQUgsQ0FBZUMsWUFBZixDQUE0QixLQUFLSCxVQUFqQyxDQUFqQjtJQUNBLEtBQUtJLGFBQUwsR0FBcUI5QixFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0JDLGFBQWxCLEVBQXJCO0lBQ0EsS0FBS0MsVUFBTCxHQUFrQmxDLEVBQUUsQ0FBQytCLEdBQUgsQ0FBT0MsVUFBUCxDQUFrQkcsYUFBbEIsRUFBbEI7SUFDQSxLQUFLQyxPQUFMLEdBQWVwQyxFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0JLLGVBQWxCLEVBQWY7SUFDQSxLQUFLQyxNQUFMLEdBQWMsS0FBS1osVUFBTCxHQUFrQixLQUFLSSxhQUFyQztJQUNBLEtBQUtTLFFBQUwsR0FBZ0IsS0FBS2IsVUFBTCxHQUFrQixLQUFLSSxhQUF2QztJQUNBLEtBQUt4QixZQUFMLENBQWtCa0MsTUFBbEIsR0FBMkIsS0FBS2IsU0FBTCxDQUFlYyxJQUExQztJQUNBLEtBQUtyQyxRQUFMLENBQWNrQixNQUFkLEdBQXVCLEtBQUtnQixNQUE1QjtJQUNBLEtBQUs5QixXQUFMLENBQWlCa0MsSUFBakIsQ0FBc0JwQixNQUF0QixHQUErQixDQUFDLEtBQUtnQixNQUFyQztJQUNBLEtBQUs3QixlQUFMLENBQXFCaUMsSUFBckIsQ0FBMEJwQixNQUExQixHQUFtQyxLQUFLZ0IsTUFBeEM7SUFDQSxLQUFLNUIsV0FBTCxDQUFpQlksTUFBakIsR0FBMEIsQ0FBQyxLQUFLZ0IsTUFBaEM7SUFDQSxLQUFLM0IsUUFBTCxDQUFjVyxNQUFkLEdBQXVCLEtBQUtpQixRQUE1Qjs7SUFDQSxJQUFJLEtBQUtBLFFBQVQsRUFBbUI7TUFDZixLQUFLL0IsV0FBTCxDQUFpQmdDLE1BQWpCLEdBQTBCeEMsRUFBRSxDQUFDK0IsR0FBSCxDQUFPWSxVQUFQLENBQWtCQyxjQUE1QztNQUNBLEtBQUsvQixlQUFMLENBQXFCMkIsTUFBckIsR0FBOEIsS0FBS04sVUFBbkM7TUFDQSxLQUFLckIsZUFBTCxDQUFxQjZCLElBQXJCLENBQTBCcEIsTUFBMUIsR0FBbUMsS0FBS1ksVUFBTCxHQUFrQixDQUFyRDtNQUNBLEtBQUtwQixXQUFMLENBQWlCUSxNQUFqQixHQUEwQixLQUFLWSxVQUFMLElBQW1CLENBQTdDO0lBQ0gsQ0FMRCxNQUtPO01BQ0gsSUFBSSxLQUFLSSxNQUFULEVBQWlCO1FBQ2IsS0FBSzdCLGVBQUwsQ0FBcUIrQixNQUFyQixHQUE4QnhDLEVBQUUsQ0FBQytCLEdBQUgsQ0FBT1ksVUFBUCxDQUFrQkUsWUFBbEIsQ0FBK0JDLE9BQS9CLENBQXVDLEdBQXZDLEVBQTRDLEtBQUtwQixVQUFMLEdBQWtCLENBQTlELENBQTlCO01BQ0gsQ0FGRCxNQUVPO1FBQ0gsS0FBS2xCLFdBQUwsQ0FBaUJnQyxNQUFqQixHQUEwQnhDLEVBQUUsQ0FBQytCLEdBQUgsQ0FBT1ksVUFBUCxDQUFrQkksZUFBbEIsQ0FBa0NELE9BQWxDLENBQTBDLEdBQTFDLEVBQStDLEtBQUtWLE9BQXBELENBQTFCO01BQ0g7SUFDSjs7SUFDRCxLQUFLWSxZQUFMLEdBQW9CaEQsRUFBRSxDQUFDK0IsR0FBSCxDQUFPQyxVQUFQLENBQWtCaUIsZUFBbEIsQ0FBa0MsS0FBS3ZCLFVBQXZDLENBQXBCOztJQUNBLEtBQUssSUFBSXdCLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsS0FBS2hDLFlBQUwsQ0FBa0JpQyxNQUF0QyxFQUE4Q0QsQ0FBQyxFQUEvQyxFQUFtRDtNQUMvQyxJQUFJRSxDQUFDLEdBQUcsS0FBS3pCLFNBQUwsQ0FBZSxVQUFVdUIsQ0FBQyxHQUFHLENBQWQsQ0FBZixDQUFSO01BQ0EsS0FBS2hDLFlBQUwsQ0FBa0JnQyxDQUFsQixFQUFxQlYsTUFBckIsR0FBOEJ4QyxFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0JVLFdBQWxCLENBQThCUCxPQUE5QixDQUFzQyxHQUF0QyxFQUEyQ00sQ0FBM0MsQ0FBOUI7TUFDQSxJQUFJRSxDQUFDLEdBQUcsS0FBS3ZDLFlBQUwsQ0FBa0JtQyxDQUFsQixDQUFSOztNQUNBLElBQUksS0FBS1osTUFBVCxFQUFpQjtRQUNiZ0IsQ0FBQyxDQUFDQyxZQUFGLENBQWUsQ0FBZixFQUFrQixXQUFsQixFQUErQixDQUFDLENBQWhDO01BQ0gsQ0FGRCxNQUVPO1FBQ0gsSUFBSSxLQUFLLEtBQUtQLFlBQUwsQ0FBa0JFLENBQWxCLENBQVQsRUFBK0I7VUFDM0JJLENBQUMsQ0FBQ0MsWUFBRixDQUFlLENBQWYsRUFBa0IsV0FBbEIsRUFBK0IsQ0FBQyxDQUFoQztRQUNILENBRkQsTUFFTztVQUNILElBQUlILENBQUMsSUFBSSxLQUFLaEIsT0FBVixJQUFxQixLQUFLRyxRQUE5QixFQUF3QztZQUNwQ2UsQ0FBQyxDQUFDQyxZQUFGLENBQWUsQ0FBZixFQUFrQixXQUFsQixFQUErQixDQUFDLENBQWhDO1VBQ0gsQ0FGRCxNQUVPO1lBQ0hELENBQUMsQ0FBQ0MsWUFBRixDQUFlLENBQWYsRUFBa0IsV0FBbEIsRUFBK0IsQ0FBQyxDQUFoQztVQUNIO1FBQ0o7TUFDSjtJQUNKO0VBQ0osQ0FuRUk7RUFvRUxDLFVBQVUsRUFBRSxvQkFBVWhDLENBQVYsRUFBYTBCLENBQWIsRUFBZ0I7SUFDeEIsSUFBSSxDQUFDbEQsRUFBRSxDQUFDeUQsTUFBSCxDQUFVQyxRQUFmLEVBQXlCO01BQ3JCLElBQUlOLENBQUMsR0FBR08sUUFBUSxDQUFDVCxDQUFELENBQWhCOztNQUNBLElBQUksS0FBSyxLQUFLRixZQUFMLENBQWtCSSxDQUFDLEdBQUcsQ0FBdEIsQ0FBVCxFQUFtQztRQUMvQixJQUFJRSxDQUFKO1FBQ0EsSUFBSU0sQ0FBQyxHQUFHLEtBQUtqQyxTQUFMLENBQWUsU0FBU3lCLENBQXhCLENBQVI7UUFDQUUsQ0FBQyxHQUFHLENBQUMsS0FBS2hCLE1BQU4sS0FBaUJzQixDQUFDLElBQUksS0FBS3hCLE9BQVYsSUFBcUIsS0FBS0csUUFBM0MsQ0FBSjtRQUNBLElBQUlzQixDQUFDLEdBQUcsS0FBS2xDLFNBQUwsQ0FBZSxXQUFXeUIsQ0FBMUIsQ0FBUjtRQUNBLElBQUlVLENBQUMsR0FBR0MsSUFBSSxDQUFDQyxLQUFMLENBQVdILENBQUMsQ0FBQ1YsTUFBRixHQUFXLENBQXRCLENBQVI7UUFDQSxJQUFJYyxDQUFDLEdBQUcsQ0FBUjtRQUNBLEtBQUtDLFVBQUwsR0FBa0IsRUFBbEI7O1FBQ0EsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHTCxDQUFwQixFQUF1QkssQ0FBQyxFQUF4QixFQUE0QjtVQUN4QixJQUFJQyxDQUFDLEdBQUdwRSxFQUFFLENBQUMrQixHQUFILENBQU9zQyxLQUFQLENBQWFDLGFBQWIsQ0FBMkJULENBQUMsQ0FBQ0ksQ0FBRCxDQUE1QixFQUFpQ0osQ0FBQyxDQUFDSSxDQUFDLEdBQUcsQ0FBTCxDQUFsQyxDQUFSO1VBQ0EsS0FBS0MsVUFBTCxDQUFnQkssSUFBaEIsQ0FBcUJILENBQXJCO1VBQ0FILENBQUMsSUFBSSxDQUFMO1FBQ0g7O1FBQ0QsSUFBSVgsQ0FBSixFQUFPO1VBQ0gsS0FBS25DLGNBQUwsQ0FBb0JHLE1BQXBCLEdBQTZCLENBQUMsQ0FBOUI7VUFDQXRCLEVBQUUsQ0FBQytCLEdBQUgsQ0FBT0MsVUFBUCxDQUFrQndDLGtCQUFsQixDQUFxQyxLQUFLOUMsVUFBMUMsRUFBc0QwQixDQUF0RDtVQUNBLElBQUlxQixDQUFDLEdBQUcsS0FBSzFELFlBQUwsQ0FBa0JxQyxDQUFDLEdBQUcsQ0FBdEIsQ0FBUjtVQUNBcUIsQ0FBQyxDQUFDbEIsWUFBRixDQUFlLENBQWYsRUFBa0IsV0FBbEIsRUFBK0IsQ0FBQyxDQUFoQztVQUNBa0IsQ0FBQyxDQUFDQyxtQkFBRixDQUFzQixZQUFZO1lBQzlCRCxDQUFDLENBQUNsQixZQUFGLENBQWUsQ0FBZixFQUFrQixXQUFsQixFQUErQixDQUFDLENBQWhDO1lBQ0FrQixDQUFDLENBQUNDLG1CQUFGLENBQXNCLElBQXRCO1VBQ0gsQ0FIRDtVQUlBMUUsRUFBRSxDQUFDMkUsWUFBSCxDQUFnQkMsS0FBaEIsQ0FDSSxRQURKLEVBRUksYUFGSixFQUdJLFVBSEosRUFJSTtZQUNJQyxFQUFFLEVBQUUsQ0FBQyxDQURUO1lBRUlDLEtBQUssRUFBRSxDQUFDO1VBRlosQ0FKSixFQVFJLEtBQUtaLFVBUlQsRUFTSWxFLEVBQUUsQ0FBQytCLEdBQUgsQ0FBT1ksVUFBUCxDQUFrQm9DLFVBQWxCLENBQTZCLE1BQTdCLENBVEo7UUFXSCxDQXBCRCxNQW9CTztVQUNILElBQUkzQixDQUFDLElBQUksS0FBSzNCLFFBQWQsRUFBd0I7WUFDcEIsS0FBS0EsUUFBTCxHQUFnQjJCLENBQWhCO1lBQ0EsS0FBS2pDLGNBQUwsQ0FBb0JHLE1BQXBCLEdBQTZCLENBQUMsQ0FBOUI7WUFDQSxLQUFLMEQsbUJBQUwsQ0FBeUI1QixDQUF6QjtVQUNILENBSkQsTUFJTztZQUNILEtBQUtqQyxjQUFMLENBQW9CRyxNQUFwQixHQUE2QixDQUFDLEtBQUtILGNBQUwsQ0FBb0JHLE1BQWxEO1VBQ0g7UUFDSjtNQUNKLENBMUNELE1BMENPO1FBQ0h0QixFQUFFLENBQUMyRSxZQUFILENBQWdCTSxTQUFoQixDQUEwQixPQUExQjtNQUNIO0lBQ0o7RUFDSixDQXJISTtFQXNITEQsbUJBQW1CLEVBQUUsNkJBQVV4RCxDQUFWLEVBQWE7SUFDOUIsS0FBS0wsY0FBTCxDQUFvQitELFFBQXBCLEdBQStCbEYsRUFBRSxDQUFDbUYsRUFBSCxDQUMzQixLQUFLcEUsWUFBTCxDQUFrQlMsQ0FBQyxHQUFHLENBQXRCLEVBQXlCa0IsSUFBekIsQ0FBOEIwQyxNQUE5QixDQUFxQ0YsUUFBckMsQ0FBOENHLENBRG5CLEVBRTNCLEtBQUtsRSxjQUFMLENBQW9CK0QsUUFBcEIsQ0FBNkJJLENBRkYsQ0FBL0I7O0lBSUEsS0FBSyxJQUFJcEMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxLQUFLOUIsWUFBTCxDQUFrQm1FLGFBQXRDLEVBQXFEckMsQ0FBQyxFQUF0RCxFQUEwRDtNQUN0RCxJQUFJRSxDQUFDLEdBQUcsS0FBS2hDLFlBQUwsQ0FBa0JvRSxRQUFsQixDQUEyQnRDLENBQTNCLENBQVI7O01BQ0EsSUFBSUEsQ0FBQyxHQUFHLEtBQUtnQixVQUFMLENBQWdCZixNQUF4QixFQUFnQztRQUM1QkMsQ0FBQyxDQUFDOUIsTUFBRixHQUFXLENBQUMsQ0FBWjtRQUNBOEIsQ0FBQyxDQUFDcUMsWUFBRixDQUFlLFlBQWYsRUFBNkJDLGlCQUE3QixDQUErQyxLQUFLeEIsVUFBTCxDQUFnQmhCLENBQWhCLENBQS9DO01BQ0gsQ0FIRCxNQUdPO1FBQ0hFLENBQUMsQ0FBQzlCLE1BQUYsR0FBVyxDQUFDLENBQVo7TUFDSDtJQUNKO0VBQ0osQ0FwSUk7RUFxSUxxRSxZQUFZLEVBQUUsd0JBQVk7SUFDdEIsSUFBSW5FLENBQUMsR0FBRyxJQUFSOztJQUNBLElBQUl4QixFQUFFLENBQUN5RCxNQUFILENBQVVDLFFBQWQsRUFBd0IsQ0FDcEI7SUFDSCxDQUZELE1BRU87TUFDSCxJQUFJMUQsRUFBRSxDQUFDK0IsR0FBSCxDQUFPQyxVQUFQLENBQWtCNEQsUUFBbEIsS0FBK0I1RixFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0JrRCxXQUFyRCxFQUFrRTtRQUM5RCxJQUFJN0YsRUFBRSxDQUFDK0IsR0FBSCxDQUFPQyxVQUFQLENBQWtCOEQsbUJBQWxCLEVBQUosRUFBNkM7VUFDekM5RixFQUFFLENBQUMyRSxZQUFILENBQWdCQyxLQUFoQixDQUNJLFFBREosRUFFSSxVQUZKLEVBR0ksWUFISixFQUlJO1lBQ0lDLEVBQUUsRUFBRSxDQUFDLENBRFQ7WUFFSUMsS0FBSyxFQUFFLENBQUM7VUFGWixDQUpKLEVBUUk5RSxFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0JvQyxVQUFsQixDQUE2QixLQUE3QixDQVJKO1FBVUgsQ0FYRCxNQVdPO1VBQ0gvRSxFQUFFLENBQUMyRSxZQUFILENBQWdCTSxTQUFoQixDQUEwQixNQUExQjtRQUNIO01BQ0osQ0FmRCxNQWVPO1FBQ0hqRixFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0IrRCxjQUFsQixDQUFpQyxDQUFDLENBQWxDLEdBQ0kvRixFQUFFLENBQUNnRyxXQUFILENBQWVDLGNBQWYsRUFESixFQUVJLEtBQUsvRCxVQUFMLEdBQWtCLENBQWxCLElBQ09sQyxFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0JrRSxrQkFBbEIsQ0FBcUNsRyxFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0J3RCxXQUFsQixDQUE4QixRQUE5QixDQUFyQyxFQUE4RSxDQUE5RSxHQUNEbkcsRUFBRSxDQUFDK0IsR0FBSCxDQUFPQyxVQUFQLENBQWtCb0UsZ0JBQWxCLEVBREMsRUFFRCxLQUFLbEUsVUFBTCxFQUZDLEVBR0EsS0FBS3JCLGVBQUwsQ0FBcUIyQixNQUFyQixHQUE4QixLQUFLTixVQUhuQyxFQUlBLEtBQUtyQixlQUFMLENBQXFCNkIsSUFBckIsQ0FBMEJwQixNQUExQixHQUFtQyxLQUFLWSxVQUFMLEdBQWtCLENBSnJELEVBS0EsS0FBS3BCLFdBQUwsQ0FBaUJRLE1BQWpCLEdBQTBCLEtBQUtZLFVBQUwsSUFBbUIsQ0FMN0MsRUFNRGxDLEVBQUUsQ0FBQzJFLFlBQUgsQ0FBZ0JDLEtBQWhCLENBQ0ksTUFESixFQUVJLEtBRkosRUFHSSxXQUhKLEVBSUk7VUFDSUMsRUFBRSxFQUFFLENBQUMsQ0FEVDtVQUVJQyxLQUFLLEVBQUUsQ0FBQztRQUZaLENBSkosRUFRSSxJQVJKLEVBU0ksQ0FBQyxDQVRMLENBTkMsRUFpQkQ5RSxFQUFFLENBQUNxRyxVQUFILENBQWNDLGdCQUFkLEVBbEJOLEtBbUJRdEcsRUFBRSxDQUFDeUQsTUFBSCxDQUFVQyxRQUFWLEdBQXFCLENBQUMsQ0FBdkIsRUFDRDFELEVBQUUsQ0FBQytCLEdBQUgsQ0FBT3dFLE9BQVAsQ0FBZUMsaUJBQWYsQ0FBaUN4RyxFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0I4RCxNQUFsQixDQUF5QixNQUF6QixDQUFqQyxFQUFtRSxVQUFVdkQsQ0FBVixFQUFhO1VBQzVFMUIsQ0FBQyxDQUFDa0YsU0FBRixDQUFZeEQsQ0FBWjtRQUNILENBRkQsQ0FwQk4sQ0FGSjtNQXlCSDtJQUNKO0VBQ0osQ0FyTEk7RUFzTEx3RCxTQUFTLEVBQUUsbUJBQVVsRixDQUFWLEVBQWE7SUFDcEJ4QixFQUFFLENBQUN5RCxNQUFILENBQVVDLFFBQVYsR0FBcUIsQ0FBQyxDQUF0Qjs7SUFDQSxJQUFJbEMsQ0FBSixFQUFPO01BQ0h4QixFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0JrRSxrQkFBbEIsQ0FBcUNsRyxFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0J3RCxXQUFsQixDQUE4QixRQUE5QixDQUFyQyxFQUE4RSxDQUE5RTtNQUNBbkcsRUFBRSxDQUFDMkUsWUFBSCxDQUFnQkMsS0FBaEIsQ0FDSSxNQURKLEVBRUksS0FGSixFQUdJLFdBSEosRUFJSTtRQUNJQyxFQUFFLEVBQUUsQ0FBQyxDQURUO1FBRUlDLEtBQUssRUFBRSxDQUFDO01BRlosQ0FKSixFQVFJLElBUkosRUFTSSxDQUFDLENBVEw7TUFXQTlFLEVBQUUsQ0FBQ3FHLFVBQUgsQ0FBY0MsZ0JBQWQ7SUFDSDtFQUNKLENBdk1JO0VBd01MSyxhQUFhLEVBQUUseUJBQVk7SUFDdkIsSUFBSTNHLEVBQUUsQ0FBQ3lELE1BQUgsQ0FBVUMsUUFBZCxFQUF3QixDQUNwQjtJQUNILENBRkQsTUFFTztNQUNILElBQUkxRCxFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0I0RSxpQkFBbEIsRUFBSixFQUEyQztRQUN2QyxJQUFJNUcsRUFBRSxDQUFDK0IsR0FBSCxDQUFPQyxVQUFQLENBQWtCNEQsUUFBbEIsS0FBK0I1RixFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0JrRCxXQUFyRCxFQUFrRTtVQUM5RCxJQUFJN0YsRUFBRSxDQUFDK0IsR0FBSCxDQUFPQyxVQUFQLENBQWtCOEQsbUJBQWxCLEVBQUosRUFBNkM7WUFDekM5RixFQUFFLENBQUMyRSxZQUFILENBQWdCQyxLQUFoQixDQUNJLFFBREosRUFFSSxVQUZKLEVBR0ksWUFISixFQUlJO2NBQ0lDLEVBQUUsRUFBRSxDQUFDLENBRFQ7Y0FFSUMsS0FBSyxFQUFFLENBQUM7WUFGWixDQUpKLEVBUUk5RSxFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0JvQyxVQUFsQixDQUE2QixLQUE3QixDQVJKO1VBVUgsQ0FYRCxNQVdPO1lBQ0gvRSxFQUFFLENBQUMyRSxZQUFILENBQWdCTSxTQUFoQixDQUEwQixNQUExQjtVQUNIO1FBQ0osQ0FmRCxNQWVPO1VBQ0hqRixFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0IrRCxjQUFsQixDQUFpQyxDQUFDL0YsRUFBRSxDQUFDK0IsR0FBSCxDQUFPWSxVQUFQLENBQWtCa0QsV0FBcEQsR0FDSTdGLEVBQUUsQ0FBQ2dHLFdBQUgsQ0FBZUMsY0FBZixFQURKLEVBRUlqRyxFQUFFLENBQUMrQixHQUFILENBQU9DLFVBQVAsQ0FBa0JrRSxrQkFBbEIsQ0FBcUNsRyxFQUFFLENBQUMrQixHQUFILENBQU9ZLFVBQVAsQ0FBa0J3RCxXQUFsQixDQUE4QixVQUE5QixDQUFyQyxFQUFnRixDQUFoRixDQUZKLEVBR0luRyxFQUFFLENBQUN5RCxNQUFILENBQVVvRCxpQkFBVixDQUE0QixDQUFDLENBQTdCLENBSEosRUFJSTdHLEVBQUUsQ0FBQytCLEdBQUgsQ0FBTytFLFdBQVAsQ0FBbUJDLElBQW5CLENBQXdCLENBQXhCLEVBQTJCLEtBQUtyRixVQUFoQyxDQUpKLEVBS0kxQixFQUFFLENBQUNnSCxRQUFILENBQVlDLFNBQVosQ0FBc0IsT0FBdEIsQ0FMSixFQU1JakgsRUFBRSxDQUFDK0IsR0FBSCxDQUFPbUYsT0FBUCxDQUFlQyxhQUFmLENBQTZCLEtBQUt6RixVQUFsQyxDQU5KO1FBT0g7TUFDSixDQXpCRCxNQXlCTztRQUNIMUIsRUFBRSxDQUFDMkUsWUFBSCxDQUFnQk0sU0FBaEIsQ0FBMEIsYUFBMUI7TUFDSDtJQUNKO0VBQ0o7QUF6T0ksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxvY2tOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBtYXBOYW1lTGFiZWw6IGNjLkxhYmVsLFxuICAgICAgICBtYXBUaXBMYWJlbDogY2MuTGFiZWwsXG4gICAgICAgIGxvY2tNYXBUaXBMYWJlbDogY2MuTGFiZWwsXG4gICAgICAgIGJhdHRsZVBhbmVsOiBjYy5Ob2RlLFxuICAgICAgICBzd2VlcEJ0bjogY2MuTm9kZSxcbiAgICAgICAgYmF0dGxlQnRuOiBjYy5Ob2RlLFxuICAgICAgICBzd2VlcFRpbWVzTGFiZWw6IGNjLkxhYmVsLFxuICAgICAgICBzd2VlcEFkTm9kZTogY2MuTm9kZSxcbiAgICAgICAgYm94U3BpbmVMaXN0OiBbc3AuU2tlbGV0b25dLFxuICAgICAgICBib3hMYWJlbExpc3Q6IFtjYy5MYWJlbF0sXG4gICAgICAgIGJveFJld2FyZFBhbmVsOiBjYy5Ob2RlLFxuICAgICAgICByZXdhcmRQYXJlbnQ6IGNjLk5vZGVcbiAgICB9LFxuICAgIG9uSGlkZUJveFJld2FyZFBhbmVsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYm94UmV3YXJkUGFuZWwuYWN0aXZlID0gITE7XG4gICAgfSxcbiAgICBpbml0TGV2ZWxNYXA6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuYm94UmV3YXJkUGFuZWwuYWN0aXZlID0gITE7XG4gICAgICAgIHRoaXMuY3VyQm94SWQgPSAtMTtcbiAgICAgICAgdGhpcy5zdGFnZUxldmVsID0gZTtcbiAgICAgICAgdGhpcy5sZXZlbEpzb24gPSBjYy5Kc29uQ29udHJvbC5nZXRMZXZlbEpzb24odGhpcy5zdGFnZUxldmVsKTtcbiAgICAgICAgdGhpcy5jdXJTdGFnZUxldmVsID0gY2MucHZ6LlBsYXllckRhdGEuZ2V0U3RhZ2VMZXZlbCgpO1xuICAgICAgICB0aGlzLnN3ZWVwVGltZXMgPSBjYy5wdnouUGxheWVyRGF0YS5nZXRTd2VlcFRpbWVzKCk7XG4gICAgICAgIHRoaXMubWF4V2F2ZSA9IGNjLnB2ei5QbGF5ZXJEYXRhLmdldE1heExldmVsV2F2ZSgpO1xuICAgICAgICB0aGlzLmlzTG9jayA9IHRoaXMuc3RhZ2VMZXZlbCA+IHRoaXMuY3VyU3RhZ2VMZXZlbDtcbiAgICAgICAgdGhpcy5pc0ZpbmlzaCA9IHRoaXMuc3RhZ2VMZXZlbCA8IHRoaXMuY3VyU3RhZ2VMZXZlbDtcbiAgICAgICAgdGhpcy5tYXBOYW1lTGFiZWwuc3RyaW5nID0gdGhpcy5sZXZlbEpzb24ubmFtZTtcbiAgICAgICAgdGhpcy5sb2NrTm9kZS5hY3RpdmUgPSB0aGlzLmlzTG9jaztcbiAgICAgICAgdGhpcy5tYXBUaXBMYWJlbC5ub2RlLmFjdGl2ZSA9ICF0aGlzLmlzTG9jaztcbiAgICAgICAgdGhpcy5sb2NrTWFwVGlwTGFiZWwubm9kZS5hY3RpdmUgPSB0aGlzLmlzTG9jaztcbiAgICAgICAgdGhpcy5iYXR0bGVQYW5lbC5hY3RpdmUgPSAhdGhpcy5pc0xvY2s7XG4gICAgICAgIHRoaXMuc3dlZXBCdG4uYWN0aXZlID0gdGhpcy5pc0ZpbmlzaDtcbiAgICAgICAgaWYgKHRoaXMuaXNGaW5pc2gpIHtcbiAgICAgICAgICAgIHRoaXMubWFwVGlwTGFiZWwuc3RyaW5nID0gY2MucHZ6LkdhbWVDb25maWcuTGV2ZWxGaW5pc2hUaXA7XG4gICAgICAgICAgICB0aGlzLnN3ZWVwVGltZXNMYWJlbC5zdHJpbmcgPSB0aGlzLnN3ZWVwVGltZXM7XG4gICAgICAgICAgICB0aGlzLnN3ZWVwVGltZXNMYWJlbC5ub2RlLmFjdGl2ZSA9IHRoaXMuc3dlZXBUaW1lcyA+IDA7XG4gICAgICAgICAgICB0aGlzLnN3ZWVwQWROb2RlLmFjdGl2ZSA9IHRoaXMuc3dlZXBUaW1lcyA8PSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNMb2NrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NrTWFwVGlwTGFiZWwuc3RyaW5nID0gY2MucHZ6LkdhbWVDb25maWcuTGV2ZWxMb2NrVGlwLnJlcGxhY2UoXCIkXCIsIHRoaXMuc3RhZ2VMZXZlbCAtIDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hcFRpcExhYmVsLnN0cmluZyA9IGNjLnB2ei5HYW1lQ29uZmlnLkxldmVsTWF4V2F2ZVRpcC5yZXBsYWNlKFwiJFwiLCB0aGlzLm1heFdhdmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubGV2ZWxCb3hEYXRhID0gY2MucHZ6LlBsYXllckRhdGEuZ2V0TGV2ZWxCb3hEYXRhKHRoaXMuc3RhZ2VMZXZlbCk7XG4gICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgdGhpcy5ib3hMYWJlbExpc3QubGVuZ3RoOyB0KyspIHtcbiAgICAgICAgICAgIHZhciBpID0gdGhpcy5sZXZlbEpzb25bXCJ3YXZlXCIgKyAodCArIDEpXTtcbiAgICAgICAgICAgIHRoaXMuYm94TGFiZWxMaXN0W3RdLnN0cmluZyA9IGNjLnB2ei5HYW1lQ29uZmlnLkxldmVsQm94VGlwLnJlcGxhY2UoXCIkXCIsIGkpO1xuICAgICAgICAgICAgdmFyIG8gPSB0aGlzLmJveFNwaW5lTGlzdFt0XTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTG9jaykge1xuICAgICAgICAgICAgICAgIG8uc2V0QW5pbWF0aW9uKDAsIFwiYmFveGlhbmcxXCIsICExKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKDEgPT0gdGhpcy5sZXZlbEJveERhdGFbdF0pIHtcbiAgICAgICAgICAgICAgICAgICAgby5zZXRBbmltYXRpb24oMCwgXCJiYW94aWFuZzRcIiwgITEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpIDw9IHRoaXMubWF4V2F2ZSB8fCB0aGlzLmlzRmluaXNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvLnNldEFuaW1hdGlvbigwLCBcImJhb3hpYW5nMlwiLCAhMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvLnNldEFuaW1hdGlvbigwLCBcImJhb3hpYW5nMVwiLCAhMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uQ2xpY2tCb3g6IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIGlmICghY2MuTWFpblVJLmlzTG9va0FkKSB7XG4gICAgICAgICAgICB2YXIgaSA9IHBhcnNlSW50KHQpO1xuICAgICAgICAgICAgaWYgKDEgIT0gdGhpcy5sZXZlbEJveERhdGFbaSAtIDFdKSB7XG4gICAgICAgICAgICAgICAgdmFyIG87XG4gICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLmxldmVsSnNvbltcIndhdmVcIiArIGldO1xuICAgICAgICAgICAgICAgIG8gPSAhdGhpcy5pc0xvY2sgJiYgKGEgPD0gdGhpcy5tYXhXYXZlIHx8IHRoaXMuaXNGaW5pc2gpO1xuICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy5sZXZlbEpzb25bXCJyZXdhcmRcIiArIGldO1xuICAgICAgICAgICAgICAgIHZhciBzID0gTWF0aC5mbG9vcihjLmxlbmd0aCAvIDIpO1xuICAgICAgICAgICAgICAgIHZhciBuID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnJld2FyZERhdGEgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IHM7IHIrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IGNjLnB2ei51dGlscy5nZXRSZXdhcmRJdGVtKGNbbl0sIGNbbiArIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXdhcmREYXRhLnB1c2goaCk7XG4gICAgICAgICAgICAgICAgICAgIG4gKz0gMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG8pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3hSZXdhcmRQYW5lbC5hY3RpdmUgPSAhMTtcbiAgICAgICAgICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEudXBkYXRlTGV2ZWxCb3hEYXRhKHRoaXMuc3RhZ2VMZXZlbCwgaSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0gdGhpcy5ib3hTcGluZUxpc3RbaSAtIDFdO1xuICAgICAgICAgICAgICAgICAgICBwLnNldEFuaW1hdGlvbigwLCBcImJhb3hpYW5nM1wiLCAhMSk7XG4gICAgICAgICAgICAgICAgICAgIHAuc2V0Q29tcGxldGVMaXN0ZW5lcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnNldEFuaW1hdGlvbigwLCBcImJhb3hpYW5nNFwiLCAhMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnNldENvbXBsZXRlTGlzdGVuZXIobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjYy5wb3B1cE1hbmFnZXIucG9wdXAoXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1haW5VSVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJnZXRyZXdhcmRVSVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJVSVJld2FyZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkOiAhMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTogITFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJld2FyZERhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5wdnouR2FtZUNvbmZpZy5VSUZyb21UeXBlW1wi5YWz5Y2h5a6d566xXCJdXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT0gdGhpcy5jdXJCb3hJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJCb3hJZCA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJveFJld2FyZFBhbmVsLmFjdGl2ZSA9ICEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQm94UGFuZWxJbmZvKGkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3hSZXdhcmRQYW5lbC5hY3RpdmUgPSAhdGhpcy5ib3hSZXdhcmRQYW5lbC5hY3RpdmU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLnBvcHVwTWFuYWdlci5zaG93VG9hc3QoXCLlpZblirHlt7Lpooblj5ZcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJlZnJlc2hCb3hQYW5lbEluZm86IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuYm94UmV3YXJkUGFuZWwucG9zaXRpb24gPSBjYy52MihcbiAgICAgICAgICAgIHRoaXMuYm94U3BpbmVMaXN0W2UgLSAxXS5ub2RlLnBhcmVudC5wb3NpdGlvbi54LFxuICAgICAgICAgICAgdGhpcy5ib3hSZXdhcmRQYW5lbC5wb3NpdGlvbi55XG4gICAgICAgICk7XG4gICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgdGhpcy5yZXdhcmRQYXJlbnQuY2hpbGRyZW5Db3VudDsgdCsrKSB7XG4gICAgICAgICAgICB2YXIgaSA9IHRoaXMucmV3YXJkUGFyZW50LmNoaWxkcmVuW3RdO1xuICAgICAgICAgICAgaWYgKHQgPCB0aGlzLnJld2FyZERhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaS5hY3RpdmUgPSAhMDtcbiAgICAgICAgICAgICAgICBpLmdldENvbXBvbmVudChcIlJld2FyZEl0ZW1cIikuaW5pdEJveFJld2FyZEl0ZW0odGhpcy5yZXdhcmREYXRhW3RdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaS5hY3RpdmUgPSAhMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgb25DbGlja1N3ZWVwOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlID0gdGhpcztcbiAgICAgICAgaWYgKGNjLk1haW5VSS5pc0xvb2tBZCkge1xuICAgICAgICAgICAgLy9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjYy5wdnouUGxheWVyRGF0YS5nZXRQb3dlcigpIDwgY2MucHZ6LkdhbWVDb25maWcuQmF0dGxlUG93ZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2MucHZ6LlBsYXllckRhdGEuaXNIYXZlQnV5UG93ZXJUaW1lcygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNjLnBvcHVwTWFuYWdlci5wb3B1cChcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWFpblVJXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInBvd2VyYnV5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlVJUG93ZXJCdXlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZDogITEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6ICEwXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgY2MucHZ6LkdhbWVDb25maWcuVUlGcm9tVHlwZVtcIuS4u+eVjOmdolwiXVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNjLnBvcHVwTWFuYWdlci5zaG93VG9hc3QoXCLkvZPlipvkuI3otrNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYy5wdnouUGxheWVyRGF0YS51c2VQbGF5ZXJQb3dlcigtNSksXG4gICAgICAgICAgICAgICAgICAgIGNjLk1haW5Db250cm9sLmNoZWNrUG93ZXJJbmZvKCksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3dlZXBUaW1lcyA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKGNjLnB2ei5QbGF5ZXJEYXRhLmFkZE1pc3Npb25Qcm9ncmVzcyhjYy5wdnouR2FtZUNvbmZpZy5NaXNzaW9uVHlwZVtcIuaJq+iNoeWFs+WNoW7mrKFcIl0sIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5wdnouUGxheWVyRGF0YS51cGRhdGVTd2VlcFRpbWVzKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3dlZXBUaW1lcy0tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zd2VlcFRpbWVzTGFiZWwuc3RyaW5nID0gdGhpcy5zd2VlcFRpbWVzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMuc3dlZXBUaW1lc0xhYmVsLm5vZGUuYWN0aXZlID0gdGhpcy5zd2VlcFRpbWVzID4gMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnN3ZWVwQWROb2RlLmFjdGl2ZSA9IHRoaXMuc3dlZXBUaW1lcyA8PSAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2MucG9wdXBNYW5hZ2VyLnBvcHVwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJnYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndpblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJVSUdhbWVFbmRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZDogITEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6ICEwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICExXG4gICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNjLlJlZENvbnRyb2wub25DaGVja0JhdHRsZVJlZCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAoKGNjLk1haW5VSS5pc0xvb2tBZCA9ICEwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2MucHZ6LkFkVXRpbHMuc2hvd0FkUmV3YXJkVmlkZW8oY2MucHZ6LkdhbWVDb25maWcuQWRUeXBlW1wi5YWz5Y2h5omr6I2hXCJdLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5vbkFkQ2xvc2UodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgb25BZENsb3NlOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjYy5NYWluVUkuaXNMb29rQWQgPSAhMTtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIGNjLnB2ei5QbGF5ZXJEYXRhLmFkZE1pc3Npb25Qcm9ncmVzcyhjYy5wdnouR2FtZUNvbmZpZy5NaXNzaW9uVHlwZVtcIuaJq+iNoeWFs+WNoW7mrKFcIl0sIDEpO1xuICAgICAgICAgICAgY2MucG9wdXBNYW5hZ2VyLnBvcHVwKFxuICAgICAgICAgICAgICAgIFwiZ2FtZVwiLFxuICAgICAgICAgICAgICAgIFwid2luXCIsXG4gICAgICAgICAgICAgICAgXCJVSUdhbWVFbmRcIixcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGFkOiAhMSxcbiAgICAgICAgICAgICAgICAgICAgc2NhbGU6ICEwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICExXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY2MuUmVkQ29udHJvbC5vbkNoZWNrQmF0dGxlUmVkKCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uQ2xpY2tCYXR0bGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGNjLk1haW5VSS5pc0xvb2tBZCkge1xuICAgICAgICAgICAgLy9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjYy5wdnouUGxheWVyRGF0YS5pc0Vub3VnaEFycmF5VG9vbCgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNjLnB2ei5QbGF5ZXJEYXRhLmdldFBvd2VyKCkgPCBjYy5wdnouR2FtZUNvbmZpZy5CYXR0bGVQb3dlcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2MucHZ6LlBsYXllckRhdGEuaXNIYXZlQnV5UG93ZXJUaW1lcygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5wb3B1cE1hbmFnZXIucG9wdXAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYWluVUlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBvd2VyYnV5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJVSVBvd2VyQnV5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZDogITEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiAhMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MucHZ6LkdhbWVDb25maWcuVUlGcm9tVHlwZVtcIuS4u+eVjOmdolwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnBvcHVwTWFuYWdlci5zaG93VG9hc3QoXCLkvZPlipvkuI3otrNcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjYy5wdnouUGxheWVyRGF0YS51c2VQbGF5ZXJQb3dlcigtY2MucHZ6LkdhbWVDb25maWcuQmF0dGxlUG93ZXIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2MuTWFpbkNvbnRyb2wuY2hlY2tQb3dlckluZm8oKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnB2ei5QbGF5ZXJEYXRhLmFkZE1pc3Npb25Qcm9ncmVzcyhjYy5wdnouR2FtZUNvbmZpZy5NaXNzaW9uVHlwZVtcIuaMkeaImOS4u+e6v+eroOiKgjHmrKFcIl0sIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2MuTWFpblVJLnNldENsdWJCdG5WaXNpYmxlKCExKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnB2ei5ydW50aW1lRGF0YS5pbml0KDAsIHRoaXMuc3RhZ2VMZXZlbCksXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJnYW1lMVwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnB2ei5UQVV0aWxzLnRyYWNrQmFja3BhY2sodGhpcy5zdGFnZUxldmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLnBvcHVwTWFuYWdlci5zaG93VG9hc3QoXCLov5jmnInmnKrkuIrpmLXnmoTljaHnmq7lt7Tmi4nvvIFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcbiJdfQ==