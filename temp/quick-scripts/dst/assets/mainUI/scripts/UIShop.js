
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/mainUI/scripts/UIShop.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c0f5dD1vVhLwrvTe7JqJ8O5', 'UIShop');
// mainUI/scripts/UIShop.js

"use strict";

var i = cc.Class({
  name: "ShopData",
  properties: {
    itemId: 1,
    count: 1,
    toolId: -1,
    buyTimes: 0,
    priceType: 2,
    price: 1,
    discount: 1
  }
});
cc.Class({
  "extends": cc.Component,
  properties: {
    shopJsonFile: cc.JsonAsset,
    shopBoxJsonFile: cc.JsonAsset,
    shopDailyPanel: cc.Node,
    refreshTimesLabel: cc.Label,
    shopCoinList: [cc.Node],
    boxLvLabel: cc.Label,
    boxLvBar: cc.ProgressBar,
    boxLvProgress: cc.Label,
    boxItemList: [cc.Node],
    scrollPanel: cc.ScrollView,
    redTips: [cc.Node]
  },
  onClickRefresh: function onClickRefresh() {
    var e = this;

    if (this.isLookAd) {//
    } else {
      if (this.refreshTimes <= 0) {
        cc.popupManager.showToast("刷新次数不足！");
      } else {
        this.onStopShopScroll(), this.isLookAd = !0, cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType["商店刷新"], function (t) {
          e.onAdClose(t);
        });
      }
    }
  },
  onAdClose: function onAdClose(e) {
    this.isLookAd = !1;

    if (e) {
      cc.pvz.PlayerData.updateShopTimes(cc.pvz.GameConfig.ShopTimesType["商店刷新"]);
      this.refreshTimes = cc.pvz.PlayerData.getShopTimes(cc.pvz.GameConfig.ShopTimesType["商店刷新"]);
      this.refreshTimesLabel.string = this.refreshTimes;
      this.initShopDailyData(!0);
    }
  },
  onClickShopBoxTip: function onClickShopBoxTip() {
    if (this.isLookAd) {//
    } else {
      this.onStopShopScroll();
      cc.popupManager.popup("mainUI", "shopboxTip", "UIShopBoxTip", {
        ad: !1,
        scale: !0
      }, this.shopBoxData.lv, this.shopBoxJson);
    }
  },
  onLoad: function onLoad() {
    cc.UIShop = this;
    this.isLookAd = !1;
    this.shopJson = this.shopJsonFile.json;
    this.shopBoxJson = this.shopBoxJsonFile.json;
  },
  start: function start() {
    this.scrollPanel.node.scale = Math.min(1.4, this.node.width / 720);
    this.scrollPanel.node.height /= this.scrollPanel.node.scale;
  },
  updateRedTip: function updateRedTip() {
    this.redTips[0].active = 1 == cc.pvz.PlayerData.getShopTimes(cc.pvz.GameConfig.ShopTimesType["钻石免费"]);
    this.redTips[1].active = 7 == cc.pvz.PlayerData.getShopTimes(cc.pvz.GameConfig.ShopTimesType["金币免费"]);
  },
  initBy: function initBy() {
    cc.pvz.utils.fadeInBtn(this.node);
    this.node.active = !0;
    this.stageLevel = cc.pvz.PlayerData.getStageLevel();
    cc.pvz.PlayerData.checkAndResetShop();
    this.refreshTimes = cc.pvz.PlayerData.getShopTimes(cc.pvz.GameConfig.ShopTimesType["商店刷新"]);
    this.refreshTimesLabel.string = this.refreshTimes;

    if (cc.pvz.PlayerData.isNewShopStatus()) {
      this.initShopDailyData(!1);
    } else {
      this.refreshShopUI();
    }

    this.updateRedTip();
    cc.pvz.TAUtils.trackAdUIShow(cc.pvz.GameConfig.AdType["商店刷新"]);
    cc.pvz.TAUtils.trackAdUIShow(cc.pvz.GameConfig.AdType["商店宝箱"]);
    cc.pvz.TAUtils.trackAdUIShow(cc.pvz.GameConfig.AdType["商店钻石"]);
    cc.pvz.TAUtils.trackAdUIShow(cc.pvz.GameConfig.AdType["商店金币"]);
  },
  onStopShopScroll: function onStopShopScroll() {
    this.scrollPanel.stopAutoScroll();
  },
  onShopToCoin: function onShopToCoin() {
    this.scrollPanel.scrollToBottom(0.1);
  },
  onShopToDiamond: function onShopToDiamond() {
    this.scrollPanel.scrollToTop(0.1);
  },
  initShopDailyData: function initShopDailyData(e) {
    if (void 0 === e) {
      e = !1;
    }

    for (var t = e ? 1 : 0; t < 6; t++) {
      var o = t + 1;
      var a = this.shopJson[t];
      var c;

      if (1 == o) {
        c = 0;
      } else {
        c = cc.pvz.utils.randomWeightIndex(a.wgt);
      }

      var s = a.item[c];

      if (this.stageLevel < 5 && 7 == s) {
        c = cc.pvz.utils.randomWeightIndex([a.wgt[0], a.wgt[1]]);
        s = a.item[c];
      }

      var n = a["num" + (c + 1)];
      var r = n[cc.pvz.utils.randomWeightIndex(n)];
      var h = 10;

      if (a.discountWgt.length > 0) {
        h = a.discount[cc.pvz.utils.randomWeightIndex(a.discountWgt)];
      }

      var p = a.priceNum[c] * r * (h / 10);
      var l = new i();
      l.count = r;
      l.buyTimes = a.buyNum[0];
      l.priceType = a.priceItem[0];
      l.discount = h;
      l.price = Math.ceil(p);

      if (s >= 5 && s <= 7) {
        l.itemId = cc.pvz.GameConfig.ItemType["固定碎片"];
        l.toolId = this.onGetRandomTool(s);
      } else {
        l.itemId = s;
        l.toolId = -1;
      }

      if (e) {
        cc.pvz.PlayerData.setShopData(o, l);
      } else {
        cc.pvz.PlayerData.addShopData(o, l);
      }
    }

    if (e) {
      this.refreshDailyUI();
    } else {
      cc.pvz.PlayerData.changeShopStatus();
      this.refreshShopUI();
    }
  },
  onGetRandomTool: function onGetRandomTool(e) {
    var t = cc.JsonControl.getItemJson(e);
    var i = cc.pvz.utils.getOpenToolList(t.Quality);
    return i[cc.math.randomRangeInt(0, i.length)];
  },
  refreshShopUI: function refreshShopUI() {
    this.refreshDailyUI();
    this.initShopBoxUI();
    this.initCoinShopUI();
  },
  refreshDailyUI: function refreshDailyUI() {
    for (var e = 0; e < 6; e++) {
      var t = e + 1;
      this.shopDailyPanel.children[e].getComponent("ShopDailyItem").initShopDailyItem(t, this.shopJson[e]);
    }
  },
  initShopBoxUI: function initShopBoxUI() {
    var e = this;
    this.shopBoxData = cc.pvz.PlayerData.getShopBoxData();
    this.shopBoxLvJson = this.shopBoxJson[this.shopBoxData.lv - 1];
    this.boxLvLabel.string = "" + this.shopBoxData.lv;

    if (cc.player.shopBoxData.lv >= 10) {
      this.boxLvProgress.string = "已满级";
      this.boxLvBar.progress = 1;
    } else {
      this.boxLvProgress.string = this.shopBoxData.exp + "/" + this.shopBoxLvJson.exp;
      this.boxLvBar.progress = this.shopBoxData.exp / this.shopBoxLvJson.exp;
    }

    for (var t = 0; t < this.boxItemList.length; t++) {
      this.boxItemList[t].getComponent("ShopBoxItem").initShopBoxItem(t + 1, this.shopBoxLvJson, function () {
        e.onChekBoxLvUp();
      });
    }
  },
  onChekBoxLvUp: function onChekBoxLvUp() {
    if (!(cc.player.shopBoxData.lv >= 10)) {
      this.shopBoxData = cc.pvz.PlayerData.getShopBoxData();
      this.shopBoxLvJson = this.shopBoxJson[this.shopBoxData.lv - 1];
      var e = this.shopBoxData.exp - this.shopBoxLvJson.exp;

      if (e >= 0) {
        cc.pvz.PlayerData.updateShopBoxlV(1, e);
        this.initShopBoxUI();
        cc.popupManager.popup("mainUI", "shopboxlveft", "UIShopBoxLvUp", {
          ad: !1,
          scale: !0
        }, this.shopBoxData.lv, this.shopBoxJson);
      }

      this.boxLvLabel.string = "" + this.shopBoxData.lv;

      if (cc.player.shopBoxData.lv >= 10) {
        this.boxLvProgress.string = "已满级";
        this.boxLvBar.progress = 1;
      } else {
        this.boxLvProgress.string = this.shopBoxData.exp + "/" + this.shopBoxLvJson.exp;
        this.boxLvBar.progress = this.shopBoxData.exp / this.shopBoxLvJson.exp;
      }
    }
  },
  initCoinShopUI: function initCoinShopUI() {
    for (var e = 0; e < 3; e++) {
      var t = e + 7;
      this.shopCoinList[e].getComponent("ShopCoinItem").initShopCoinItem(t, this.shopJson[t - 1]);
    }
  },
  onCloseUI: function onCloseUI() {
    this.node.active = !1;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9tYWluVUkvc2NyaXB0cy9VSVNob3AuanMiXSwibmFtZXMiOlsiaSIsImNjIiwiQ2xhc3MiLCJuYW1lIiwicHJvcGVydGllcyIsIml0ZW1JZCIsImNvdW50IiwidG9vbElkIiwiYnV5VGltZXMiLCJwcmljZVR5cGUiLCJwcmljZSIsImRpc2NvdW50IiwiQ29tcG9uZW50Iiwic2hvcEpzb25GaWxlIiwiSnNvbkFzc2V0Iiwic2hvcEJveEpzb25GaWxlIiwic2hvcERhaWx5UGFuZWwiLCJOb2RlIiwicmVmcmVzaFRpbWVzTGFiZWwiLCJMYWJlbCIsInNob3BDb2luTGlzdCIsImJveEx2TGFiZWwiLCJib3hMdkJhciIsIlByb2dyZXNzQmFyIiwiYm94THZQcm9ncmVzcyIsImJveEl0ZW1MaXN0Iiwic2Nyb2xsUGFuZWwiLCJTY3JvbGxWaWV3IiwicmVkVGlwcyIsIm9uQ2xpY2tSZWZyZXNoIiwiZSIsImlzTG9va0FkIiwicmVmcmVzaFRpbWVzIiwicG9wdXBNYW5hZ2VyIiwic2hvd1RvYXN0Iiwib25TdG9wU2hvcFNjcm9sbCIsInB2eiIsIkFkVXRpbHMiLCJzaG93QWRSZXdhcmRWaWRlbyIsIkdhbWVDb25maWciLCJBZFR5cGUiLCJ0Iiwib25BZENsb3NlIiwiUGxheWVyRGF0YSIsInVwZGF0ZVNob3BUaW1lcyIsIlNob3BUaW1lc1R5cGUiLCJnZXRTaG9wVGltZXMiLCJzdHJpbmciLCJpbml0U2hvcERhaWx5RGF0YSIsIm9uQ2xpY2tTaG9wQm94VGlwIiwicG9wdXAiLCJhZCIsInNjYWxlIiwic2hvcEJveERhdGEiLCJsdiIsInNob3BCb3hKc29uIiwib25Mb2FkIiwiVUlTaG9wIiwic2hvcEpzb24iLCJqc29uIiwic3RhcnQiLCJub2RlIiwiTWF0aCIsIm1pbiIsIndpZHRoIiwiaGVpZ2h0IiwidXBkYXRlUmVkVGlwIiwiYWN0aXZlIiwiaW5pdEJ5IiwidXRpbHMiLCJmYWRlSW5CdG4iLCJzdGFnZUxldmVsIiwiZ2V0U3RhZ2VMZXZlbCIsImNoZWNrQW5kUmVzZXRTaG9wIiwiaXNOZXdTaG9wU3RhdHVzIiwicmVmcmVzaFNob3BVSSIsIlRBVXRpbHMiLCJ0cmFja0FkVUlTaG93Iiwic3RvcEF1dG9TY3JvbGwiLCJvblNob3BUb0NvaW4iLCJzY3JvbGxUb0JvdHRvbSIsIm9uU2hvcFRvRGlhbW9uZCIsInNjcm9sbFRvVG9wIiwibyIsImEiLCJjIiwicmFuZG9tV2VpZ2h0SW5kZXgiLCJ3Z3QiLCJzIiwiaXRlbSIsIm4iLCJyIiwiaCIsImRpc2NvdW50V2d0IiwibGVuZ3RoIiwicCIsInByaWNlTnVtIiwibCIsImJ1eU51bSIsInByaWNlSXRlbSIsImNlaWwiLCJJdGVtVHlwZSIsIm9uR2V0UmFuZG9tVG9vbCIsInNldFNob3BEYXRhIiwiYWRkU2hvcERhdGEiLCJyZWZyZXNoRGFpbHlVSSIsImNoYW5nZVNob3BTdGF0dXMiLCJKc29uQ29udHJvbCIsImdldEl0ZW1Kc29uIiwiZ2V0T3BlblRvb2xMaXN0IiwiUXVhbGl0eSIsIm1hdGgiLCJyYW5kb21SYW5nZUludCIsImluaXRTaG9wQm94VUkiLCJpbml0Q29pblNob3BVSSIsImNoaWxkcmVuIiwiZ2V0Q29tcG9uZW50IiwiaW5pdFNob3BEYWlseUl0ZW0iLCJnZXRTaG9wQm94RGF0YSIsInNob3BCb3hMdkpzb24iLCJwbGF5ZXIiLCJwcm9ncmVzcyIsImV4cCIsImluaXRTaG9wQm94SXRlbSIsIm9uQ2hla0JveEx2VXAiLCJ1cGRhdGVTaG9wQm94bFYiLCJpbml0U2hvcENvaW5JdGVtIiwib25DbG9zZVVJIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUMsR0FBR0MsRUFBRSxDQUFDQyxLQUFILENBQVM7RUFDYkMsSUFBSSxFQUFFLFVBRE87RUFFYkMsVUFBVSxFQUFFO0lBQ1JDLE1BQU0sRUFBRSxDQURBO0lBRVJDLEtBQUssRUFBRSxDQUZDO0lBR1JDLE1BQU0sRUFBRSxDQUFDLENBSEQ7SUFJUkMsUUFBUSxFQUFFLENBSkY7SUFLUkMsU0FBUyxFQUFFLENBTEg7SUFNUkMsS0FBSyxFQUFFLENBTkM7SUFPUkMsUUFBUSxFQUFFO0VBUEY7QUFGQyxDQUFULENBQVI7QUFZQVYsRUFBRSxDQUFDQyxLQUFILENBQVM7RUFDTCxXQUFTRCxFQUFFLENBQUNXLFNBRFA7RUFFTFIsVUFBVSxFQUFFO0lBQ1JTLFlBQVksRUFBRVosRUFBRSxDQUFDYSxTQURUO0lBRVJDLGVBQWUsRUFBRWQsRUFBRSxDQUFDYSxTQUZaO0lBR1JFLGNBQWMsRUFBRWYsRUFBRSxDQUFDZ0IsSUFIWDtJQUlSQyxpQkFBaUIsRUFBRWpCLEVBQUUsQ0FBQ2tCLEtBSmQ7SUFLUkMsWUFBWSxFQUFFLENBQUNuQixFQUFFLENBQUNnQixJQUFKLENBTE47SUFNUkksVUFBVSxFQUFFcEIsRUFBRSxDQUFDa0IsS0FOUDtJQU9SRyxRQUFRLEVBQUVyQixFQUFFLENBQUNzQixXQVBMO0lBUVJDLGFBQWEsRUFBRXZCLEVBQUUsQ0FBQ2tCLEtBUlY7SUFTUk0sV0FBVyxFQUFFLENBQUN4QixFQUFFLENBQUNnQixJQUFKLENBVEw7SUFVUlMsV0FBVyxFQUFFekIsRUFBRSxDQUFDMEIsVUFWUjtJQVdSQyxPQUFPLEVBQUUsQ0FBQzNCLEVBQUUsQ0FBQ2dCLElBQUo7RUFYRCxDQUZQO0VBZUxZLGNBQWMsRUFBRSwwQkFBWTtJQUN4QixJQUFJQyxDQUFDLEdBQUcsSUFBUjs7SUFDQSxJQUFJLEtBQUtDLFFBQVQsRUFBbUIsQ0FDZjtJQUNILENBRkQsTUFFTztNQUNILElBQUksS0FBS0MsWUFBTCxJQUFxQixDQUF6QixFQUE0QjtRQUN4Qi9CLEVBQUUsQ0FBQ2dDLFlBQUgsQ0FBZ0JDLFNBQWhCLENBQTBCLFNBQTFCO01BQ0gsQ0FGRCxNQUVPO1FBQ0gsS0FBS0MsZ0JBQUwsSUFDSyxLQUFLSixRQUFMLEdBQWdCLENBQUMsQ0FEdEIsRUFFSTlCLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0MsT0FBUCxDQUFlQyxpQkFBZixDQUFpQ3JDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQkMsTUFBbEIsQ0FBeUIsTUFBekIsQ0FBakMsRUFBbUUsVUFBVUMsQ0FBVixFQUFhO1VBQzVFWCxDQUFDLENBQUNZLFNBQUYsQ0FBWUQsQ0FBWjtRQUNILENBRkQsQ0FGSjtNQUtIO0lBQ0o7RUFDSixDQTlCSTtFQStCTEMsU0FBUyxFQUFFLG1CQUFVWixDQUFWLEVBQWE7SUFDcEIsS0FBS0MsUUFBTCxHQUFnQixDQUFDLENBQWpCOztJQUNBLElBQUlELENBQUosRUFBTztNQUNIN0IsRUFBRSxDQUFDbUMsR0FBSCxDQUFPTyxVQUFQLENBQWtCQyxlQUFsQixDQUFrQzNDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQk0sYUFBbEIsQ0FBZ0MsTUFBaEMsQ0FBbEM7TUFDQSxLQUFLYixZQUFMLEdBQW9CL0IsRUFBRSxDQUFDbUMsR0FBSCxDQUFPTyxVQUFQLENBQWtCRyxZQUFsQixDQUErQjdDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQk0sYUFBbEIsQ0FBZ0MsTUFBaEMsQ0FBL0IsQ0FBcEI7TUFDQSxLQUFLM0IsaUJBQUwsQ0FBdUI2QixNQUF2QixHQUFnQyxLQUFLZixZQUFyQztNQUNBLEtBQUtnQixpQkFBTCxDQUF1QixDQUFDLENBQXhCO0lBQ0g7RUFDSixDQXZDSTtFQXdDTEMsaUJBQWlCLEVBQUUsNkJBQVk7SUFDM0IsSUFBSSxLQUFLbEIsUUFBVCxFQUFtQixDQUNmO0lBQ0gsQ0FGRCxNQUVPO01BQ0gsS0FBS0ksZ0JBQUw7TUFDQWxDLEVBQUUsQ0FBQ2dDLFlBQUgsQ0FBZ0JpQixLQUFoQixDQUNJLFFBREosRUFFSSxZQUZKLEVBR0ksY0FISixFQUlJO1FBQ0lDLEVBQUUsRUFBRSxDQUFDLENBRFQ7UUFFSUMsS0FBSyxFQUFFLENBQUM7TUFGWixDQUpKLEVBUUksS0FBS0MsV0FBTCxDQUFpQkMsRUFSckIsRUFTSSxLQUFLQyxXQVRUO0lBV0g7RUFDSixDQXpESTtFQTBETEMsTUFBTSxFQUFFLGtCQUFZO0lBQ2hCdkQsRUFBRSxDQUFDd0QsTUFBSCxHQUFZLElBQVo7SUFDQSxLQUFLMUIsUUFBTCxHQUFnQixDQUFDLENBQWpCO0lBQ0EsS0FBSzJCLFFBQUwsR0FBZ0IsS0FBSzdDLFlBQUwsQ0FBa0I4QyxJQUFsQztJQUNBLEtBQUtKLFdBQUwsR0FBbUIsS0FBS3hDLGVBQUwsQ0FBcUI0QyxJQUF4QztFQUNILENBL0RJO0VBZ0VMQyxLQUFLLEVBQUUsaUJBQVk7SUFDZixLQUFLbEMsV0FBTCxDQUFpQm1DLElBQWpCLENBQXNCVCxLQUF0QixHQUE4QlUsSUFBSSxDQUFDQyxHQUFMLENBQVMsR0FBVCxFQUFjLEtBQUtGLElBQUwsQ0FBVUcsS0FBVixHQUFrQixHQUFoQyxDQUE5QjtJQUNBLEtBQUt0QyxXQUFMLENBQWlCbUMsSUFBakIsQ0FBc0JJLE1BQXRCLElBQWdDLEtBQUt2QyxXQUFMLENBQWlCbUMsSUFBakIsQ0FBc0JULEtBQXREO0VBQ0gsQ0FuRUk7RUFvRUxjLFlBQVksRUFBRSx3QkFBWTtJQUN0QixLQUFLdEMsT0FBTCxDQUFhLENBQWIsRUFBZ0J1QyxNQUFoQixHQUF5QixLQUFLbEUsRUFBRSxDQUFDbUMsR0FBSCxDQUFPTyxVQUFQLENBQWtCRyxZQUFsQixDQUErQjdDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQk0sYUFBbEIsQ0FBZ0MsTUFBaEMsQ0FBL0IsQ0FBOUI7SUFDQSxLQUFLakIsT0FBTCxDQUFhLENBQWIsRUFBZ0J1QyxNQUFoQixHQUF5QixLQUFLbEUsRUFBRSxDQUFDbUMsR0FBSCxDQUFPTyxVQUFQLENBQWtCRyxZQUFsQixDQUErQjdDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQk0sYUFBbEIsQ0FBZ0MsTUFBaEMsQ0FBL0IsQ0FBOUI7RUFDSCxDQXZFSTtFQXdFTHVCLE1BQU0sRUFBRSxrQkFBWTtJQUNoQm5FLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT2lDLEtBQVAsQ0FBYUMsU0FBYixDQUF1QixLQUFLVCxJQUE1QjtJQUNBLEtBQUtBLElBQUwsQ0FBVU0sTUFBVixHQUFtQixDQUFDLENBQXBCO0lBQ0EsS0FBS0ksVUFBTCxHQUFrQnRFLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT08sVUFBUCxDQUFrQjZCLGFBQWxCLEVBQWxCO0lBQ0F2RSxFQUFFLENBQUNtQyxHQUFILENBQU9PLFVBQVAsQ0FBa0I4QixpQkFBbEI7SUFDQSxLQUFLekMsWUFBTCxHQUFvQi9CLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT08sVUFBUCxDQUFrQkcsWUFBbEIsQ0FBK0I3QyxFQUFFLENBQUNtQyxHQUFILENBQU9HLFVBQVAsQ0FBa0JNLGFBQWxCLENBQWdDLE1BQWhDLENBQS9CLENBQXBCO0lBQ0EsS0FBSzNCLGlCQUFMLENBQXVCNkIsTUFBdkIsR0FBZ0MsS0FBS2YsWUFBckM7O0lBQ0EsSUFBSS9CLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT08sVUFBUCxDQUFrQitCLGVBQWxCLEVBQUosRUFBeUM7TUFDckMsS0FBSzFCLGlCQUFMLENBQXVCLENBQUMsQ0FBeEI7SUFDSCxDQUZELE1BRU87TUFDSCxLQUFLMkIsYUFBTDtJQUNIOztJQUNELEtBQUtULFlBQUw7SUFDQWpFLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT3dDLE9BQVAsQ0FBZUMsYUFBZixDQUE2QjVFLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQkMsTUFBbEIsQ0FBeUIsTUFBekIsQ0FBN0I7SUFDQXZDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT3dDLE9BQVAsQ0FBZUMsYUFBZixDQUE2QjVFLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQkMsTUFBbEIsQ0FBeUIsTUFBekIsQ0FBN0I7SUFDQXZDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT3dDLE9BQVAsQ0FBZUMsYUFBZixDQUE2QjVFLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQkMsTUFBbEIsQ0FBeUIsTUFBekIsQ0FBN0I7SUFDQXZDLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT3dDLE9BQVAsQ0FBZUMsYUFBZixDQUE2QjVFLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT0csVUFBUCxDQUFrQkMsTUFBbEIsQ0FBeUIsTUFBekIsQ0FBN0I7RUFDSCxDQXpGSTtFQTBGTEwsZ0JBQWdCLEVBQUUsNEJBQVk7SUFDMUIsS0FBS1QsV0FBTCxDQUFpQm9ELGNBQWpCO0VBQ0gsQ0E1Rkk7RUE2RkxDLFlBQVksRUFBRSx3QkFBWTtJQUN0QixLQUFLckQsV0FBTCxDQUFpQnNELGNBQWpCLENBQWdDLEdBQWhDO0VBQ0gsQ0EvRkk7RUFnR0xDLGVBQWUsRUFBRSwyQkFBWTtJQUN6QixLQUFLdkQsV0FBTCxDQUFpQndELFdBQWpCLENBQTZCLEdBQTdCO0VBQ0gsQ0FsR0k7RUFtR0xsQyxpQkFBaUIsRUFBRSwyQkFBVWxCLENBQVYsRUFBYTtJQUM1QixJQUFJLEtBQUssQ0FBTCxLQUFXQSxDQUFmLEVBQWtCO01BQ2RBLENBQUMsR0FBRyxDQUFDLENBQUw7SUFDSDs7SUFDRCxLQUFLLElBQUlXLENBQUMsR0FBR1gsQ0FBQyxHQUFHLENBQUgsR0FBTyxDQUFyQixFQUF3QlcsQ0FBQyxHQUFHLENBQTVCLEVBQStCQSxDQUFDLEVBQWhDLEVBQW9DO01BQ2hDLElBQUkwQyxDQUFDLEdBQUcxQyxDQUFDLEdBQUcsQ0FBWjtNQUNBLElBQUkyQyxDQUFDLEdBQUcsS0FBSzFCLFFBQUwsQ0FBY2pCLENBQWQsQ0FBUjtNQUNBLElBQUk0QyxDQUFKOztNQUNBLElBQUksS0FBS0YsQ0FBVCxFQUFZO1FBQ1JFLENBQUMsR0FBRyxDQUFKO01BQ0gsQ0FGRCxNQUVPO1FBQ0hBLENBQUMsR0FBR3BGLEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT2lDLEtBQVAsQ0FBYWlCLGlCQUFiLENBQStCRixDQUFDLENBQUNHLEdBQWpDLENBQUo7TUFDSDs7TUFDRCxJQUFJQyxDQUFDLEdBQUdKLENBQUMsQ0FBQ0ssSUFBRixDQUFPSixDQUFQLENBQVI7O01BQ0EsSUFBSSxLQUFLZCxVQUFMLEdBQWtCLENBQWxCLElBQXVCLEtBQUtpQixDQUFoQyxFQUFtQztRQUMvQkgsQ0FBQyxHQUFHcEYsRUFBRSxDQUFDbUMsR0FBSCxDQUFPaUMsS0FBUCxDQUFhaUIsaUJBQWIsQ0FBK0IsQ0FBQ0YsQ0FBQyxDQUFDRyxHQUFGLENBQU0sQ0FBTixDQUFELEVBQVdILENBQUMsQ0FBQ0csR0FBRixDQUFNLENBQU4sQ0FBWCxDQUEvQixDQUFKO1FBQ0FDLENBQUMsR0FBR0osQ0FBQyxDQUFDSyxJQUFGLENBQU9KLENBQVAsQ0FBSjtNQUNIOztNQUNELElBQUlLLENBQUMsR0FBR04sQ0FBQyxDQUFDLFNBQVNDLENBQUMsR0FBRyxDQUFiLENBQUQsQ0FBVDtNQUNBLElBQUlNLENBQUMsR0FBR0QsQ0FBQyxDQUFDekYsRUFBRSxDQUFDbUMsR0FBSCxDQUFPaUMsS0FBUCxDQUFhaUIsaUJBQWIsQ0FBK0JJLENBQS9CLENBQUQsQ0FBVDtNQUNBLElBQUlFLENBQUMsR0FBRyxFQUFSOztNQUNBLElBQUlSLENBQUMsQ0FBQ1MsV0FBRixDQUFjQyxNQUFkLEdBQXVCLENBQTNCLEVBQThCO1FBQzFCRixDQUFDLEdBQUdSLENBQUMsQ0FBQ3pFLFFBQUYsQ0FBV1YsRUFBRSxDQUFDbUMsR0FBSCxDQUFPaUMsS0FBUCxDQUFhaUIsaUJBQWIsQ0FBK0JGLENBQUMsQ0FBQ1MsV0FBakMsQ0FBWCxDQUFKO01BQ0g7O01BQ0QsSUFBSUUsQ0FBQyxHQUFHWCxDQUFDLENBQUNZLFFBQUYsQ0FBV1gsQ0FBWCxJQUFnQk0sQ0FBaEIsSUFBcUJDLENBQUMsR0FBRyxFQUF6QixDQUFSO01BQ0EsSUFBSUssQ0FBQyxHQUFHLElBQUlqRyxDQUFKLEVBQVI7TUFDQWlHLENBQUMsQ0FBQzNGLEtBQUYsR0FBVXFGLENBQVY7TUFDQU0sQ0FBQyxDQUFDekYsUUFBRixHQUFhNEUsQ0FBQyxDQUFDYyxNQUFGLENBQVMsQ0FBVCxDQUFiO01BQ0FELENBQUMsQ0FBQ3hGLFNBQUYsR0FBYzJFLENBQUMsQ0FBQ2UsU0FBRixDQUFZLENBQVosQ0FBZDtNQUNBRixDQUFDLENBQUN0RixRQUFGLEdBQWFpRixDQUFiO01BQ0FLLENBQUMsQ0FBQ3ZGLEtBQUYsR0FBVW9ELElBQUksQ0FBQ3NDLElBQUwsQ0FBVUwsQ0FBVixDQUFWOztNQUNBLElBQUlQLENBQUMsSUFBSSxDQUFMLElBQVVBLENBQUMsSUFBSSxDQUFuQixFQUFzQjtRQUNsQlMsQ0FBQyxDQUFDNUYsTUFBRixHQUFXSixFQUFFLENBQUNtQyxHQUFILENBQU9HLFVBQVAsQ0FBa0I4RCxRQUFsQixDQUEyQixNQUEzQixDQUFYO1FBQ0FKLENBQUMsQ0FBQzFGLE1BQUYsR0FBVyxLQUFLK0YsZUFBTCxDQUFxQmQsQ0FBckIsQ0FBWDtNQUNILENBSEQsTUFHTztRQUNIUyxDQUFDLENBQUM1RixNQUFGLEdBQVdtRixDQUFYO1FBQ0FTLENBQUMsQ0FBQzFGLE1BQUYsR0FBVyxDQUFDLENBQVo7TUFDSDs7TUFDRCxJQUFJdUIsQ0FBSixFQUFPO1FBQ0g3QixFQUFFLENBQUNtQyxHQUFILENBQU9PLFVBQVAsQ0FBa0I0RCxXQUFsQixDQUE4QnBCLENBQTlCLEVBQWlDYyxDQUFqQztNQUNILENBRkQsTUFFTztRQUNIaEcsRUFBRSxDQUFDbUMsR0FBSCxDQUFPTyxVQUFQLENBQWtCNkQsV0FBbEIsQ0FBOEJyQixDQUE5QixFQUFpQ2MsQ0FBakM7TUFDSDtJQUNKOztJQUNELElBQUluRSxDQUFKLEVBQU87TUFDSCxLQUFLMkUsY0FBTDtJQUNILENBRkQsTUFFTztNQUNIeEcsRUFBRSxDQUFDbUMsR0FBSCxDQUFPTyxVQUFQLENBQWtCK0QsZ0JBQWxCO01BQ0EsS0FBSy9CLGFBQUw7SUFDSDtFQUNKLENBckpJO0VBc0pMMkIsZUFBZSxFQUFFLHlCQUFVeEUsQ0FBVixFQUFhO0lBQzFCLElBQUlXLENBQUMsR0FBR3hDLEVBQUUsQ0FBQzBHLFdBQUgsQ0FBZUMsV0FBZixDQUEyQjlFLENBQTNCLENBQVI7SUFDQSxJQUFJOUIsQ0FBQyxHQUFHQyxFQUFFLENBQUNtQyxHQUFILENBQU9pQyxLQUFQLENBQWF3QyxlQUFiLENBQTZCcEUsQ0FBQyxDQUFDcUUsT0FBL0IsQ0FBUjtJQUNBLE9BQU85RyxDQUFDLENBQUNDLEVBQUUsQ0FBQzhHLElBQUgsQ0FBUUMsY0FBUixDQUF1QixDQUF2QixFQUEwQmhILENBQUMsQ0FBQzhGLE1BQTVCLENBQUQsQ0FBUjtFQUNILENBMUpJO0VBMkpMbkIsYUFBYSxFQUFFLHlCQUFZO0lBQ3ZCLEtBQUs4QixjQUFMO0lBQ0EsS0FBS1EsYUFBTDtJQUNBLEtBQUtDLGNBQUw7RUFDSCxDQS9KSTtFQWdLTFQsY0FBYyxFQUFFLDBCQUFZO0lBQ3hCLEtBQUssSUFBSTNFLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsQ0FBcEIsRUFBdUJBLENBQUMsRUFBeEIsRUFBNEI7TUFDeEIsSUFBSVcsQ0FBQyxHQUFHWCxDQUFDLEdBQUcsQ0FBWjtNQUNBLEtBQUtkLGNBQUwsQ0FBb0JtRyxRQUFwQixDQUE2QnJGLENBQTdCLEVBQWdDc0YsWUFBaEMsQ0FBNkMsZUFBN0MsRUFBOERDLGlCQUE5RCxDQUFnRjVFLENBQWhGLEVBQW1GLEtBQUtpQixRQUFMLENBQWM1QixDQUFkLENBQW5GO0lBQ0g7RUFDSixDQXJLSTtFQXNLTG1GLGFBQWEsRUFBRSx5QkFBWTtJQUN2QixJQUFJbkYsQ0FBQyxHQUFHLElBQVI7SUFDQSxLQUFLdUIsV0FBTCxHQUFtQnBELEVBQUUsQ0FBQ21DLEdBQUgsQ0FBT08sVUFBUCxDQUFrQjJFLGNBQWxCLEVBQW5CO0lBQ0EsS0FBS0MsYUFBTCxHQUFxQixLQUFLaEUsV0FBTCxDQUFpQixLQUFLRixXQUFMLENBQWlCQyxFQUFqQixHQUFzQixDQUF2QyxDQUFyQjtJQUNBLEtBQUtqQyxVQUFMLENBQWdCMEIsTUFBaEIsR0FBeUIsS0FBSyxLQUFLTSxXQUFMLENBQWlCQyxFQUEvQzs7SUFDQSxJQUFJckQsRUFBRSxDQUFDdUgsTUFBSCxDQUFVbkUsV0FBVixDQUFzQkMsRUFBdEIsSUFBNEIsRUFBaEMsRUFBb0M7TUFDaEMsS0FBSzlCLGFBQUwsQ0FBbUJ1QixNQUFuQixHQUE0QixLQUE1QjtNQUNBLEtBQUt6QixRQUFMLENBQWNtRyxRQUFkLEdBQXlCLENBQXpCO0lBQ0gsQ0FIRCxNQUdPO01BQ0gsS0FBS2pHLGFBQUwsQ0FBbUJ1QixNQUFuQixHQUE0QixLQUFLTSxXQUFMLENBQWlCcUUsR0FBakIsR0FBdUIsR0FBdkIsR0FBNkIsS0FBS0gsYUFBTCxDQUFtQkcsR0FBNUU7TUFDQSxLQUFLcEcsUUFBTCxDQUFjbUcsUUFBZCxHQUF5QixLQUFLcEUsV0FBTCxDQUFpQnFFLEdBQWpCLEdBQXVCLEtBQUtILGFBQUwsQ0FBbUJHLEdBQW5FO0lBQ0g7O0lBQ0QsS0FBSyxJQUFJakYsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxLQUFLaEIsV0FBTCxDQUFpQnFFLE1BQXJDLEVBQTZDckQsQ0FBQyxFQUE5QyxFQUFrRDtNQUM5QyxLQUFLaEIsV0FBTCxDQUFpQmdCLENBQWpCLEVBQW9CMkUsWUFBcEIsQ0FBaUMsYUFBakMsRUFBZ0RPLGVBQWhELENBQWdFbEYsQ0FBQyxHQUFHLENBQXBFLEVBQXVFLEtBQUs4RSxhQUE1RSxFQUEyRixZQUFZO1FBQ25HekYsQ0FBQyxDQUFDOEYsYUFBRjtNQUNILENBRkQ7SUFHSDtFQUNKLENBdkxJO0VBd0xMQSxhQUFhLEVBQUUseUJBQVk7SUFDdkIsSUFBSSxFQUFFM0gsRUFBRSxDQUFDdUgsTUFBSCxDQUFVbkUsV0FBVixDQUFzQkMsRUFBdEIsSUFBNEIsRUFBOUIsQ0FBSixFQUF1QztNQUNuQyxLQUFLRCxXQUFMLEdBQW1CcEQsRUFBRSxDQUFDbUMsR0FBSCxDQUFPTyxVQUFQLENBQWtCMkUsY0FBbEIsRUFBbkI7TUFDQSxLQUFLQyxhQUFMLEdBQXFCLEtBQUtoRSxXQUFMLENBQWlCLEtBQUtGLFdBQUwsQ0FBaUJDLEVBQWpCLEdBQXNCLENBQXZDLENBQXJCO01BQ0EsSUFBSXhCLENBQUMsR0FBRyxLQUFLdUIsV0FBTCxDQUFpQnFFLEdBQWpCLEdBQXVCLEtBQUtILGFBQUwsQ0FBbUJHLEdBQWxEOztNQUNBLElBQUk1RixDQUFDLElBQUksQ0FBVCxFQUFZO1FBQ1I3QixFQUFFLENBQUNtQyxHQUFILENBQU9PLFVBQVAsQ0FBa0JrRixlQUFsQixDQUFrQyxDQUFsQyxFQUFxQy9GLENBQXJDO1FBQ0EsS0FBS21GLGFBQUw7UUFDQWhILEVBQUUsQ0FBQ2dDLFlBQUgsQ0FBZ0JpQixLQUFoQixDQUNJLFFBREosRUFFSSxjQUZKLEVBR0ksZUFISixFQUlJO1VBQ0lDLEVBQUUsRUFBRSxDQUFDLENBRFQ7VUFFSUMsS0FBSyxFQUFFLENBQUM7UUFGWixDQUpKLEVBUUksS0FBS0MsV0FBTCxDQUFpQkMsRUFSckIsRUFTSSxLQUFLQyxXQVRUO01BV0g7O01BQ0QsS0FBS2xDLFVBQUwsQ0FBZ0IwQixNQUFoQixHQUF5QixLQUFLLEtBQUtNLFdBQUwsQ0FBaUJDLEVBQS9DOztNQUNBLElBQUlyRCxFQUFFLENBQUN1SCxNQUFILENBQVVuRSxXQUFWLENBQXNCQyxFQUF0QixJQUE0QixFQUFoQyxFQUFvQztRQUNoQyxLQUFLOUIsYUFBTCxDQUFtQnVCLE1BQW5CLEdBQTRCLEtBQTVCO1FBQ0EsS0FBS3pCLFFBQUwsQ0FBY21HLFFBQWQsR0FBeUIsQ0FBekI7TUFDSCxDQUhELE1BR087UUFDSCxLQUFLakcsYUFBTCxDQUFtQnVCLE1BQW5CLEdBQTRCLEtBQUtNLFdBQUwsQ0FBaUJxRSxHQUFqQixHQUF1QixHQUF2QixHQUE2QixLQUFLSCxhQUFMLENBQW1CRyxHQUE1RTtRQUNBLEtBQUtwRyxRQUFMLENBQWNtRyxRQUFkLEdBQXlCLEtBQUtwRSxXQUFMLENBQWlCcUUsR0FBakIsR0FBdUIsS0FBS0gsYUFBTCxDQUFtQkcsR0FBbkU7TUFDSDtJQUNKO0VBQ0osQ0FyTkk7RUFzTkxSLGNBQWMsRUFBRSwwQkFBWTtJQUN4QixLQUFLLElBQUlwRixDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLENBQXBCLEVBQXVCQSxDQUFDLEVBQXhCLEVBQTRCO01BQ3hCLElBQUlXLENBQUMsR0FBR1gsQ0FBQyxHQUFHLENBQVo7TUFDQSxLQUFLVixZQUFMLENBQWtCVSxDQUFsQixFQUFxQnNGLFlBQXJCLENBQWtDLGNBQWxDLEVBQWtEVSxnQkFBbEQsQ0FBbUVyRixDQUFuRSxFQUFzRSxLQUFLaUIsUUFBTCxDQUFjakIsQ0FBQyxHQUFHLENBQWxCLENBQXRFO0lBQ0g7RUFDSixDQTNOSTtFQTROTHNGLFNBQVMsRUFBRSxxQkFBWTtJQUNuQixLQUFLbEUsSUFBTCxDQUFVTSxNQUFWLEdBQW1CLENBQUMsQ0FBcEI7RUFDSDtBQTlOSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaSA9IGNjLkNsYXNzKHtcbiAgICBuYW1lOiBcIlNob3BEYXRhXCIsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpdGVtSWQ6IDEsXG4gICAgICAgIGNvdW50OiAxLFxuICAgICAgICB0b29sSWQ6IC0xLFxuICAgICAgICBidXlUaW1lczogMCxcbiAgICAgICAgcHJpY2VUeXBlOiAyLFxuICAgICAgICBwcmljZTogMSxcbiAgICAgICAgZGlzY291bnQ6IDFcbiAgICB9XG59KTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzaG9wSnNvbkZpbGU6IGNjLkpzb25Bc3NldCxcbiAgICAgICAgc2hvcEJveEpzb25GaWxlOiBjYy5Kc29uQXNzZXQsXG4gICAgICAgIHNob3BEYWlseVBhbmVsOiBjYy5Ob2RlLFxuICAgICAgICByZWZyZXNoVGltZXNMYWJlbDogY2MuTGFiZWwsXG4gICAgICAgIHNob3BDb2luTGlzdDogW2NjLk5vZGVdLFxuICAgICAgICBib3hMdkxhYmVsOiBjYy5MYWJlbCxcbiAgICAgICAgYm94THZCYXI6IGNjLlByb2dyZXNzQmFyLFxuICAgICAgICBib3hMdlByb2dyZXNzOiBjYy5MYWJlbCxcbiAgICAgICAgYm94SXRlbUxpc3Q6IFtjYy5Ob2RlXSxcbiAgICAgICAgc2Nyb2xsUGFuZWw6IGNjLlNjcm9sbFZpZXcsXG4gICAgICAgIHJlZFRpcHM6IFtjYy5Ob2RlXVxuICAgIH0sXG4gICAgb25DbGlja1JlZnJlc2g6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5pc0xvb2tBZCkge1xuICAgICAgICAgICAgLy9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlZnJlc2hUaW1lcyA8PSAwKSB7XG4gICAgICAgICAgICAgICAgY2MucG9wdXBNYW5hZ2VyLnNob3dUb2FzdChcIuWIt+aWsOasoeaVsOS4jei2s++8gVwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vblN0b3BTaG9wU2Nyb2xsKCksXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLmlzTG9va0FkID0gITApLFxuICAgICAgICAgICAgICAgICAgICBjYy5wdnouQWRVdGlscy5zaG93QWRSZXdhcmRWaWRlbyhjYy5wdnouR2FtZUNvbmZpZy5BZFR5cGVbXCLllYblupfliLfmlrBcIl0sIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLm9uQWRDbG9zZSh0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uQWRDbG9zZTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdGhpcy5pc0xvb2tBZCA9ICExO1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEudXBkYXRlU2hvcFRpbWVzKGNjLnB2ei5HYW1lQ29uZmlnLlNob3BUaW1lc1R5cGVbXCLllYblupfliLfmlrBcIl0pO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoVGltZXMgPSBjYy5wdnouUGxheWVyRGF0YS5nZXRTaG9wVGltZXMoY2MucHZ6LkdhbWVDb25maWcuU2hvcFRpbWVzVHlwZVtcIuWVhuW6l+WIt+aWsFwiXSk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hUaW1lc0xhYmVsLnN0cmluZyA9IHRoaXMucmVmcmVzaFRpbWVzO1xuICAgICAgICAgICAgdGhpcy5pbml0U2hvcERhaWx5RGF0YSghMCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uQ2xpY2tTaG9wQm94VGlwOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9va0FkKSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vblN0b3BTaG9wU2Nyb2xsKCk7XG4gICAgICAgICAgICBjYy5wb3B1cE1hbmFnZXIucG9wdXAoXG4gICAgICAgICAgICAgICAgXCJtYWluVUlcIixcbiAgICAgICAgICAgICAgICBcInNob3Bib3hUaXBcIixcbiAgICAgICAgICAgICAgICBcIlVJU2hvcEJveFRpcFwiLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgYWQ6ICExLFxuICAgICAgICAgICAgICAgICAgICBzY2FsZTogITBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRoaXMuc2hvcEJveERhdGEubHYsXG4gICAgICAgICAgICAgICAgdGhpcy5zaG9wQm94SnNvblxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNjLlVJU2hvcCA9IHRoaXM7XG4gICAgICAgIHRoaXMuaXNMb29rQWQgPSAhMTtcbiAgICAgICAgdGhpcy5zaG9wSnNvbiA9IHRoaXMuc2hvcEpzb25GaWxlLmpzb247XG4gICAgICAgIHRoaXMuc2hvcEJveEpzb24gPSB0aGlzLnNob3BCb3hKc29uRmlsZS5qc29uO1xuICAgIH0sXG4gICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxQYW5lbC5ub2RlLnNjYWxlID0gTWF0aC5taW4oMS40LCB0aGlzLm5vZGUud2lkdGggLyA3MjApO1xuICAgICAgICB0aGlzLnNjcm9sbFBhbmVsLm5vZGUuaGVpZ2h0IC89IHRoaXMuc2Nyb2xsUGFuZWwubm9kZS5zY2FsZTtcbiAgICB9LFxuICAgIHVwZGF0ZVJlZFRpcDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlZFRpcHNbMF0uYWN0aXZlID0gMSA9PSBjYy5wdnouUGxheWVyRGF0YS5nZXRTaG9wVGltZXMoY2MucHZ6LkdhbWVDb25maWcuU2hvcFRpbWVzVHlwZVtcIumSu+efs+WFjei0uVwiXSk7XG4gICAgICAgIHRoaXMucmVkVGlwc1sxXS5hY3RpdmUgPSA3ID09IGNjLnB2ei5QbGF5ZXJEYXRhLmdldFNob3BUaW1lcyhjYy5wdnouR2FtZUNvbmZpZy5TaG9wVGltZXNUeXBlW1wi6YeR5biB5YWN6LS5XCJdKTtcbiAgICB9LFxuICAgIGluaXRCeTogZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5wdnoudXRpbHMuZmFkZUluQnRuKHRoaXMubm9kZSk7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSAhMDtcbiAgICAgICAgdGhpcy5zdGFnZUxldmVsID0gY2MucHZ6LlBsYXllckRhdGEuZ2V0U3RhZ2VMZXZlbCgpO1xuICAgICAgICBjYy5wdnouUGxheWVyRGF0YS5jaGVja0FuZFJlc2V0U2hvcCgpO1xuICAgICAgICB0aGlzLnJlZnJlc2hUaW1lcyA9IGNjLnB2ei5QbGF5ZXJEYXRhLmdldFNob3BUaW1lcyhjYy5wdnouR2FtZUNvbmZpZy5TaG9wVGltZXNUeXBlW1wi5ZWG5bqX5Yi35pawXCJdKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoVGltZXNMYWJlbC5zdHJpbmcgPSB0aGlzLnJlZnJlc2hUaW1lcztcbiAgICAgICAgaWYgKGNjLnB2ei5QbGF5ZXJEYXRhLmlzTmV3U2hvcFN0YXR1cygpKSB7XG4gICAgICAgICAgICB0aGlzLmluaXRTaG9wRGFpbHlEYXRhKCExKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFNob3BVSSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlUmVkVGlwKCk7XG4gICAgICAgIGNjLnB2ei5UQVV0aWxzLnRyYWNrQWRVSVNob3coY2MucHZ6LkdhbWVDb25maWcuQWRUeXBlW1wi5ZWG5bqX5Yi35pawXCJdKTtcbiAgICAgICAgY2MucHZ6LlRBVXRpbHMudHJhY2tBZFVJU2hvdyhjYy5wdnouR2FtZUNvbmZpZy5BZFR5cGVbXCLllYblupflrp3nrrFcIl0pO1xuICAgICAgICBjYy5wdnouVEFVdGlscy50cmFja0FkVUlTaG93KGNjLnB2ei5HYW1lQ29uZmlnLkFkVHlwZVtcIuWVhuW6l+mSu+efs1wiXSk7XG4gICAgICAgIGNjLnB2ei5UQVV0aWxzLnRyYWNrQWRVSVNob3coY2MucHZ6LkdhbWVDb25maWcuQWRUeXBlW1wi5ZWG5bqX6YeR5biBXCJdKTtcbiAgICB9LFxuICAgIG9uU3RvcFNob3BTY3JvbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxQYW5lbC5zdG9wQXV0b1Njcm9sbCgpO1xuICAgIH0sXG4gICAgb25TaG9wVG9Db2luOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2Nyb2xsUGFuZWwuc2Nyb2xsVG9Cb3R0b20oMC4xKTtcbiAgICB9LFxuICAgIG9uU2hvcFRvRGlhbW9uZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNjcm9sbFBhbmVsLnNjcm9sbFRvVG9wKDAuMSk7XG4gICAgfSxcbiAgICBpbml0U2hvcERhaWx5RGF0YTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gZSkge1xuICAgICAgICAgICAgZSA9ICExO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIHQgPSBlID8gMSA6IDA7IHQgPCA2OyB0KyspIHtcbiAgICAgICAgICAgIHZhciBvID0gdCArIDE7XG4gICAgICAgICAgICB2YXIgYSA9IHRoaXMuc2hvcEpzb25bdF07XG4gICAgICAgICAgICB2YXIgYztcbiAgICAgICAgICAgIGlmICgxID09IG8pIHtcbiAgICAgICAgICAgICAgICBjID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYyA9IGNjLnB2ei51dGlscy5yYW5kb21XZWlnaHRJbmRleChhLndndCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcyA9IGEuaXRlbVtjXTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YWdlTGV2ZWwgPCA1ICYmIDcgPT0gcykge1xuICAgICAgICAgICAgICAgIGMgPSBjYy5wdnoudXRpbHMucmFuZG9tV2VpZ2h0SW5kZXgoW2Eud2d0WzBdLCBhLndndFsxXV0pO1xuICAgICAgICAgICAgICAgIHMgPSBhLml0ZW1bY107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbiA9IGFbXCJudW1cIiArIChjICsgMSldO1xuICAgICAgICAgICAgdmFyIHIgPSBuW2NjLnB2ei51dGlscy5yYW5kb21XZWlnaHRJbmRleChuKV07XG4gICAgICAgICAgICB2YXIgaCA9IDEwO1xuICAgICAgICAgICAgaWYgKGEuZGlzY291bnRXZ3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGggPSBhLmRpc2NvdW50W2NjLnB2ei51dGlscy5yYW5kb21XZWlnaHRJbmRleChhLmRpc2NvdW50V2d0KV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcCA9IGEucHJpY2VOdW1bY10gKiByICogKGggLyAxMCk7XG4gICAgICAgICAgICB2YXIgbCA9IG5ldyBpKCk7XG4gICAgICAgICAgICBsLmNvdW50ID0gcjtcbiAgICAgICAgICAgIGwuYnV5VGltZXMgPSBhLmJ1eU51bVswXTtcbiAgICAgICAgICAgIGwucHJpY2VUeXBlID0gYS5wcmljZUl0ZW1bMF07XG4gICAgICAgICAgICBsLmRpc2NvdW50ID0gaDtcbiAgICAgICAgICAgIGwucHJpY2UgPSBNYXRoLmNlaWwocCk7XG4gICAgICAgICAgICBpZiAocyA+PSA1ICYmIHMgPD0gNykge1xuICAgICAgICAgICAgICAgIGwuaXRlbUlkID0gY2MucHZ6LkdhbWVDb25maWcuSXRlbVR5cGVbXCLlm7rlrprnoo7niYdcIl07XG4gICAgICAgICAgICAgICAgbC50b29sSWQgPSB0aGlzLm9uR2V0UmFuZG9tVG9vbChzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbC5pdGVtSWQgPSBzO1xuICAgICAgICAgICAgICAgIGwudG9vbElkID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgICAgIGNjLnB2ei5QbGF5ZXJEYXRhLnNldFNob3BEYXRhKG8sIGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYy5wdnouUGxheWVyRGF0YS5hZGRTaG9wRGF0YShvLCBsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoRGFpbHlVSSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEuY2hhbmdlU2hvcFN0YXR1cygpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoU2hvcFVJKCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uR2V0UmFuZG9tVG9vbDogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHQgPSBjYy5Kc29uQ29udHJvbC5nZXRJdGVtSnNvbihlKTtcbiAgICAgICAgdmFyIGkgPSBjYy5wdnoudXRpbHMuZ2V0T3BlblRvb2xMaXN0KHQuUXVhbGl0eSk7XG4gICAgICAgIHJldHVybiBpW2NjLm1hdGgucmFuZG9tUmFuZ2VJbnQoMCwgaS5sZW5ndGgpXTtcbiAgICB9LFxuICAgIHJlZnJlc2hTaG9wVUk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoRGFpbHlVSSgpO1xuICAgICAgICB0aGlzLmluaXRTaG9wQm94VUkoKTtcbiAgICAgICAgdGhpcy5pbml0Q29pblNob3BVSSgpO1xuICAgIH0sXG4gICAgcmVmcmVzaERhaWx5VUk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCA2OyBlKyspIHtcbiAgICAgICAgICAgIHZhciB0ID0gZSArIDE7XG4gICAgICAgICAgICB0aGlzLnNob3BEYWlseVBhbmVsLmNoaWxkcmVuW2VdLmdldENvbXBvbmVudChcIlNob3BEYWlseUl0ZW1cIikuaW5pdFNob3BEYWlseUl0ZW0odCwgdGhpcy5zaG9wSnNvbltlXSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGluaXRTaG9wQm94VUk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xuICAgICAgICB0aGlzLnNob3BCb3hEYXRhID0gY2MucHZ6LlBsYXllckRhdGEuZ2V0U2hvcEJveERhdGEoKTtcbiAgICAgICAgdGhpcy5zaG9wQm94THZKc29uID0gdGhpcy5zaG9wQm94SnNvblt0aGlzLnNob3BCb3hEYXRhLmx2IC0gMV07XG4gICAgICAgIHRoaXMuYm94THZMYWJlbC5zdHJpbmcgPSBcIlwiICsgdGhpcy5zaG9wQm94RGF0YS5sdjtcbiAgICAgICAgaWYgKGNjLnBsYXllci5zaG9wQm94RGF0YS5sdiA+PSAxMCkge1xuICAgICAgICAgICAgdGhpcy5ib3hMdlByb2dyZXNzLnN0cmluZyA9IFwi5bey5ruh57qnXCI7XG4gICAgICAgICAgICB0aGlzLmJveEx2QmFyLnByb2dyZXNzID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYm94THZQcm9ncmVzcy5zdHJpbmcgPSB0aGlzLnNob3BCb3hEYXRhLmV4cCArIFwiL1wiICsgdGhpcy5zaG9wQm94THZKc29uLmV4cDtcbiAgICAgICAgICAgIHRoaXMuYm94THZCYXIucHJvZ3Jlc3MgPSB0aGlzLnNob3BCb3hEYXRhLmV4cCAvIHRoaXMuc2hvcEJveEx2SnNvbi5leHA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCB0aGlzLmJveEl0ZW1MaXN0Lmxlbmd0aDsgdCsrKSB7XG4gICAgICAgICAgICB0aGlzLmJveEl0ZW1MaXN0W3RdLmdldENvbXBvbmVudChcIlNob3BCb3hJdGVtXCIpLmluaXRTaG9wQm94SXRlbSh0ICsgMSwgdGhpcy5zaG9wQm94THZKc29uLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZS5vbkNoZWtCb3hMdlVwKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgb25DaGVrQm94THZVcDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIShjYy5wbGF5ZXIuc2hvcEJveERhdGEubHYgPj0gMTApKSB7XG4gICAgICAgICAgICB0aGlzLnNob3BCb3hEYXRhID0gY2MucHZ6LlBsYXllckRhdGEuZ2V0U2hvcEJveERhdGEoKTtcbiAgICAgICAgICAgIHRoaXMuc2hvcEJveEx2SnNvbiA9IHRoaXMuc2hvcEJveEpzb25bdGhpcy5zaG9wQm94RGF0YS5sdiAtIDFdO1xuICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNob3BCb3hEYXRhLmV4cCAtIHRoaXMuc2hvcEJveEx2SnNvbi5leHA7XG4gICAgICAgICAgICBpZiAoZSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEudXBkYXRlU2hvcEJveGxWKDEsIGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFNob3BCb3hVSSgpO1xuICAgICAgICAgICAgICAgIGNjLnBvcHVwTWFuYWdlci5wb3B1cChcbiAgICAgICAgICAgICAgICAgICAgXCJtYWluVUlcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzaG9wYm94bHZlZnRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJVSVNob3BCb3hMdlVwXCIsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkOiAhMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiAhMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3BCb3hEYXRhLmx2LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3BCb3hKc29uXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYm94THZMYWJlbC5zdHJpbmcgPSBcIlwiICsgdGhpcy5zaG9wQm94RGF0YS5sdjtcbiAgICAgICAgICAgIGlmIChjYy5wbGF5ZXIuc2hvcEJveERhdGEubHYgPj0gMTApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJveEx2UHJvZ3Jlc3Muc3RyaW5nID0gXCLlt7Lmu6HnuqdcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmJveEx2QmFyLnByb2dyZXNzID0gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ib3hMdlByb2dyZXNzLnN0cmluZyA9IHRoaXMuc2hvcEJveERhdGEuZXhwICsgXCIvXCIgKyB0aGlzLnNob3BCb3hMdkpzb24uZXhwO1xuICAgICAgICAgICAgICAgIHRoaXMuYm94THZCYXIucHJvZ3Jlc3MgPSB0aGlzLnNob3BCb3hEYXRhLmV4cCAvIHRoaXMuc2hvcEJveEx2SnNvbi5leHA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGluaXRDb2luU2hvcFVJOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgMzsgZSsrKSB7XG4gICAgICAgICAgICB2YXIgdCA9IGUgKyA3O1xuICAgICAgICAgICAgdGhpcy5zaG9wQ29pbkxpc3RbZV0uZ2V0Q29tcG9uZW50KFwiU2hvcENvaW5JdGVtXCIpLmluaXRTaG9wQ29pbkl0ZW0odCwgdGhpcy5zaG9wSnNvblt0IC0gMV0pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvbkNsb3NlVUk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9ICExO1xuICAgIH1cbn0pO1xuIl19