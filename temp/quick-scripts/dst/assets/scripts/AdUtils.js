
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/AdUtils.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '7c7610vsk9D7YhS9pctvYTi', 'AdUtils');
// scripts/AdUtils.js

"use strict";

var o = null;
var a = null;
var n = null;
var i = [0];
var c = {
  initAllAds: function initAllAds() {
    if (cc.sys.platform == cc.sys.WECHAT_GAME) {
      o = wx.getLaunchOptionsSync();
    }

    if (cc.isControlAd) {
      this.initP8AdInfo();
    }
  },
  getLaunchOptions: function getLaunchOptions() {
    return o;
  },
  isWhiteList: function isWhiteList() {
    return cc.sys.platform != cc.sys.WECHAT_GAME || this.isWhiteListSceneId() || cc.pvz.TAUtils.getTwtraceidSwitch(cc.pvz.GameConst.Twtraceid_YXBN) || cc.pvz.TAUtils.getTwtraceidSwitch(cc.pvz.GameConst.Twtraceid_YXSP);
  },
  isWhiteListSceneId: function isWhiteListSceneId() {
    return cc.sys.platform != cc.sys.WECHAT_GAME || -1 != [1095].findIndex(function (e) {
      return e == o.scene;
    });
  },
  getTwtraceidFrom: function getTwtraceidFrom(e) {
    if (Object.keys(e.query).length > 0) {
      for (var t in e.query) {
        if ("?twtraceid" == t) {
          return e.query[t];
        }

        if ("twtraceid" == t) {
          return e.query[t];
        }
      }
    }

    return "";
  },
  callRewardAdCallback: function callRewardAdCallback(e) {
    cc.butler.resumeDirector(0);

    if (this.hasCalledCB) {
      console.log("callRewardAdCallback but hascalled");
    } else {
      e && (cc.player.adTimes++, cc.pvz.PlayerData.addMissionProgress(cc.pvz.GameConfig.MissionType["观看广告n次"], 1), cc.pvz.PlayerData.saveData(), cc.pvz.TAUtils.trackP8AdSucc(this.rewardVideoIndex));

      if (this.cb) {
        this.cb(e), cc.butler.node.emit("ad"), this.hasCalledCB = !0;
      } else {
        cc.pvz.TAUtils.track("error", {
          message: "Ad",
          stack: "cb is null,isEnded:" + e + ",index:" + this.rewardVideoIndex
        });
      }
    }
  },
  createRewardAd: function createRewardAd(e) {
    var t = this;
    var o = wx.createRewardedVideoAd({
      adUnitId: cc.pvz.GameConst.AD_UNITS_REWARD[e],
      multiton: !0
    });
    o.onLoad(function () {
      console.log("RewardedVideoAd onLoad", e);
    });
    o.onError(function (t) {
      console.log("RewardedVideoAd onError", e, t);
      cc.pvz.TAUtils.track("adError", {
        errCode: t.errCode || t.err_code,
        errMsg: t.errMsg
      });
    });
    o.onClose(function (e) {
      if (e && e.isEnded || void 0 === e) {
        t.callRewardAdCallback(!0);
        cc.pvz.TAUtils.trackAdClose(t.rewardVideoIndex, !0);
      } else {
        t.callRewardAdCallback(!1);
        cc.pvz.TAUtils.trackAdClose(t.rewardVideoIndex, !1);
      }
    });
    return o;
  },
  createPublicRewardAd: function createPublicRewardAd(e) {
    var t = this;
    var o = !n;
    n = wx.createRewardedVideoAd({
      adUnitId: cc.pvz.GameConst.AD_UNITS_REWARD[e]
    });

    if (o) {
      n.onLoad(function () {
        console.log("RewardedVideoAd onLoad");
      });
      n.onError(function (e) {
        console.log("RewardedVideoAd onError", e);
      });
      n.onClose(function (e) {
        if (e && e.isEnded || void 0 === e) {
          t.callRewardAdCallback(!0);
          cc.pvz.TAUtils.trackAdClose(t.rewardVideoIndex, !0);
        } else {
          t.callRewardAdCallback(!1);
          cc.pvz.TAUtils.trackAdClose(t.rewardVideoIndex, !1);
        }
      });
    }
  },
  initP8AdInfo: function initP8AdInfo() {
    if (cc.sys.platform == cc.sys.WECHAT_GAME) {
      P8SDK.wxADinit(cc.pvz.GameConst.AD_UNITS_REWARD[0], null, null, null);
    }
  },
  initRewardVideo: function initRewardVideo() {
    var e = this;

    if (cc.sys.platform == cc.sys.WECHAT_GAME) {
      a = new Array(cc.pvz.GameConst.AD_UNITS_REWARD.length).fill(null);

      if ("devtools" != (wx.getDeviceInfo ? wx.getDeviceInfo() : wx.getSystemInfoSync()).platform) {
        i.forEach(function (t) {
          a[t] = e.createRewardAd(t);
        }), console.log("initRewardVideo ended");
      } else {
        console.log("initRewardVideo skiped");
      }
    }
  },
  showAdRewardVideo: function showAdRewardVideo(e, t) {
    console.log("showAdRewardVideo", e);

    if (cc.isControlAd) {
      var o = this;
      o.cb = t;
      o.rewardVideoIndex = e;
      o.hasCalledCB = !1;

      if (10 == cc.player.adTimes && [cc.pvz.GameConfig.AdType["广告格子"], cc.pvz.GameConfig.AdType["buff刷新"], cc.pvz.GameConfig.AdType["buff全部"], cc.pvz.GameConfig.AdType["关卡结算"], cc.pvz.GameConfig.AdType["阳光"], cc.pvz.GameConfig.AdType["死亡复活"], cc.pvz.GameConfig.AdType["双倍速度"]].some(function (t) {
        return t == e;
      })) {
        return void cc.pvz.TAUtils.share(e, function (e) {
          o.callRewardAdCallback(e);
        });
      }

      cc.pvz.TAUtils.trackP8AdClick(e);

      if (cc.sys.platform == cc.sys.WIN32 || cc.sys.platform == cc.sys.MACOS || cc.sys.platform == cc.sys.DESKTOP_BROWSER || cc.sys.platform == cc.sys.MOBILE_BROWSER) {
        cc.popupManager.showToast("广告" + e);
        return void o.callRewardAdCallback(!0);
      }

      if (cc.pvz.cloud.access >= 90) {
        o.callRewardAdCallback(!0);
      } else {
        cc.butler.pauseDirector(0);
        P8SDK.videoADShow(function () {
          o.callRewardAdCallback(!0);
        }, function () {
          o.callRewardAdCallback(!1);
        }, function () {
          cc.popupManager.showToast("暂无广告可看");
          o.callRewardAdCallback(!1);
        });
      }
    } else {
      cc.popupManager.showToast("暂无广告可看");
    }
  },
  showAdBanner: function showAdBanner(e) {
    if (void 0 === e) {
      e = !1;
    }
  },
  hideAdBanner: function hideAdBanner() {}
};

if (cc.pvz) {//
} else {
  cc.pvz = {};
}

cc.pvz.AdUtils = c;
module.exports = c;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL0FkVXRpbHMuanMiXSwibmFtZXMiOlsibyIsImEiLCJuIiwiaSIsImMiLCJpbml0QWxsQWRzIiwiY2MiLCJzeXMiLCJwbGF0Zm9ybSIsIldFQ0hBVF9HQU1FIiwid3giLCJnZXRMYXVuY2hPcHRpb25zU3luYyIsImlzQ29udHJvbEFkIiwiaW5pdFA4QWRJbmZvIiwiZ2V0TGF1bmNoT3B0aW9ucyIsImlzV2hpdGVMaXN0IiwiaXNXaGl0ZUxpc3RTY2VuZUlkIiwicHZ6IiwiVEFVdGlscyIsImdldFR3dHJhY2VpZFN3aXRjaCIsIkdhbWVDb25zdCIsIlR3dHJhY2VpZF9ZWEJOIiwiVHd0cmFjZWlkX1lYU1AiLCJmaW5kSW5kZXgiLCJlIiwic2NlbmUiLCJnZXRUd3RyYWNlaWRGcm9tIiwiT2JqZWN0Iiwia2V5cyIsInF1ZXJ5IiwibGVuZ3RoIiwidCIsImNhbGxSZXdhcmRBZENhbGxiYWNrIiwiYnV0bGVyIiwicmVzdW1lRGlyZWN0b3IiLCJoYXNDYWxsZWRDQiIsImNvbnNvbGUiLCJsb2ciLCJwbGF5ZXIiLCJhZFRpbWVzIiwiUGxheWVyRGF0YSIsImFkZE1pc3Npb25Qcm9ncmVzcyIsIkdhbWVDb25maWciLCJNaXNzaW9uVHlwZSIsInNhdmVEYXRhIiwidHJhY2tQOEFkU3VjYyIsInJld2FyZFZpZGVvSW5kZXgiLCJjYiIsIm5vZGUiLCJlbWl0IiwidHJhY2siLCJtZXNzYWdlIiwic3RhY2siLCJjcmVhdGVSZXdhcmRBZCIsImNyZWF0ZVJld2FyZGVkVmlkZW9BZCIsImFkVW5pdElkIiwiQURfVU5JVFNfUkVXQVJEIiwibXVsdGl0b24iLCJvbkxvYWQiLCJvbkVycm9yIiwiZXJyQ29kZSIsImVycl9jb2RlIiwiZXJyTXNnIiwib25DbG9zZSIsImlzRW5kZWQiLCJ0cmFja0FkQ2xvc2UiLCJjcmVhdGVQdWJsaWNSZXdhcmRBZCIsIlA4U0RLIiwid3hBRGluaXQiLCJpbml0UmV3YXJkVmlkZW8iLCJBcnJheSIsImZpbGwiLCJnZXREZXZpY2VJbmZvIiwiZ2V0U3lzdGVtSW5mb1N5bmMiLCJmb3JFYWNoIiwic2hvd0FkUmV3YXJkVmlkZW8iLCJBZFR5cGUiLCJzb21lIiwic2hhcmUiLCJ0cmFja1A4QWRDbGljayIsIldJTjMyIiwiTUFDT1MiLCJERVNLVE9QX0JST1dTRVIiLCJNT0JJTEVfQlJPV1NFUiIsInBvcHVwTWFuYWdlciIsInNob3dUb2FzdCIsImNsb3VkIiwiYWNjZXNzIiwicGF1c2VEaXJlY3RvciIsInZpZGVvQURTaG93Iiwic2hvd0FkQmFubmVyIiwiaGlkZUFkQmFubmVyIiwiQWRVdGlscyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBQyxHQUFHLElBQVI7QUFDQSxJQUFJQyxDQUFDLEdBQUcsSUFBUjtBQUNBLElBQUlDLENBQUMsR0FBRyxJQUFSO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHLENBQUMsQ0FBRCxDQUFSO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHO0VBQ0pDLFVBQVUsRUFBRSxzQkFBWTtJQUNwQixJQUFJQyxFQUFFLENBQUNDLEdBQUgsQ0FBT0MsUUFBUCxJQUFtQkYsRUFBRSxDQUFDQyxHQUFILENBQU9FLFdBQTlCLEVBQTJDO01BQ3ZDVCxDQUFDLEdBQUdVLEVBQUUsQ0FBQ0Msb0JBQUgsRUFBSjtJQUNIOztJQUNELElBQUlMLEVBQUUsQ0FBQ00sV0FBUCxFQUFvQjtNQUNoQixLQUFLQyxZQUFMO0lBQ0g7RUFDSixDQVJHO0VBU0pDLGdCQUFnQixFQUFFLDRCQUFZO0lBQzFCLE9BQU9kLENBQVA7RUFDSCxDQVhHO0VBWUplLFdBQVcsRUFBRSx1QkFBWTtJQUNyQixPQUNJVCxFQUFFLENBQUNDLEdBQUgsQ0FBT0MsUUFBUCxJQUFtQkYsRUFBRSxDQUFDQyxHQUFILENBQU9FLFdBQTFCLElBQ0EsS0FBS08sa0JBQUwsRUFEQSxJQUVBVixFQUFFLENBQUNXLEdBQUgsQ0FBT0MsT0FBUCxDQUFlQyxrQkFBZixDQUFrQ2IsRUFBRSxDQUFDVyxHQUFI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O0VBQ0osQ0EzTEc7RUE0TEpLLFlBQVksRUFBRSxzQkFBVWxFLENBQVYsRUFBYTtJQUN2QixJQUFJLEtBQUssQ0FBTCxLQUFXQSxDQUFmLEVBQWtCO01BQ2RBLENBQUMsR0FBRyxDQUFDLENBQUw7SUFDSDtFQUNKLENBaE1HO0VBaU1KbUUsWUFBWSxFQUFFLHdCQUFZLENBQUU7QUFqTXhCLENBQVI7O0FBbU1BLElBQUlyRixFQUFFLENBQUNXLEdBQVAsRUFBWSxDQUNSO0FBQ0gsQ0FGRCxNQUVPO0VBQ0hYLEVBQUUsQ0FBQ1csR0FBSCxHQUFTLEVBQVQ7QUFDSDs7QUFDRFgsRUFBRSxDQUFDVyxHQUFILENBQU8yRSxPQUFQLEdBQWlCeEYsQ0FBakI7QUFDQXlGLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjFGLENBQWpCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbyA9IG51bGw7XG52YXIgYSA9IG51bGw7XG52YXIgbiA9IG51bGw7XG52YXIgaSA9IFswXTtcbnZhciBjID0ge1xuICAgIGluaXRBbGxBZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGNjLnN5cy5wbGF0Zm9ybSA9PSBjYy5zeXMuV0VDSEFUX0dBTUUpIHtcbiAgICAgICAgICAgIG8gPSB3eC5nZXRMYXVuY2hPcHRpb25zU3luYygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYy5pc0NvbnRyb2xBZCkge1xuICAgICAgICAgICAgdGhpcy5pbml0UDhBZEluZm8oKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgZ2V0TGF1bmNoT3B0aW9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbztcbiAgICB9LFxuICAgIGlzV2hpdGVMaXN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjYy5zeXMucGxhdGZvcm0gIT0gY2Muc3lzLldFQ0hBVF9HQU1FIHx8XG4gICAgICAgICAgICB0aGlzLmlzV2hpdGVMaXN0U2NlbmVJZCgpIHx8XG4gICAgICAgICAgICBjYy5wdnouVEFVdGlscy5nZXRUd3RyYWNlaWRTd2l0Y2goY2MucHZ6LkdhbWVDb25zdC5Ud3RyYWNlaWRfWVhCTikgfHxcbiAgICAgICAgICAgIGNjLnB2ei5UQVV0aWxzLmdldFR3dHJhY2VpZFN3aXRjaChjYy5wdnouR2FtZUNvbnN0LlR3dHJhY2VpZF9ZWFNQKVxuICAgICAgICApO1xuICAgIH0sXG4gICAgaXNXaGl0ZUxpc3RTY2VuZUlkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjYy5zeXMucGxhdGZvcm0gIT0gY2Muc3lzLldFQ0hBVF9HQU1FIHx8XG4gICAgICAgICAgICAtMSAhPVxuICAgICAgICAgICAgICAgIFsxMDk1XS5maW5kSW5kZXgoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPT0gby5zY2VuZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH0sXG4gICAgZ2V0VHd0cmFjZWlkRnJvbTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKGUucXVlcnkpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIHQgaW4gZS5xdWVyeSkge1xuICAgICAgICAgICAgICAgIGlmIChcIj90d3RyYWNlaWRcIiA9PSB0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLnF1ZXJ5W3RdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoXCJ0d3RyYWNlaWRcIiA9PSB0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLnF1ZXJ5W3RdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9LFxuICAgIGNhbGxSZXdhcmRBZENhbGxiYWNrOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjYy5idXRsZXIucmVzdW1lRGlyZWN0b3IoMCk7XG4gICAgICAgIGlmICh0aGlzLmhhc0NhbGxlZENCKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhbGxSZXdhcmRBZENhbGxiYWNrIGJ1dCBoYXNjYWxsZWRcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlICYmXG4gICAgICAgICAgICAgICAgKGNjLnBsYXllci5hZFRpbWVzKyssXG4gICAgICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEuYWRkTWlzc2lvblByb2dyZXNzKGNjLnB2ei5HYW1lQ29uZmlnLk1pc3Npb25UeXBlW1wi6KeC55yL5bm/5ZGKbuasoVwiXSwgMSksXG4gICAgICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEuc2F2ZURhdGEoKSxcbiAgICAgICAgICAgICAgICBjYy5wdnouVEFVdGlscy50cmFja1A4QWRTdWNjKHRoaXMucmV3YXJkVmlkZW9JbmRleCkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNiKGUpLCBjYy5idXRsZXIubm9kZS5lbWl0KFwiYWRcIiksICh0aGlzLmhhc0NhbGxlZENCID0gITApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYy5wdnouVEFVdGlscy50cmFjayhcImVycm9yXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJBZFwiLFxuICAgICAgICAgICAgICAgICAgICBzdGFjazogXCJjYiBpcyBudWxsLGlzRW5kZWQ6XCIgKyBlICsgXCIsaW5kZXg6XCIgKyB0aGlzLnJld2FyZFZpZGVvSW5kZXhcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgY3JlYXRlUmV3YXJkQWQ6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgdmFyIG8gPSB3eC5jcmVhdGVSZXdhcmRlZFZpZGVvQWQoe1xuICAgICAgICAgICAgYWRVbml0SWQ6IGNjLnB2ei5HYW1lQ29uc3QuQURfVU5JVFNfUkVXQVJEW2VdLFxuICAgICAgICAgICAgbXVsdGl0b246ICEwXG4gICAgICAgIH0pO1xuICAgICAgICBvLm9uTG9hZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJld2FyZGVkVmlkZW9BZCBvbkxvYWRcIiwgZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBvLm9uRXJyb3IoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmV3YXJkZWRWaWRlb0FkIG9uRXJyb3JcIiwgZSwgdCk7XG4gICAgICAgICAgICBjYy5wdnouVEFVdGlscy50cmFjayhcImFkRXJyb3JcIiwge1xuICAgICAgICAgICAgICAgIGVyckNvZGU6IHQuZXJyQ29kZSB8fCB0LmVycl9jb2RlLFxuICAgICAgICAgICAgICAgIGVyck1zZzogdC5lcnJNc2dcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgby5vbkNsb3NlKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoKGUgJiYgZS5pc0VuZGVkKSB8fCB2b2lkIDAgPT09IGUpIHtcbiAgICAgICAgICAgICAgICB0LmNhbGxSZXdhcmRBZENhbGxiYWNrKCEwKTtcbiAgICAgICAgICAgICAgICBjYy5wdnouVEFVdGlscy50cmFja0FkQ2xvc2UodC5yZXdhcmRWaWRlb0luZGV4LCAhMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHQuY2FsbFJld2FyZEFkQ2FsbGJhY2soITEpO1xuICAgICAgICAgICAgICAgIGNjLnB2ei5UQVV0aWxzLnRyYWNrQWRDbG9zZSh0LnJld2FyZFZpZGVvSW5kZXgsICExKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvO1xuICAgIH0sXG4gICAgY3JlYXRlUHVibGljUmV3YXJkQWQ6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgdmFyIG8gPSAhbjtcbiAgICAgICAgbiA9IHd4LmNyZWF0ZVJld2FyZGVkVmlkZW9BZCh7XG4gICAgICAgICAgICBhZFVuaXRJZDogY2MucHZ6LkdhbWVDb25zdC5BRF9VTklUU19SRVdBUkRbZV1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChvKSB7XG4gICAgICAgICAgICBuLm9uTG9hZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXdhcmRlZFZpZGVvQWQgb25Mb2FkXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBuLm9uRXJyb3IoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJld2FyZGVkVmlkZW9BZCBvbkVycm9yXCIsIGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBuLm9uQ2xvc2UoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoKGUgJiYgZS5pc0VuZGVkKSB8fCB2b2lkIDAgPT09IGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdC5jYWxsUmV3YXJkQWRDYWxsYmFjayghMCk7XG4gICAgICAgICAgICAgICAgICAgIGNjLnB2ei5UQVV0aWxzLnRyYWNrQWRDbG9zZSh0LnJld2FyZFZpZGVvSW5kZXgsICEwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0LmNhbGxSZXdhcmRBZENhbGxiYWNrKCExKTtcbiAgICAgICAgICAgICAgICAgICAgY2MucHZ6LlRBVXRpbHMudHJhY2tBZENsb3NlKHQucmV3YXJkVmlkZW9JbmRleCwgITEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBpbml0UDhBZEluZm86IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGNjLnN5cy5wbGF0Zm9ybSA9PSBjYy5zeXMuV0VDSEFUX0dBTUUpIHtcbiAgICAgICAgICAgIFA4U0RLLnd4QURpbml0KGNjLnB2ei5HYW1lQ29uc3QuQURfVU5JVFNfUkVXQVJEWzBdLCBudWxsLCBudWxsLCBudWxsKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgaW5pdFJld2FyZFZpZGVvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlID0gdGhpcztcbiAgICAgICAgaWYgKGNjLnN5cy5wbGF0Zm9ybSA9PSBjYy5zeXMuV0VDSEFUX0dBTUUpIHtcbiAgICAgICAgICAgIGEgPSBuZXcgQXJyYXkoY2MucHZ6LkdhbWVDb25zdC5BRF9VTklUU19SRVdBUkQubGVuZ3RoKS5maWxsKG51bGwpO1xuICAgICAgICAgICAgaWYgKFwiZGV2dG9vbHNcIiAhPSAod3guZ2V0RGV2aWNlSW5mbyA/IHd4LmdldERldmljZUluZm8oKSA6IHd4LmdldFN5c3RlbUluZm9TeW5jKCkpLnBsYXRmb3JtKSB7XG4gICAgICAgICAgICAgICAgaS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGFbdF0gPSBlLmNyZWF0ZVJld2FyZEFkKHQpO1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImluaXRSZXdhcmRWaWRlbyBlbmRlZFwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbml0UmV3YXJkVmlkZW8gc2tpcGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBzaG93QWRSZXdhcmRWaWRlbzogZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJzaG93QWRSZXdhcmRWaWRlb1wiLCBlKTtcbiAgICAgICAgaWYgKGNjLmlzQ29udHJvbEFkKSB7XG4gICAgICAgICAgICB2YXIgbyA9IHRoaXM7XG4gICAgICAgICAgICBvLmNiID0gdDtcbiAgICAgICAgICAgIG8ucmV3YXJkVmlkZW9JbmRleCA9IGU7XG4gICAgICAgICAgICBvLmhhc0NhbGxlZENCID0gITE7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgMTAgPT0gY2MucGxheWVyLmFkVGltZXMgJiZcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgIGNjLnB2ei5HYW1lQ29uZmlnLkFkVHlwZVtcIuW5v+WRiuagvOWtkFwiXSxcbiAgICAgICAgICAgICAgICAgICAgY2MucHZ6LkdhbWVDb25maWcuQWRUeXBlW1wiYnVmZuWIt+aWsFwiXSxcbiAgICAgICAgICAgICAgICAgICAgY2MucHZ6LkdhbWVDb25maWcuQWRUeXBlW1wiYnVmZuWFqOmDqFwiXSxcbiAgICAgICAgICAgICAgICAgICAgY2MucHZ6LkdhbWVDb25maWcuQWRUeXBlW1wi5YWz5Y2h57uT566XXCJdLFxuICAgICAgICAgICAgICAgICAgICBjYy5wdnouR2FtZUNvbmZpZy5BZFR5cGVbXCLpmLPlhYlcIl0sXG4gICAgICAgICAgICAgICAgICAgIGNjLnB2ei5HYW1lQ29uZmlnLkFkVHlwZVtcIuatu+S6oeWkjea0u1wiXSxcbiAgICAgICAgICAgICAgICAgICAgY2MucHZ6LkdhbWVDb25maWcuQWRUeXBlW1wi5Y+M5YCN6YCf5bqmXCJdXG4gICAgICAgICAgICAgICAgXS5zb21lKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0ID09IGU7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkIGNjLnB2ei5UQVV0aWxzLnNoYXJlKGUsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIG8uY2FsbFJld2FyZEFkQ2FsbGJhY2soZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYy5wdnouVEFVdGlscy50cmFja1A4QWRDbGljayhlKTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBjYy5zeXMucGxhdGZvcm0gPT0gY2Muc3lzLldJTjMyIHx8XG4gICAgICAgICAgICAgICAgY2Muc3lzLnBsYXRmb3JtID09IGNjLnN5cy5NQUNPUyB8fFxuICAgICAgICAgICAgICAgIGNjLnN5cy5wbGF0Zm9ybSA9PSBjYy5zeXMuREVTS1RPUF9CUk9XU0VSIHx8XG4gICAgICAgICAgICAgICAgY2Muc3lzLnBsYXRmb3JtID09IGNjLnN5cy5NT0JJTEVfQlJPV1NFUlxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgY2MucG9wdXBNYW5hZ2VyLnNob3dUb2FzdChcIuW5v+WRilwiICsgZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgby5jYWxsUmV3YXJkQWRDYWxsYmFjayghMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2MucHZ6LmNsb3VkLmFjY2VzcyA+PSA5MCkge1xuICAgICAgICAgICAgICAgIG8uY2FsbFJld2FyZEFkQ2FsbGJhY2soITApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYy5idXRsZXIucGF1c2VEaXJlY3RvcigwKTtcbiAgICAgICAgICAgICAgICBQOFNESy52aWRlb0FEU2hvdyhcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgby5jYWxsUmV3YXJkQWRDYWxsYmFjayghMCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG8uY2FsbFJld2FyZEFkQ2FsbGJhY2soITEpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5wb3B1cE1hbmFnZXIuc2hvd1RvYXN0KFwi5pqC5peg5bm/5ZGK5Y+v55yLXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgby5jYWxsUmV3YXJkQWRDYWxsYmFjayghMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2MucG9wdXBNYW5hZ2VyLnNob3dUb2FzdChcIuaaguaXoOW5v+WRiuWPr+eci1wiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2hvd0FkQmFubmVyOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodm9pZCAwID09PSBlKSB7XG4gICAgICAgICAgICBlID0gITE7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGhpZGVBZEJhbm5lcjogZnVuY3Rpb24gKCkge31cbn07XG5pZiAoY2MucHZ6KSB7XG4gICAgLy9cbn0gZWxzZSB7XG4gICAgY2MucHZ6ID0ge307XG59XG5jYy5wdnouQWRVdGlscyA9IGM7XG5tb2R1bGUuZXhwb3J0cyA9IGM7XG4iXX0=