
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/Role2.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '1d26brL2YpAL6MA/oh9YDuz', 'Role2');
// scripts/Role2.js

"use strict";

var $soundManager = require("./SoundManager");

var $tool = require("./Tool");

var $pool = require("./Pool");

var $battleGround2Ctrl = require("./BattleGround2Ctrl");

var $enemySpawner2 = require("./EnemySpawner2");

var $num2 = require("./Num2");

var l = cc._decorator;
var u = l.ccclass;
var p = l.property;

var d = function (e) {
  function t() {
    var t = null !== e && e.apply(this, arguments) || this;
    t.body = null;
    t.bulletSPos = null;
    t.bodySpine = null;
    t.bodySDS = [];
    t.collBody = null;
    t.team = 0;
    t.tCount = 0;
    t.v = 50;
    t.par = null;
    t.bulletConfig = {
      rate: 0,
      nums: 0,
      dmg: 0
    };
    t.hp = 100;
    t.state = 0;
    t.hpY = 0;
    t.isDragging = !1;
    t.dXYRec = [0, 0];
    t.hpNumberHandle = null;
    return t;
  }

  __extends(t, e);

  t.prototype.init = function (e) {
    if (void 0 === e) {
      e = {};
    }

    this.team = e.team;
    this.par = e.par;

    if (0 === this.team) {
      this.collBody.enabled = !1;
      this.bulletConfig = {
        rate: $battleGround2Ctrl["default"].JSONManager.ConfigBattle[6].v[5],
        nums: $battleGround2Ctrl["default"].JSONManager.ConfigBattle[6].v[3],
        dmg: $battleGround2Ctrl["default"].JSONManager.ConfigBattle[6].v[4]
      };
      this.initDragEvent();
    } else {
      this.bodySpine.skeletonData = this.bodySDS[e.rId];
      this.bodySpine.setAnimation(0, "Walk", !0);
      this.hp = e.config.hp;
      this.bodySpine.node.setScale(e.config.spineSize);
      this.hpY = e.config.hpy;
      this.v = $battleGround2Ctrl["default"].JSONManager.ConfigBattle[6].v[2];
      this.createNewHpNum();
    }

    this.par.refreshAtk();
  };

  t.prototype.initDragEvent = function () {
    var e = this;
    this.body.on(cc.Node.EventType.TOUCH_START, function (t) {
      e.isDragging = !0;
      e.dXYRec[0] = t.getLocationX();
      e.dXYRec[1] = t.getLocationY();
    });
    this.body.on(cc.Node.EventType.TOUCH_MOVE, function (t) {
      var o = t.getLocationX();
      var a = t.getLocationY();
      e.node.x += o - e.dXYRec[0];

      if (e.node.x < -300) {
        e.node.x = -300;
      } else {
        if (e.node.x > 300) {
          e.node.x = 300;
        }
      }

      e.dXYRec[0] = o;
      e.dXYRec[1] = a;
    });
    this.body.on(cc.Node.EventType.TOUCH_END, function () {
      e.isDragging = !1;
    });
    this.body.on(cc.Node.EventType.TOUCH_CANCEL, function () {
      e.isDragging = !1;
    });
  };

  t.prototype.createNewBullet = function (e) {
    if (10 === this.par.state && (this.tCount += e, !(this.tCount < this.bulletConfig.rate))) {
      this.tCount -= this.bulletConfig.rate;
      var t = $battleGround2Ctrl["default"].JSONManager.ConfigBattle[6].v[7];
      var o = this.node.x + this.bulletSPos.x - Math.floor(this.bulletConfig.nums / 2) * t;
      var a = this.node.y + this.bulletSPos.y;

      for (var n = 0; n < this.bulletConfig.nums; n++) {
        this.par.createNewBullet(o, a, {
          dmg: this.bulletConfig.dmg
        });
        o += t;
      }

      this.bodySpine.setAnimation(1, "atk", !1);
    }
  };

  t.prototype.createNewHpNum = function () {
    this.hpNumberHandle = this.par.createNewHpNum(this);
  };

  t.prototype.moving = function (e) {
    if (10 === this.par.state) {
      this.node.y -= this.v * e;

      if (this.node.y < this.par.endLineY + this.node.height / 2) {
        this.par.beHit();
        this.remove();
      }
    }
  };

  t.prototype.beHit = function (e) {
    this.hp -= e.dmg;

    if (this.hp <= 0) {
      this.par.createNewDieEff(this.node);
      this.par.node.getComponent($enemySpawner2["default"]).updateEnemyHandles(this.node.x);
      this.remove();
      $soundManager["default"].playEffect2($tool["default"].randomInt(3, 5));
    } else {
      this.hpNumberHandle.getComponent($num2["default"]).changeHpTo();
    }
  };

  t.prototype.remove = function () {
    this.hpNumberHandle.parent.getComponent($pool["default"]).destroyPoolItem(this.hpNumberHandle);
    this.node.parent.getComponent($pool["default"]).destroyPoolItem(this.node);
  };

  t.prototype.start = function () {};

  t.prototype.update = function (e) {
    if (0 === this.team) {
      this.createNewBullet(e);
    } else {
      this.moving(e);
    }
  };

  __decorate([p(cc.Node)], t.prototype, "body", void 0);

  __decorate([p(cc.Node)], t.prototype, "bulletSPos", void 0);

  __decorate([p(sp.Skeleton)], t.prototype, "bodySpine", void 0);

  __decorate([p(sp.SkeletonData)], t.prototype, "bodySDS", void 0);

  __decorate([p(cc.BoxCollider)], t.prototype, "collBody", void 0);

  return __decorate([u], t);
}(cc.Component);

exports["default"] = d;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL1JvbGUyLmpzIl0sIm5hbWVzIjpbIiRzb3VuZE1hbmFnZXIiLCJyZXF1aXJlIiwiJHRvb2wiLCIkcG9vbCIsIiRiYXR0bGVHcm91bmQyQ3RybCIsIiRlbmVteVNwYXduZXIyIiwiJG51bTIiLCJsIiwiY2MiLCJfZGVjb3JhdG9yIiwidSIsImNjY2xhc3MiLCJwIiwicHJvcGVydHkiLCJkIiwiZSIsInQiLCJhcHBseSIsImFyZ3VtZW50cyIsImJvZHkiLCJidWxsZXRTUG9zIiwiYm9keVNwaW5lIiwiYm9keVNEUyIsImNvbGxCb2R5IiwidGVhbSIsInRDb3VudCIsInYiLCJwYXIiLCJidWxsZXRDb25maWciLCJyYXRlIiwibnVtcyIsImRtZyIsImhwIiwic3RhdGUiLCJocFkiLCJpc0RyYWdnaW5nIiwiZFhZUmVjIiwiaHBOdW1iZXJIYW5kbGUiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0IiwiZW5hYmxlZCIsIkpTT05NYW5hZ2VyIiwiQ29uZmlnQmF0dGxlIiwiaW5pdERyYWdFdmVudCIsInNrZWxldG9uRGF0YSIsInJJZCIsInNldEFuaW1hdGlvbiIsImNvbmZpZyIsIm5vZGUiLCJzZXRTY2FsZSIsInNwaW5lU2l6ZSIsImhweSIsImNyZWF0ZU5ld0hwTnVtIiwicmVmcmVzaEF0ayIsIm9uIiwiTm9kZSIsIkV2ZW50VHlwZSIsIlRPVUNIX1NUQVJUIiwiZ2V0TG9jYXRpb25YIiwiZ2V0TG9jYXRpb25ZIiwiVE9VQ0hfTU9WRSIsIm8iLCJhIiwieCIsIlRPVUNIX0VORCIsIlRPVUNIX0NBTkNFTCIsImNyZWF0ZU5ld0J1bGxldCIsIk1hdGgiLCJmbG9vciIsInkiLCJuIiwibW92aW5nIiwiZW5kTGluZVkiLCJoZWlnaHQiLCJiZUhpdCIsInJlbW92ZSIsImNyZWF0ZU5ld0RpZUVmZiIsImdldENvbXBvbmVudCIsInVwZGF0ZUVuZW15SGFuZGxlcyIsInBsYXlFZmZlY3QyIiwicmFuZG9tSW50IiwiY2hhbmdlSHBUbyIsInBhcmVudCIsImRlc3Ryb3lQb29sSXRlbSIsInN0YXJ0IiwidXBkYXRlIiwiX19kZWNvcmF0ZSIsInNwIiwiU2tlbGV0b24iLCJTa2VsZXRvbkRhdGEiLCJCb3hDb2xsaWRlciIsIkNvbXBvbmVudCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsYUFBYSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUFuQjs7QUFDQSxJQUFJRSxLQUFLLEdBQUdGLE9BQU8sQ0FBQyxRQUFELENBQW5COztBQUNBLElBQUlHLGtCQUFrQixHQUFHSCxPQUFPLENBQUMscUJBQUQsQ0FBaEM7O0FBQ0EsSUFBSUksY0FBYyxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSUssS0FBSyxHQUFHTCxPQUFPLENBQUMsUUFBRCxDQUFuQjs7QUFDQSxJQUFJTSxDQUFDLEdBQUdDLEVBQUUsQ0FBQ0MsVUFBWDtBQUNBLElBQUlDLENBQUMsR0FBR0gsQ0FBQyxDQUFDSSxPQUFWO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHTCxDQUFDLENBQUNNLFFBQVY7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFJLFVBQVVDLENBQVYsRUFBYTtFQUNsQixTQUFTQyxDQUFULEdBQWE7SUFDVCxJQUFJQSxDQUFDLEdBQUksU0FBU0QsQ0FBVCxJQUFjQSxDQUFDLENBQUNFLEtBQUYsQ0FBUSxJQUFSLEVBQWNDLFNBQWQsQ0FBZixJQUE0QyxJQUFwRDtJQUNBRixDQUFDLENBQUNHLElBQUYsR0FBUyxJQUFUO0lBQ0FILENBQUMsQ0FBQ0ksVUFBRixHQUFlLElBQWY7SUFDQUosQ0FBQyxDQUFDSyxTQUFGLEdBQWMsSUFBZDtJQUNBTCxDQUFDLENBQUNNLE9BQUYsR0FBWSxFQUFaO0lBQ0FOLENBQUMsQ0FBQ08sUUFBRixHQUFhLElBQWI7SUFDQVAsQ0FBQyxDQUFDUSxJQUFGLEdBQVMsQ0FBVDtJQUNBUixDQUFDLENBQUNTLE1B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LENBQUQsRUFBZXhDLENBQUMsQ0FBQ3VCLFNBQWpCLEVBQTRCLFlBQTVCLEVBQTBDLEtBQUssQ0FBL0MsQ0FBVjs7RUFDQWdELFVBQVUsQ0FBQyxDQUFDM0UsQ0FBQyxDQUFDNEUsRUFBRSxDQUFDQyxRQUFKLENBQUYsQ0FBRCxFQUFtQnpFLENBQUMsQ0FBQ3VCLFNBQXJCLEVBQWdDLFdBQWhDLEVBQTZDLEtBQUssQ0FBbEQsQ0FBVjs7RUFDQWdELFVBQVUsQ0FBQyxDQUFDM0UsQ0FBQyxDQUFDNEUsRUFBRSxDQUFDRSxZQUFKLENBQUYsQ0FBRCxFQUF1QjFFLENBQUMsQ0FBQ3VCLFNBQXpCLEVBQW9DLFNBQXBDLEVBQStDLEtBQUssQ0FBcEQsQ0FBVjs7RUFDQWdELFVBQVUsQ0FBQyxDQUFDM0UsQ0FBQyxDQUFDSixFQUFFLENBQUNtRixXQUFKLENBQUYsQ0FBRCxFQUFzQjNFLENBQUMsQ0FBQ3VCLFNBQXhCLEVBQW1DLFVBQW5DLEVBQStDLEtBQUssQ0FBcEQsQ0FBVjs7RUFDQSxPQUFPZ0QsVUFBVSxDQUFDLENBQUM3RSxDQUFELENBQUQsRUFBTU0sQ0FBTixDQUFqQjtBQUNILENBdklPLENBdUlMUixFQUFFLENBQUNvRixTQXZJRSxDQUFSOztBQXdJQUMsT0FBTyxXQUFQLEdBQWtCL0UsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciAkc291bmRNYW5hZ2VyID0gcmVxdWlyZShcIi4vU291bmRNYW5hZ2VyXCIpO1xudmFyICR0b29sID0gcmVxdWlyZShcIi4vVG9vbFwiKTtcbnZhciAkcG9vbCA9IHJlcXVpcmUoXCIuL1Bvb2xcIik7XG52YXIgJGJhdHRsZUdyb3VuZDJDdHJsID0gcmVxdWlyZShcIi4vQmF0dGxlR3JvdW5kMkN0cmxcIik7XG52YXIgJGVuZW15U3Bhd25lcjIgPSByZXF1aXJlKFwiLi9FbmVteVNwYXduZXIyXCIpO1xudmFyICRudW0yID0gcmVxdWlyZShcIi4vTnVtMlwiKTtcbnZhciBsID0gY2MuX2RlY29yYXRvcjtcbnZhciB1ID0gbC5jY2NsYXNzO1xudmFyIHAgPSBsLnByb3BlcnR5O1xudmFyIGQgPSAoZnVuY3Rpb24gKGUpIHtcbiAgICBmdW5jdGlvbiB0KCkge1xuICAgICAgICB2YXIgdCA9IChudWxsICE9PSBlICYmIGUuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcbiAgICAgICAgdC5ib2R5ID0gbnVsbDtcbiAgICAgICAgdC5idWxsZXRTUG9zID0gbnVsbDtcbiAgICAgICAgdC5ib2R5U3BpbmUgPSBudWxsO1xuICAgICAgICB0LmJvZHlTRFMgPSBbXTtcbiAgICAgICAgdC5jb2xsQm9keSA9IG51bGw7XG4gICAgICAgIHQudGVhbSA9IDA7XG4gICAgICAgIHQudENvdW50ID0gMDtcbiAgICAgICAgdC52ID0gNTA7XG4gICAgICAgIHQucGFyID0gbnVsbDtcbiAgICAgICAgdC5idWxsZXRDb25maWcgPSB7XG4gICAgICAgICAgICByYXRlOiAwLFxuICAgICAgICAgICAgbnVtczogMCxcbiAgICAgICAgICAgIGRtZzogMFxuICAgICAgICB9O1xuICAgICAgICB0LmhwID0gMTAwO1xuICAgICAgICB0LnN0YXRlID0gMDtcbiAgICAgICAgdC5ocFkgPSAwO1xuICAgICAgICB0LmlzRHJhZ2dpbmcgPSAhMTtcbiAgICAgICAgdC5kWFlSZWMgPSBbMCwgMF07XG4gICAgICAgIHQuaHBOdW1iZXJIYW5kbGUgPSBudWxsO1xuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgX19leHRlbmRzKHQsIGUpO1xuICAgIHQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodm9pZCAwID09PSBlKSB7XG4gICAgICAgICAgICBlID0ge307XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50ZWFtID0gZS50ZWFtO1xuICAgICAgICB0aGlzLnBhciA9IGUucGFyO1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy50ZWFtKSB7XG4gICAgICAgICAgICB0aGlzLmNvbGxCb2R5LmVuYWJsZWQgPSAhMTtcbiAgICAgICAgICAgIHRoaXMuYnVsbGV0Q29uZmlnID0ge1xuICAgICAgICAgICAgICAgIHJhdGU6ICRiYXR0bGVHcm91bmQyQ3RybC5kZWZhdWx0LkpTT05NYW5hZ2VyLkNvbmZpZ0JhdHRsZVs2XS52WzVdLFxuICAgICAgICAgICAgICAgIG51bXM6ICRiYXR0bGVHcm91bmQyQ3RybC5kZWZhdWx0LkpTT05NYW5hZ2VyLkNvbmZpZ0JhdHRsZVs2XS52WzNdLFxuICAgICAgICAgICAgICAgIGRtZzogJGJhdHRsZUdyb3VuZDJDdHJsLmRlZmF1bHQuSlNPTk1hbmFnZXIuQ29uZmlnQmF0dGxlWzZdLnZbNF1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmluaXREcmFnRXZlbnQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYm9keVNwaW5lLnNrZWxldG9uRGF0YSA9IHRoaXMuYm9keVNEU1tlLnJJZF07XG4gICAgICAgICAgICB0aGlzLmJvZHlTcGluZS5zZXRBbmltYXRpb24oMCwgXCJXYWxrXCIsICEwKTtcbiAgICAgICAgICAgIHRoaXMuaHAgPSBlLmNvbmZpZy5ocDtcbiAgICAgICAgICAgIHRoaXMuYm9keVNwaW5lLm5vZGUuc2V0U2NhbGUoZS5jb25maWcuc3BpbmVTaXplKTtcbiAgICAgICAgICAgIHRoaXMuaHBZID0gZS5jb25maWcuaHB5O1xuICAgICAgICAgICAgdGhpcy52ID0gJGJhdHRsZUdyb3VuZDJDdHJsLmRlZmF1bHQuSlNPTk1hbmFnZXIuQ29uZmlnQmF0dGxlWzZdLnZbMl07XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZU5ld0hwTnVtKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXIucmVmcmVzaEF0aygpO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUuaW5pdERyYWdFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xuICAgICAgICB0aGlzLmJvZHkub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICBlLmlzRHJhZ2dpbmcgPSAhMDtcbiAgICAgICAgICAgIGUuZFhZUmVjWzBdID0gdC5nZXRMb2NhdGlvblgoKTtcbiAgICAgICAgICAgIGUuZFhZUmVjWzFdID0gdC5nZXRMb2NhdGlvblkoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYm9keS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgdmFyIG8gPSB0LmdldExvY2F0aW9uWCgpO1xuICAgICAgICAgICAgdmFyIGEgPSB0LmdldExvY2F0aW9uWSgpO1xuICAgICAgICAgICAgZS5ub2RlLnggKz0gbyAtIGUuZFhZUmVjWzBdO1xuICAgICAgICAgICAgaWYgKGUubm9kZS54IDwgLTMwMCkge1xuICAgICAgICAgICAgICAgIGUubm9kZS54ID0gLTMwMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGUubm9kZS54ID4gMzAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGUubm9kZS54ID0gMzAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGUuZFhZUmVjWzBdID0gbztcbiAgICAgICAgICAgIGUuZFhZUmVjWzFdID0gYTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYm9keS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGUuaXNEcmFnZ2luZyA9ICExO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ib2R5Lm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZS5pc0RyYWdnaW5nID0gITE7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUuY3JlYXRlTmV3QnVsbGV0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKDEwID09PSB0aGlzLnBhci5zdGF0ZSAmJiAoKHRoaXMudENvdW50ICs9IGUpLCAhKHRoaXMudENvdW50IDwgdGhpcy5idWxsZXRDb25maWcucmF0ZSkpKSB7XG4gICAgICAgICAgICB0aGlzLnRDb3VudCAtPSB0aGlzLmJ1bGxldENvbmZpZy5yYXRlO1xuICAgICAgICAgICAgdmFyIHQgPSAkYmF0dGxlR3JvdW5kMkN0cmwuZGVmYXVsdC5KU09OTWFuYWdlci5Db25maWdCYXR0bGVbNl0udls3XTtcbiAgICAgICAgICAgIHZhciBvID0gdGhpcy5ub2RlLnggKyB0aGlzLmJ1bGxldFNQb3MueCAtIE1hdGguZmxvb3IodGhpcy5idWxsZXRDb25maWcubnVtcyAvIDIpICogdDtcbiAgICAgICAgICAgIHZhciBhID0gdGhpcy5ub2RlLnkgKyB0aGlzLmJ1bGxldFNQb3MueTtcbiAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgdGhpcy5idWxsZXRDb25maWcubnVtczsgbisrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXIuY3JlYXRlTmV3QnVsbGV0KG8sIGEsIHtcbiAgICAgICAgICAgICAgICAgICAgZG1nOiB0aGlzLmJ1bGxldENvbmZpZy5kbWdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBvICs9IHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmJvZHlTcGluZS5zZXRBbmltYXRpb24oMSwgXCJhdGtcIiwgITEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5jcmVhdGVOZXdIcE51bSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ocE51bWJlckhhbmRsZSA9IHRoaXMucGFyLmNyZWF0ZU5ld0hwTnVtKHRoaXMpO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUubW92aW5nID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKDEwID09PSB0aGlzLnBhci5zdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5ub2RlLnkgLT0gdGhpcy52ICogZTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUueSA8IHRoaXMucGFyLmVuZExpbmVZICsgdGhpcy5ub2RlLmhlaWdodCAvIDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhci5iZUhpdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmJlSGl0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdGhpcy5ocCAtPSBlLmRtZztcbiAgICAgICAgaWYgKHRoaXMuaHAgPD0gMCkge1xuICAgICAgICAgICAgdGhpcy5wYXIuY3JlYXRlTmV3RGllRWZmKHRoaXMubm9kZSk7XG4gICAgICAgICAgICB0aGlzLnBhci5ub2RlLmdldENvbXBvbmVudCgkZW5lbXlTcGF3bmVyMi5kZWZhdWx0KS51cGRhdGVFbmVteUhhbmRsZXModGhpcy5ub2RlLngpO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICAgICAgICAgICRzb3VuZE1hbmFnZXIuZGVmYXVsdC5wbGF5RWZmZWN0MigkdG9vbC5kZWZhdWx0LnJhbmRvbUludCgzLCA1KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhwTnVtYmVySGFuZGxlLmdldENvbXBvbmVudCgkbnVtMi5kZWZhdWx0KS5jaGFuZ2VIcFRvKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ocE51bWJlckhhbmRsZS5wYXJlbnQuZ2V0Q29tcG9uZW50KCRwb29sLmRlZmF1bHQpLmRlc3Ryb3lQb29sSXRlbSh0aGlzLmhwTnVtYmVySGFuZGxlKTtcbiAgICAgICAgdGhpcy5ub2RlLnBhcmVudC5nZXRDb21wb25lbnQoJHBvb2wuZGVmYXVsdCkuZGVzdHJveVBvb2xJdGVtKHRoaXMubm9kZSk7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgIHQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICgwID09PSB0aGlzLnRlYW0pIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTmV3QnVsbGV0KGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tb3ZpbmcoZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW3AoY2MuTm9kZSldLCB0LnByb3RvdHlwZSwgXCJib2R5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbcChjYy5Ob2RlKV0sIHQucHJvdG90eXBlLCBcImJ1bGxldFNQb3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtwKHNwLlNrZWxldG9uKV0sIHQucHJvdG90eXBlLCBcImJvZHlTcGluZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3Aoc3AuU2tlbGV0b25EYXRhKV0sIHQucHJvdG90eXBlLCBcImJvZHlTRFNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtwKGNjLkJveENvbGxpZGVyKV0sIHQucHJvdG90eXBlLCBcImNvbGxCb2R5XCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW3VdLCB0KTtcbn0pKGNjLkNvbXBvbmVudCk7XG5leHBvcnRzLmRlZmF1bHQgPSBkO1xuIl19