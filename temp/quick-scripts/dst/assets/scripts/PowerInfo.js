
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/PowerInfo.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'f6670cqMmVPLpvkQfiIvCh6', 'PowerInfo');
// scripts/PowerInfo.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    powerLabel: cc.Label,
    powerTimeLabel: cc.Label
  },
  updatePowerInfo: function updatePowerInfo() {
    this.lastTime = 0;
    var e = 0;
    var t = cc.pvz.PlayerData.getPowerDate();

    if (t > 0) {
      var o = Math.abs(Date.now() - t) / 1e3;
      e = parseInt(o / cc.pvz.GameConfig.CdPowerTime);
    }

    if (e > 0 && !cc.pvz.PlayerData.isMaxPower()) {
      cc.pvz.PlayerData.addPower(e);
    }

    var a = cc.pvz.PlayerData.getPower();
    var n = cc.pvz.PlayerData.getMaxPower();
    this.powerLabel.string = a + "/" + n;
    this.isMaxPower = cc.pvz.PlayerData.isMaxPower();
    this.powerTimeLabel.node.active = !this.isMaxPower;

    if (!this.isMaxPower) {
      if (t < 0) {
        cc.player.powerDate = Date.now() + 1e3 * cc.pvz.GameConfig.CdPowerTime;
        t = cc.player.powerDate;
      }

      var i = Math.abs(Date.now() - t) / 1e3;
      this.lastTime = parseInt(i) - e * cc.pvz.GameConfig.CdPowerTime;
      this.powerTimeLabel.string = cc.pvz.utils.formatSeconds2(this.lastTime);
      this.schedule(this.onRefreshTime, 1);
    }
  },
  onRefreshTime: function onRefreshTime() {
    this.lastTime--;

    if (0 == this.lastTime) {
      if (cc.pvz.PlayerData.isMaxPower()) {//
      } else {
        cc.pvz.PlayerData.addPower(1);
      }

      var e = cc.pvz.PlayerData.getPower();
      var t = cc.pvz.PlayerData.getMaxPower();
      this.powerLabel.string = e + "/" + t;
      this.isMaxPower = cc.pvz.PlayerData.isMaxPower();

      if (this.isMaxPower) {
        this.powerTimeLabel.node.active = !1;
        return void this.unschedule(this.onRefreshTime, this);
      }

      this.lastTime = cc.pvz.GameConfig.CdPowerTime;
    }

    this.powerTimeLabel.string = cc.pvz.utils.formatSeconds2(this.lastTime);
  },
  checkPowerShow: function checkPowerShow() {
    var e = cc.pvz.PlayerData.getPower();
    var t = cc.pvz.PlayerData.getMaxPower();
    this.powerLabel.string = e + "/" + t;

    if (e >= t) {
      this.powerTimeLabel.node.active = !1;
      return void this.unscheduleAllCallbacks();
    }

    if (this.powerTimeLabel.node.active) {//
    } else {
      this.lastTime = cc.pvz.GameConfig.CdPowerTime;
      this.powerTimeLabel.node.active = !0;
      this.powerTimeLabel.string = cc.pvz.utils.formatSeconds2(this.lastTime);
      this.schedule(this.onRefreshTime, 1);
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL1Bvd2VySW5mby5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsInBvd2VyTGFiZWwiLCJMYWJlbCIsInBvd2VyVGltZUxhYmVsIiwidXBkYXRlUG93ZXJJbmZvIiwibGFzdFRpbWUiLCJlIiwidCIsInB2eiIsIlBsYXllckRhdGEiLCJnZXRQb3dlckRhdGUiLCJvIiwiTWF0aCIsImFicyIsIkRhdGUiLCJub3ciLCJwYXJzZUludCIsIkdhbWVDb25maWciLCJDZFBvd2VyVGltZSIsImlzTWF4UG93ZXIiLCJhZGRQb3dlciIsImEiLCJnZXRQb3dlciIsIm4iLCJnZXRNYXhQb3dlciIsInN0cmluZyIsIm5vZGUiLCJhY3RpdmUiLCJwbGF5ZXIiLCJwb3dlckRhdGUiLCJpIiwidXRpbHMiLCJmb3JtYXRTZWNvbmRzMiIsInNjaGVkdWxlIiwib25SZWZyZXNoVGltZSIsInVuc2NoZWR1bGUiLCJjaGVja1Bvd2VyU2hvdyIsInVuc2NoZWR1bGVBbGxDYWxsYmFja3MiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUFBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0VBQ0wsV0FBU0QsRUFBRSxDQUFDRSxTQURQO0VBRUxDLFVBQVUsRUFBRTtJQUNSQyxVQUFVLEVBQUVKLEVBQUUsQ0FBQ0ssS0FEUDtJQUVSQyxjQUFjLEVBQUVOLEVBQUUsQ0FBQ0s7RUFGWCxDQUZQO0VBTUxFLGVBQWUsRUFBRSwyQkFBWTtJQUN6QixLQUFLQyxRQUFMLEdBQWdCLENBQWhCO0lBQ0EsSUFBSUMsQ0FBQyxHQUFHLENBQVI7SUFDQSxJQUFJQyxDQUFDLEdBQUdWLEVBQUUsQ0FBQ1csR0FBSCxDQUFPQyxVQUFQLENBQWtCQyxZQUFsQixFQUFSOztJQUNBLElBQUlILENBQUMsR0FBRyxDQUFSLEVBQVc7TUFDUCxJQUFJSSxDQUFDLEdBQUdDLElBQUksQ0FBQ0MsR0FBTCxDQUFTQyxJQUFJLENBQUNDLEdBQUws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QUtDLGFBQW5CLEVBQWtDLENBQWxDO0lBQ0g7RUFDSjtBQXJFSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgcG93ZXJMYWJlbDogY2MuTGFiZWwsXG4gICAgICAgIHBvd2VyVGltZUxhYmVsOiBjYy5MYWJlbFxuICAgIH0sXG4gICAgdXBkYXRlUG93ZXJJbmZvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubGFzdFRpbWUgPSAwO1xuICAgICAgICB2YXIgZSA9IDA7XG4gICAgICAgIHZhciB0ID0gY2MucHZ6LlBsYXllckRhdGEuZ2V0UG93ZXJEYXRlKCk7XG4gICAgICAgIGlmICh0ID4gMCkge1xuICAgICAgICAgICAgdmFyIG8gPSBNYXRoLmFicyhEYXRlLm5vdygpIC0gdCkgLyAxZTM7XG4gICAgICAgICAgICBlID0gcGFyc2VJbnQobyAvIGNjLnB2ei5HYW1lQ29uZmlnLkNkUG93ZXJUaW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSA+IDAgJiYgIWNjLnB2ei5QbGF5ZXJEYXRhLmlzTWF4UG93ZXIoKSkge1xuICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEuYWRkUG93ZXIoZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGEgPSBjYy5wdnouUGxheWVyRGF0YS5nZXRQb3dlcigpO1xuICAgICAgICB2YXIgbiA9IGNjLnB2ei5QbGF5ZXJEYXRhLmdldE1heFBvd2VyKCk7XG4gICAgICAgIHRoaXMucG93ZXJMYWJlbC5zdHJpbmcgPSBhICsgXCIvXCIgKyBuO1xuICAgICAgICB0aGlzLmlzTWF4UG93ZXIgPSBjYy5wdnouUGxheWVyRGF0YS5pc01heFBvd2VyKCk7XG4gICAgICAgIHRoaXMucG93ZXJUaW1lTGFiZWwubm9kZS5hY3RpdmUgPSAhdGhpcy5pc01heFBvd2VyO1xuICAgICAgICBpZiAoIXRoaXMuaXNNYXhQb3dlcikge1xuICAgICAgICAgICAgaWYgKHQgPCAwKSB7XG4gICAgICAgICAgICAgICAgY2MucGxheWVyLnBvd2VyRGF0ZSA9IERhdGUubm93KCkgKyAxZTMgKiBjYy5wdnouR2FtZUNvbmZpZy5DZFBvd2VyVGltZTtcbiAgICAgICAgICAgICAgICB0ID0gY2MucGxheWVyLnBvd2VyRGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpID0gTWF0aC5hYnMoRGF0ZS5ub3coKSAtIHQpIC8gMWUzO1xuICAgICAgICAgICAgdGhpcy5sYXN0VGltZSA9IHBhcnNlSW50KGkpIC0gZSAqIGNjLnB2ei5HYW1lQ29uZmlnLkNkUG93ZXJUaW1lO1xuICAgICAgICAgICAgdGhpcy5wb3dlclRpbWVMYWJlbC5zdHJpbmcgPSBjYy5wdnoudXRpbHMuZm9ybWF0U2Vjb25kczIodGhpcy5sYXN0VGltZSk7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMub25SZWZyZXNoVGltZSwgMSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uUmVmcmVzaFRpbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sYXN0VGltZS0tO1xuICAgICAgICBpZiAoMCA9PSB0aGlzLmxhc3RUaW1lKSB7XG4gICAgICAgICAgICBpZiAoY2MucHZ6LlBsYXllckRhdGEuaXNNYXhQb3dlcigpKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2MucHZ6LlBsYXllckRhdGEuYWRkUG93ZXIoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZSA9IGNjLnB2ei5QbGF5ZXJEYXRhLmdldFBvd2VyKCk7XG4gICAgICAgICAgICB2YXIgdCA9IGNjLnB2ei5QbGF5ZXJEYXRhLmdldE1heFBvd2VyKCk7XG4gICAgICAgICAgICB0aGlzLnBvd2VyTGFiZWwuc3RyaW5nID0gZSArIFwiL1wiICsgdDtcbiAgICAgICAgICAgIHRoaXMuaXNNYXhQb3dlciA9IGNjLnB2ei5QbGF5ZXJEYXRhLmlzTWF4UG93ZXIoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTWF4UG93ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvd2VyVGltZUxhYmVsLm5vZGUuYWN0aXZlID0gITE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgdGhpcy51bnNjaGVkdWxlKHRoaXMub25SZWZyZXNoVGltZSwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxhc3RUaW1lID0gY2MucHZ6LkdhbWVDb25maWcuQ2RQb3dlclRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3dlclRpbWVMYWJlbC5zdHJpbmcgPSBjYy5wdnoudXRpbHMuZm9ybWF0U2Vjb25kczIodGhpcy5sYXN0VGltZSk7XG4gICAgfSxcbiAgICBjaGVja1Bvd2VyU2hvdzogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZSA9IGNjLnB2ei5QbGF5ZXJEYXRhLmdldFBvd2VyKCk7XG4gICAgICAgIHZhciB0ID0gY2MucHZ6LlBsYXllckRhdGEuZ2V0TWF4UG93ZXIoKTtcbiAgICAgICAgdGhpcy5wb3dlckxhYmVsLnN0cmluZyA9IGUgKyBcIi9cIiArIHQ7XG4gICAgICAgIGlmIChlID49IHQpIHtcbiAgICAgICAgICAgIHRoaXMucG93ZXJUaW1lTGFiZWwubm9kZS5hY3RpdmUgPSAhMTtcbiAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvd2VyVGltZUxhYmVsLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sYXN0VGltZSA9IGNjLnB2ei5HYW1lQ29uZmlnLkNkUG93ZXJUaW1lO1xuICAgICAgICAgICAgdGhpcy5wb3dlclRpbWVMYWJlbC5ub2RlLmFjdGl2ZSA9ICEwO1xuICAgICAgICAgICAgdGhpcy5wb3dlclRpbWVMYWJlbC5zdHJpbmcgPSBjYy5wdnoudXRpbHMuZm9ybWF0U2Vjb25kczIodGhpcy5sYXN0VGltZSk7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMub25SZWZyZXNoVGltZSwgMSk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcbiJdfQ==