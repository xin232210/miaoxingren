{"version":3,"sources":["assets/scripts/Butler.js"],"names":["cc","Class","Component","properties","loadingBar","ProgressBar","onLoad","butler","dFlag","pvz","time","director","on","Director","EVENT_BEFORE_UPDATE","beforeDirectorUpdate","sys","platform","WECHAT_GAME","polyfillSafeArea","wx","getSystemInfoSync","safeArea","console","log","getSafeAreaRect","e","view","getVisibleSize","rect","width","height","checkToHandleGameHide","handleGameHide","getDeltaTime","getScheduler","getTimeScale","cloud","uid","needSaveToCloud","PlayerData","saveDataToLocalOnline","start","game","addPersistRootNode","node","onHide","onShow","handleGameShow","TAUtils","onWxShow","BYTEDANCE_GAME","tt","EVENT_HIDE","getTotalFrames","EVENT_SHOW","onCheckGameVersion","pauseMusic","audioEngine","stopAllEffects","isRestart","saveData","resumeMusic","pauseDirector","pause","resumeDirector","resume","playMusic","music","player","isMMute","playingMusic","playEffect","t","isSMute","resumeEffect","playEffectAsync","o","a","n","exclusiveMap","utils","useBundleAsset","AudioClip","setFinishCallback","playEffectAsync2","indexOf","substring","setMusicSwitch","emit","setMusicMute","setSoundSwitch","setSoundMute","onDataChanged","onToggleMusic","isChecked","loadBundles","progress","loadedBundle","assetManager","loadBundle","i","c","name","length","tween","to"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        loadingBar: cc.ProgressBar\n    },\n    onLoad: function () {\n        cc.butler = this;\n        this.dFlag = 0;\n        cc.pvz.time = 0;\n        cc.director.on(cc.Director.EVENT_BEFORE_UPDATE, this.beforeDirectorUpdate, this);\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\n            this.polyfillSafeArea();\n        }\n    },\n    polyfillSafeArea: function () {\n        if (wx.getSystemInfoSync().safeArea) {\n            //\n        } else {\n            console.log(\"polyfill safeArea\");\n            cc.sys.getSafeAreaRect = function () {\n                var e = cc.view.getVisibleSize();\n                return cc.rect(0, 0, e.width, e.height);\n            };\n        }\n    },\n    beforeDirectorUpdate: function () {\n        if (this.checkToHandleGameHide) {\n            this.handleGameHide();\n        }\n        var e = 1e3 * cc.director.getDeltaTime();\n        cc.pvz.time += e * cc.director.getScheduler().getTimeScale();\n        if (cc.pvz.cloud && cc.pvz.cloud.uid && cc.pvz.cloud.needSaveToCloud > 0) {\n            cc.pvz.PlayerData.saveDataToLocalOnline();\n            cc.pvz.cloud.needSaveToCloud = 0;\n        }\n    },\n    start: function () {\n        var e = this;\n        cc.game.addPersistRootNode(this.node);\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\n            wx.onHide(function () {\n                console.log(\"wx.onHide\");\n                e.handleGameHide();\n            });\n            wx.onShow(function () {\n                console.log(\"wx.onShow\");\n                e.handleGameShow();\n                cc.pvz.TAUtils.onWxShow();\n            });\n        } else {\n            if (cc.sys.platform == cc.sys.BYTEDANCE_GAME) {\n                tt.onHide(function () {\n                    console.log(\"tt.onHide\");\n                    e.handleGameHide();\n                }),\n                    tt.onShow(function () {\n                        console.log(\"tt.onShow\");\n                        e.handleGameShow();\n                    });\n            } else {\n                cc.game.on(cc.game.EVENT_HIDE, function () {\n                    console.log(\"cc.game.EVENT_HIDE, frame:\", cc.director.getTotalFrames());\n                    e.handleGameHide();\n                }),\n                    cc.game.on(cc.game.EVENT_SHOW, function () {\n                        console.log(\"cc.game.EVENT_SHOW, frame:\", cc.director.getTotalFrames());\n                        e.handleGameShow();\n                    });\n            }\n        }\n        cc.pvz.TAUtils.onCheckGameVersion();\n    },\n    handleGameHide: function () {\n        console.log(\"handleGameHide\");\n        this.pauseMusic();\n        cc.audioEngine.stopAllEffects();\n        if (cc.isRestart) {\n            //\n        } else {\n            this.saveData();\n        }\n    },\n    handleGameShow: function () {\n        this.resumeMusic();\n    },\n    pauseDirector: function (e) {\n        if (0 == this.dFlag) {\n            cc.director.pause();\n        }\n        this.dFlag |= 1 << e;\n    },\n    resumeDirector: function (e) {\n        this.dFlag &= ~(1 << e);\n        if (0 == this.dFlag) {\n            cc.director.resume();\n        }\n    },\n    playMusic: function (e) {\n        this.music = e;\n        if (cc.player && cc.player.isMMute) {\n            //\n        } else {\n            this.playingMusic = e;\n            if (e) {\n                console.log(\"playmusic\");\n                cc.audioEngine.playMusic(e, !0);\n            }\n        }\n    },\n    pauseMusic: function () {\n        cc.audioEngine.pauseMusic();\n    },\n    resumeMusic: function () {\n        if (cc.player && cc.player.isMMute) {\n            console.log(\"resumeMusic return\");\n        } else {\n            if (this.music != this.playingMusic) {\n                console.log(\"resumeMusic play new\"), this.playMusic(this.music);\n            } else {\n                console.log(\"resumeMusic resume old\"), cc.audioEngine.resumeMusic();\n            }\n        }\n    },\n    playEffect: function (e, t) {\n        if (void 0 === t) {\n            t = !1;\n        }\n        return cc.player && cc.player.isSMute ? -1 : e ? cc.audioEngine.playEffect(e, t) : -1;\n    },\n    resumeEffect: function (e) {\n        if (cc.player && cc.player.isSMute) {\n            return -1;\n        }\n        cc.audioEngine.resumeEffect(e);\n    },\n    playEffectAsync: function (e, t, o) {\n        var a = this;\n        if (void 0 === o) {\n            o = !1;\n        }\n        if (!cc.player || !cc.player.isSMute) {\n            var n = null;\n            if (o) {\n                if (this.exclusiveMap) {\n                    //\n                } else {\n                    this.exclusiveMap = {};\n                }\n                n = e + t;\n                if (this.exclusiveMap[n]) {\n                    return;\n                }\n                this.exclusiveMap[n] = !0;\n            }\n            cc.pvz.utils.useBundleAsset(e, t, cc.AudioClip, function (e) {\n                if (o) {\n                    var t = a.playEffect(e, !1);\n                    if (-1 == t) {\n                        a.exclusiveMap[n] = !1;\n                    } else {\n                        cc.audioEngine.setFinishCallback(t, function () {\n                            a.exclusiveMap[n] = !1;\n                        });\n                    }\n                } else {\n                    a.playEffect(e, !1);\n                }\n            });\n        }\n    },\n    playEffectAsync2: function (e) {\n        if (!cc.player || !cc.player.isSMute) {\n            var t = e.indexOf(\",\");\n            this.playEffectAsync(e.substring(0, t), e.substring(t + 1));\n        }\n    },\n    setMusicSwitch: function (e) {\n        if (cc.player.isMMute != e) {\n            this.node.emit(\"music-switch\", e);\n        }\n        this.setMusicMute(e);\n        if (cc.player.isMMute) {\n            this.pauseMusic();\n        } else {\n            this.resumeMusic();\n        }\n    },\n    setSoundSwitch: function (e) {\n        this.setSoundMute(e);\n        if (cc.player.isSMute) {\n            cc.audioEngine.stopAllEffects();\n        }\n    },\n    saveData: function () {\n        cc.pvz.PlayerData.saveData();\n    },\n    setMusicMute: function (e) {\n        cc.player.isMMute = e;\n        cc.pvz.PlayerData.onDataChanged();\n    },\n    setSoundMute: function (e) {\n        cc.player.isSMute = e;\n        cc.pvz.PlayerData.onDataChanged();\n    },\n    onToggleMusic: function (e) {\n        console.log(\"onToggleMusic\", e.isChecked);\n        this.setMusicSwitch(!e.isChecked);\n        this.setSoundSwitch(!e.isChecked);\n    },\n    loadBundles: function (e, t, o) {\n        var a = this;\n        if (this.loadingBar) {\n            this.loadingBar.progress = 0;\n        }\n        this.loadedBundle = 0;\n        cc.assetManager.loadBundle(e[0], null, function n(i, c) {\n            if (i) {\n                console.log(\"load subpackage  fail:\", i);\n            } else {\n                console.log(\"load bundle \" + c.name + \" successfully.\");\n                a.loadedBundle++;\n                if (a.loadedBundle == e.length) {\n                    o && o();\n                } else {\n                    cc.assetManager.loadBundle(e[a.loadedBundle], null, n);\n                }\n                a.loadingBar &&\n                    cc\n                        .tween(a.loadingBar)\n                        .to(0.2, {\n                            progress: (a.loadedBundle + 1) / t\n                        })\n                        .start();\n            }\n        });\n        if (this.loadingBar) {\n            cc.tween(this.loadingBar)\n                .to(0.2, {\n                    progress: (this.loadedBundle + 1) / t\n                })\n                .start();\n        }\n    }\n});\n"]}