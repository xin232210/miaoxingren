{"version":3,"sources":["assets/mainUI/scripts/UIPowerBuy.js"],"names":["cc","Class","Component","properties","buyTimesLabel","Label","priceLabel","initBy","e","fromType","isLookAd","pvz","PlayerData","checkAndResetPowetBuy","refreshUIInfo","TAUtils","trackAdUIShow","GameConfig","AdType","string","PowerBuyTip","replace","getPowerBuyTimes","t","diamondPrice","PowerBuyPrices","onClickAdBuy","popupManager","showToast","AdUtils","showAdRewardVideo","onAdClose","updatePowerBuyTimes","refreshAddPower","onClickDiamondBuy","isItemEnough","ItemType","changeItemNum","addMissionProgress","MissionType","addPower","UIFromType","UIActLevelInfo","updateItemInfo","checkPowerInfo","MainControl","showEffectFly","getItemEffectPos","butler","playEffect","rewardSound","RedControl","onCheckBattleRed","onCheckMissionRed","onCloseUI","removePopup"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        buyTimesLabel: [cc.Label],\n        priceLabel: cc.Label\n    },\n    initBy: function (e) {\n        this.fromType = e;\n        this.isLookAd = !1;\n        cc.pvz.PlayerData.checkAndResetPowetBuy();\n        this.refreshUIInfo();\n        cc.pvz.TAUtils.trackAdUIShow(cc.pvz.GameConfig.AdType[\"体力购买\"]);\n    },\n    refreshUIInfo: function () {\n        for (var e = 0; e < 2; e++) {\n            this.buyTimesLabel[e].string = cc.pvz.GameConfig.PowerBuyTip.replace(\n                \"$\",\n                cc.pvz.PlayerData.getPowerBuyTimes(0 == e)\n            );\n        }\n        var t = 3 - cc.pvz.PlayerData.getPowerBuyTimes(!1);\n        if (t < 0) {\n            t = 0;\n        } else {\n            if (t >= 3) {\n                t = 2;\n            } else {\n                t = t;\n            }\n        }\n        this.diamondPrice = cc.pvz.GameConfig.PowerBuyPrices[t];\n        this.priceLabel.string = \"x\" + this.diamondPrice;\n    },\n    onClickAdBuy: function () {\n        var e = this;\n        if (cc.pvz.PlayerData.getPowerBuyTimes(!0) <= 0) {\n            cc.popupManager.showToast(\"今日免费次数已用完\");\n        } else {\n            if (this.isLookAd) {\n                //\n            } else {\n                this.isLookAd = !0;\n                cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType[\"体力购买\"], function (t) {\n                    e.onAdClose(t);\n                });\n            }\n        }\n    },\n    onAdClose: function (e) {\n        this.isLookAd = !1;\n        if (e) {\n            cc.pvz.PlayerData.updatePowerBuyTimes(!0, 1);\n            this.refreshUIInfo();\n            this.refreshAddPower(10);\n        }\n    },\n    onClickDiamondBuy: function () {\n        if (cc.pvz.PlayerData.getPowerBuyTimes(!1) <= 0) {\n            cc.popupManager.showToast(\"今日购买次数已用完\");\n        } else {\n            if (cc.pvz.PlayerData.isItemEnough(cc.pvz.GameConfig.ItemType[\"钻石\"], this.diamondPrice)) {\n                cc.pvz.PlayerData.changeItemNum(cc.pvz.GameConfig.ItemType[\"钻石\"], -this.diamondPrice),\n                    cc.pvz.PlayerData.updatePowerBuyTimes(!1, 1),\n                    this.refreshUIInfo(),\n                    this.refreshAddPower(15);\n            } else {\n                cc.popupManager.showToast(\"钻石不足！\");\n            }\n        }\n    },\n    refreshAddPower: function (e) {\n        cc.pvz.PlayerData.addMissionProgress(cc.pvz.GameConfig.MissionType[\"购买体力n次\"], 1);\n        cc.pvz.PlayerData.addPower(e, !0);\n        if (this.fromType == cc.pvz.GameConfig.UIFromType[\"挑战副本\"]) {\n            cc.UIActLevelInfo.updateItemInfo();\n            cc.UIActLevelInfo.checkPowerInfo();\n        }\n        cc.MainControl.updateItemInfo();\n        cc.MainControl.checkPowerInfo();\n        cc.popupManager.showEffectFly(\n            cc.pvz.GameConfig.ItemType[\"体力\"],\n            cc.MainControl.getItemEffectPos(cc.pvz.GameConfig.ItemType[\"体力\"])\n        );\n        cc.butler.playEffect(cc.MainControl.rewardSound);\n        cc.RedControl.onCheckBattleRed();\n        cc.RedControl.onCheckMissionRed();\n    },\n    onCloseUI: function () {\n        cc.popupManager.removePopup(this);\n    }\n});\n"]}