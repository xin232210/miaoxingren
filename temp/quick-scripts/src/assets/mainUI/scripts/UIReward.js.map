{"version":3,"sources":["assets/mainUI/scripts/UIReward.js"],"names":["cc","Class","Component","properties","baseItemNode","Node","parentOnePanel","parentMorePanel","closeBtn","effectSpine","sp","Skeleton","bgSpine","rewardSound","AudioClip","onLoad","UIReward","active","node","showEffectSpine","e","setAnimation","setCompleteListener","initBy","t","i","o","a","fromType","callBack","getItemEffectPosCb","onCheckRewardData","setEventListener","data","name","initUIInfo","butler","playEffect","rewardData","effectItemList","length","itemId","pvz","utils","onCheckRandomTool","GameConfig","UIFromType","push","parent","position","v2","getComponent","initRewardItem","instantiate","onCloseUI","popupManager","removePopup","math","randomRangeInt","showEffectFly","UITask","getItemEffectPos","MainControl","checkPowerInfo","updateItemInfo","RedControl","refreshAllRedTip"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        baseItemNode: cc.Node,\n        parentOnePanel: cc.Node,\n        parentMorePanel: cc.Node,\n        closeBtn: cc.Node,\n        effectSpine: sp.Skeleton,\n        bgSpine: sp.Skeleton,\n        rewardSound: cc.AudioClip\n    },\n    onLoad: function () {\n        cc.UIReward = this;\n        this.baseItemNode.active = !1;\n        this.effectSpine.node.active = !1;\n    },\n    showEffectSpine: function () {\n        var e = this;\n        this.effectSpine.node.active = !0;\n        this.effectSpine.setAnimation(0, \"caidai\", !1);\n        this.effectSpine.setCompleteListener(function () {\n            e.effectSpine.node.active = !1;\n            e.effectSpine.setCompleteListener(null);\n        });\n    },\n    initBy: function (e, t, i, o) {\n        var a = this;\n        if (void 0 === i) {\n            i = null;\n        }\n        if (void 0 === o) {\n            o = null;\n        }\n        this.fromType = t;\n        this.callBack = i;\n        this.getItemEffectPosCb = o;\n        this.closeBtn.active = !1;\n        this.onCheckRewardData(e);\n        this.bgSpine.setEventListener(function (e, t) {\n            if (\"ShowItem\" == t.data.name) {\n                a.initUIInfo();\n                a.showEffectSpine();\n            }\n        });\n        this.bgSpine.setAnimation(0, \"get1\", !1);\n        this.bgSpine.setCompleteListener(function () {\n            a.bgSpine.setAnimation(0, \"get2\", !0);\n            a.bgSpine.setCompleteListener(null);\n        });\n        cc.butler.playEffect(this.rewardSound);\n    },\n    onCheckRewardData: function (e) {\n        this.rewardData = [];\n        this.effectItemList = [];\n        for (var t = 0; t < e.length; t++) {\n            var i = e[t];\n            if (i.itemId >= 5 && i.itemId <= 7) {\n                cc.pvz.utils.onCheckRandomTool(\n                    i,\n                    this.rewardData,\n                    this.fromType != cc.pvz.GameConfig.UIFromType[\"签到\"]\n                );\n            } else {\n                this.rewardData.push(i);\n                i.itemId >= 2 && i.itemId <= 4 && this.effectItemList.push(i.itemId);\n            }\n        }\n    },\n    initUIInfo: function () {\n        this.closeBtn.active = !0;\n        var e = this.rewardData.length;\n        var t;\n        if (e <= 5) {\n            t = this.parentOnePanel;\n        } else {\n            t = this.parentMorePanel;\n        }\n        this.baseItemNode.active = !0;\n        this.baseItemNode.parent = t;\n        this.baseItemNode.position = cc.v2(0, 0);\n        var i = this.fromType != cc.pvz.GameConfig.UIFromType[\"双倍结算\"];\n        this.baseItemNode.getComponent(\"RewardItem\").initRewardItem(this.rewardData[0], i);\n        for (var o = 1; o < e; o++) {\n            var a = cc.instantiate(this.baseItemNode);\n            a.parent = t;\n            a.getComponent(\"RewardItem\").initRewardItem(this.rewardData[o], i);\n        }\n    },\n    onCloseUI: function () {\n        cc.popupManager.removePopup(this);\n        if (this.fromType != cc.pvz.GameConfig.UIFromType[\"双倍结算\"]) {\n            if (this.effectItemList.length > 0) {\n                var e = -1;\n                for (var t = 0; t < this.effectItemList.length; t++) {\n                    var i = this.effectItemList[t];\n                    for (var o = cc.math.randomRangeInt(1, 4); -1 != e && e == o; ) {\n                        o = cc.math.randomRangeInt(1, 4);\n                    }\n                    e = o;\n                    if (\n                        this.fromType == cc.pvz.GameConfig.UIFromType[\"日常任务\"] ||\n                        this.fromType == cc.pvz.GameConfig.UIFromType[\"周常任务\"] ||\n                        this.fromType == cc.pvz.GameConfig.UIFromType[\"成就\"]\n                    ) {\n                        cc.popupManager.showEffectFly(i, cc.UITask.getItemEffectPos(i), o);\n                    } else {\n                        if (this.fromType == cc.pvz.GameConfig.UIFromType[\"基金\"]) {\n                            cc.popupManager.showEffectFly(i, this.getItemEffectPosCb(i), o);\n                        } else {\n                            cc.popupManager.showEffectFly(i, cc.MainControl.getItemEffectPos(i), o);\n                        }\n                    }\n                }\n            }\n            if (this.fromType === cc.pvz.GameConfig.UIFromType[\"关卡宝箱\"]) {\n                cc.MainControl.checkPowerInfo();\n            }\n            if (this.callBack) {\n                this.callBack();\n            }\n            cc.MainControl.updateItemInfo();\n            cc.RedControl.refreshAllRedTip();\n        } else {\n            if (this.callBack) {\n                this.callBack();\n            }\n        }\n    }\n});\n"]}