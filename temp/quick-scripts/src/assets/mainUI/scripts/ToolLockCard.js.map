{"version":3,"sources":["assets/mainUI/scripts/ToolLockCard.js"],"names":["cc","Class","Component","properties","spine","sp","Skeleton","typeSprite","Sprite","lockTip","Label","initToolLockCard","e","t","i","ui","toolId","o","JsonControl","getToolJson","node","scale","pvz","utils","useBundleAsset","SkeletonData","console","log","skeletonData","skinName","findSkin","setSkin","setAnimation","warn","error","getToolTypeIcon","lattice","string","GameConfig","ToolLockTip","replace","ToolLockLevel","onClickCard","popupManager","popup","ad"],"mappings":";;;;;;AAAAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAELC,UAAU,EAAE;IACRC,KAAK,EAAEC,EAAE,CAACC,QADF;IAERC,UAAU,EAAEP,EAAE,CAACQ,MAFP;IAGRC,OAAO,EAAET,EAAE,CAACU;EAHJ,CAFP;EAOLC,gBAAgB,EAAE,0BAAUC,CAAV,EAAaC,CAAb,EAAgB;IAC9B,IAAIC,CAAC,GAAG,IAAR;IACA,KAAKC,EAAL,GAAUH,CAAV;IACA,KAAKI,MAAL,GAAcH,CAAd;IACA,IAAII,CAAC,GAAGjB,EAAE,CAACkB,WAAH,CAAeC,WAAf,CAA2B,KAAKH,MAAhC,CAAR;IACA,KAAKZ,KAAL,CAAWgB,IAAX,CAAgBC,KAAhB,GAAwBJ,CAAC,CAACI,KAA1B,CAL8B,CAO9B;;IACArB,EAAE,CAACsB,GAAH,CAAOC,KAAP,CAAaC,cAAb,CAA4B,QAA5B,EAAsC,sBAAtC,EAA8DnB,EAAE,CAACoB,YAAjE,EAA+E,UAAUb,CAAV,EAAa;MACxF,IAAIA,CAAJ,EAAO;QACHc,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBf,CAAzB;QACAE,CAAC,CAACV,KAAF,CAAQwB,YAAR,GAAuBhB,CAAvB,CAFG,CAGH;;QACA,IAAIiB,QAAQ,GAAG,eAAef,CAAC,CAACE,MAAF,GAAW,EAAX,GAAgB,MAAMF,CAAC,CAACE,MAAxB,GAAiCF,CAAC,CAACE,MAAlD,CAAf;;QACA,IAAIF,CAAC,CAACV,KAAF,CAAQ0B,QAAR,CAAiBD,QAAjB,CAAJ,EAAgC;UAC5BH,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBE,QAArB;UACAf,CAAC,CAACV,KAAF,CAAQ2B,OAAR,CAAgBF,QAAhB;UACAf,CAAC,CAACV,KAAF,CAAQ4B,YAAR,CAAqB,CAArB,EAAwB,QAAxB,EAAkC,CAAC,CAAnC;QACH,CAJD,MAIO;UACHN,OAAO,CAACO,IAAR,CAAa,QAAb,EAAuBJ,QAAvB,EADG,CAEH;;UACAf,CAAC,CAACV,KAAF,CAAQ4B,YAAR,CAAqB,CAArB,EAAwB,QAAxB,EAAkC,CAAC,CAAnC;QACH;MACJ,CAdD,MAcO;QACHN,OAAO,CAACQ,KAAR,CAAc,UAAd;MACH;IACJ,CAlBD;IAoBAlC,EAAE,CAACkB,WAAH,CAAeiB,eAAf,CAA+B,KAAK5B,UAApC,EAAgDU,CAAC,CAACmB,OAAlD;IACA,KAAK3B,OAAL,CAAa4B,MAAb,GAAsBrC,EAAE,CAACsB,GAAH,CAAOgB,UAAP,CAAkBC,WAAlB,CAA8BC,OAA9B,CAClB,GADkB,EAElBxC,EAAE,CAACsB,GAAH,CAAOgB,UAAP,CAAkBG,aAAlB,CAAgC,KAAKzB,MAAL,GAAc,CAA9C,CAFkB,CAAtB;EAIH,CAxCI;EAyCL0B,WAAW,EAAE,uBAAY;IACrB1C,EAAE,CAAC2C,YAAH,CAAgBC,KAAhB,CACI,QADJ,EAEI,WAFJ,EAGI,YAHJ,EAII;MACIC,EAAE,EAAE,CAAC,CADT;MAEIxB,KAAK,EAAE,CAAC;IAFZ,CAJJ,EAQI,KAAKN,EART,EASI,KAAKC,MATT,EAUI,CAAC,CAVL;EAYH;AAtDI,CAAT","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        spine: sp.Skeleton,\n        typeSprite: cc.Sprite,\n        lockTip: cc.Label\n    },\n    initToolLockCard: function (e, t) {\n        var i = this;\n        this.ui = e;\n        this.toolId = t;\n        var o = cc.JsonControl.getToolJson(this.toolId);\n        this.spine.node.scale = o.scale;\n        \n        // 修改为使用character目录下的资源，并添加错误处理\n        cc.pvz.utils.useBundleAsset(\"actors\", \"character/Characters\", sp.SkeletonData, function (e) {\n            if (e) {\n                console.log(\"角色资源加载成功:\", e);\n                i.spine.skeletonData = e;\n                // 根据toolId设置对应的皮肤，确保皮肤名称正确\n                var skinName = \"Character\" + (i.toolId < 10 ? \"0\" + i.toolId : i.toolId);\n                if (i.spine.findSkin(skinName)) {\n                    console.log(\"找到皮肤:\", skinName);\n                    i.spine.setSkin(skinName);\n                    i.spine.setAnimation(0, \"stand1\", !0);\n                } else {\n                    console.warn(\"皮肤不存在:\", skinName);\n                    // 如果皮肤不存在，尝试使用默认皮肤\n                    i.spine.setAnimation(0, \"stand1\", !0);\n                }\n            } else {\n                console.error(\"无法加载角色资源\");\n            }\n        });\n        \n        cc.JsonControl.getToolTypeIcon(this.typeSprite, o.lattice);\n        this.lockTip.string = cc.pvz.GameConfig.ToolLockTip.replace(\n            \"$\",\n            cc.pvz.GameConfig.ToolLockLevel[this.toolId - 1]\n        );\n    },\n    onClickCard: function () {\n        cc.popupManager.popup(\n            \"mainUI\",\n            \"plantInfo\",\n            \"UIToolInfo\",\n            {\n                ad: !1,\n                scale: !0\n            },\n            this.ui,\n            this.toolId,\n            !0\n        );\n    }\n});"]}