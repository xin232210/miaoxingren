{"version":3,"sources":["assets/game/scripts/Hero.js"],"names":["$bullet","require","cc","Class","Component","properties","spine","sp","Skeleton","zd","zd2","landMineNode","Node","onLoad","node","active","enabled","start","initBy","t","e","i","n","scene","info","item","itemSpineInitialPos","position","clone","o","json","range","atkRR","lvs","hp","maxHp","shieldValue","hasDie","setAnimation","isPhy","isMagic","is3gz","some","id","is2gz","butler","on","onLvup","initialPosition","moveSpeed","currentTarget","isMoving","hasReachedAttackRange","isInitialized","console","log","index","lvup","hub","showLvupEffect","convertToWorldSpaceAR","Vec2","ZERO","animationName","lv","findAnimation","warn","error","setCompleteListener","getAtk","Math","min","lv1","attribute2","length","fightlvup2","pvz","runtimeData","getBuffValue","items","getShield","pushLvAndAtk","push","atk","playAttAndDo","attackAnimation","checkToStartReloadTimer","setEventListener","playSound","playEffectAsync","tryShoot","needTargetCheck","indexOf","nearTarget","chooseEnemy","targetPos","add","v2","centerY","distance","sub","lengthSqr","floor","checkBuff","random","addMoney","showBuffEffect","getMoneyWPos","hasEnableBuff","crossItems","forEach","hero","addShield","chooseMinHpHero","addHp","getAngerBarWPos","anger","updateAnger","lastBulletCount","instantiate","getHeroesMaxMarginX","math","randomRange","groundAreaLB","y","groundAreaTR","parent","objsRoot","zIndex","getComponent","Collider","s","findBone","x","scale","max","chooseEnemys","c","a","r","h","bulletsRoot","defaultAnimation","d","u","convertToNodeSpaceAR","att","p","setTimeout","showJsEffect","l","isAttacking","isValid","checkToShoot","bulletCount","tween","IKBone","to","shift","shoot","bind","getShootAPos","GPBone","worldX","worldY","shootN","shootIK","shoot1","atan2","hitCount","mode","moveByAngle","PI","collider","radius","setTrackEventListener","checkHeroBuff","doBulletAttLogic","weakNode","actBuff1","checkCrit","getCritPlus","hurtBy","showEnemyHurtNum","jsEffExclusive","stats","buffSlow","addBuffSlow","buffIce","addBuffIce","addBuffWeak","repulse","attCounter","doLandMinesLogic","onLandminesCollision","find","utils","manuallyCheckCollider","destroy","updateHp","delHp","updateShield","hasEnded","hasUseReborn","hasHero","barNode","reborn","checkIsFail","addBuffPrefab","addNodeTo","update","loggedNotInit","timePaused","director","getScheduler","getTimeScale","lastLogTime","currentTime","Date","now","enemys","updateMovement","returnToInitialPosition","cos","sin","oldPos","updateItemSpinePosition","lastMoveLogTime","nowTime","position2","attOffset","heroWorldPos","spineLocalPos","loggedSpineUpdate","loggedSpineError","distSqr"],"mappings":"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","sourceRoot":"/","sourcesContent":["var $bullet = require(\"./Bullet\");\ncc.Class({\n  extends: cc.Component,\n  properties: {\n    spine: sp.Skeleton,\n    zd: $bullet,\n    zd2: $bullet,\n    landMineNode: cc.Node,\n  },\n  onLoad: function () {\n    if (this.zd) {\n      this.zd.node.active = !1;\n    }\n    if (this.zd2) {\n      this.zd2.node.active = !1;\n    }\n    if (this.landMineNode) {\n      this.landMineNode.active = !1;\n    }\n    // 启用update方法以支持移动逻辑\n    this.enabled = true;\n  },\n  start: function () {},\n  initBy: function (t, e, i) {\n    var n = this;\n    this.scene = t;\n    this.info = i;\n    this.item = e;\n\n    this.spine = this.item.spine;\n\n    // 保存item.spine节点的初始位置（相对于其父节点）\n    this.itemSpineInitialPos = this.item.spine.node.position.clone();\n\n    var o = this.info.json.range;\n    this.atkRR = o * o;\n    this.lvs = [];\n    this.hp = this.item.maxHp;\n    this.shieldValue = 0;\n    this.hasDie = !1;\n    this.setAnimation(0, \"stand\", !0, null);\n    this.isPhy = !0;\n    this.isMagic = !0;\n    this.is3gz = [2, 5, 9, 10].some(function (t) {\n      return t == n.item.id;\n    });\n    this.is2gz = [2, 4, 8].some(function (t) {\n      return t == n.item.id;\n    });\n    cc.butler.node.on(\"lvup\", this.onLvup, this);\n\n    // 移动相关的初始化\n    this.initialPosition = this.node.position.clone();\n    this.moveSpeed = 20; // 英雄移动速度\n    this.currentTarget = null;\n    this.isMoving = false;\n    this.hasReachedAttackRange = false;\n    this.isInitialized = true;\n\n    // 关键：确保Hero组件在初始化后启用，以便update方法能被调用\n    this.enabled = true;\n\n    // 调试日志，确认初始化完成\n    console.log(\n      \"[Hero] initBy完成，ID:\" +\n        this.info.id +\n        \", enabled:\" +\n        this.enabled +\n        \", 初始位置:\",\n      this.initialPosition\n    );\n  },\n  onLvup: function (t) {\n    if (this.item.index == t) {\n      this.item.lvup(!1);\n      this.scene.hub.showLvupEffect(\n        this.node.convertToWorldSpaceAR(cc.Vec2.ZERO)\n      );\n    }\n  },\n  setAnimation: function (t, e, i, n) {\n    var animationName = e + (this.item.lv + 1);\n\n    // 检查动画是否存在\n    if (!this.spine.findAnimation(animationName)) {\n      console.warn(\n        \"[Hero] 动画 \" +\n          animationName +\n          \" 不存在，尝试使用默认动画 stand\" +\n          (this.item.lv + 1)\n      );\n      animationName = \"stand\" + (this.item.lv + 1);\n\n      // 再次检查默认动画是否存在\n      if (!this.spine.findAnimation(animationName)) {\n        console.error(\n          \"[Hero] 默认动画 \" + animationName + \" 也不存在，请检查资源路径和命名\"\n        );\n        return;\n      }\n    }\n\n    this.spine.setAnimation(t, animationName, i);\n    this.spine.setCompleteListener(n);\n  },\n  getAtk: function (t) {\n    var e = Math.min(this.info.lv1, this.info.json.attribute2.length - 1);\n    var i = this.info.json.attribute2[e];\n    if (t > 0) {\n      i *= this.info.json.fightlvup2[t - 1] / 100;\n    }\n    var n = cc.pvz.runtimeData.getBuffValue(2);\n    var o = cc.pvz.runtimeData.getBuffValue(10);\n    if (o > 0) {\n      n += o * cc.pvz.runtimeData.items.length;\n    }\n    if (n > 0) {\n      i *= 1 + 0.01 * n;\n    }\n    return i;\n  },\n  getShield: function (t) {\n    var e = Math.min(this.info.lv1, this.info.json.attribute2.length - 1);\n    var i = this.info.json.attribute2[e];\n    if (t > 0) {\n      i *= this.info.json.fightlvup2[t - 1] / 100;\n    }\n    return i;\n  },\n  pushLvAndAtk: function (t) {\n    var e = this.getAtk(t.lv);\n    this.lvs.push({\n      lv: t.lv,\n      atk: e,\n    });\n  },\n  playAttAndDo: function (t, e) {\n    var i = this;\n    // 修改为适配character目录资源的动画名称\n    var attackAnimation = \"attack\" + (this.item.lv + 1);\n    // 检查攻击动画是否存在，如果不存在则使用默认的attack动画\n    if (!this.spine.findAnimation(attackAnimation)) {\n      attackAnimation = \"attack1\";\n    }\n\n    this.setAnimation(0, \"attack\", !1, function () {\n      i.item.checkToStartReloadTimer();\n      i.setAnimation(0, \"stand\", !0, null);\n      if (e) {\n        e();\n      }\n    });\n    this.spine.setEventListener(function () {\n      if (t) {\n        t();\n      }\n    });\n  },\n  playSound: function () {\n    switch (this.info.id) {\n      case 3:\n      case 12:\n        break;\n      case 6:\n        cc.butler.playEffectAsync(\"game\", \"sound/dun\");\n        break;\n      case 8:\n        cc.butler.playEffectAsync(\"game\", \"sound/hp\");\n        break;\n      case 9:\n        cc.butler.playEffectAsync(\"game\", \"sound/jiguang\");\n        break;\n      case 10:\n        cc.butler.playEffectAsync(\"game\", \"sound/getSunShine\");\n        break;\n      default:\n        cc.butler.playEffectAsync(\"game\", \"sound/shoot\");\n    }\n  },\n  tryShoot: function (t, e) {\n    var i = this;\n\n    // 对于需要敌人目标的攻击型英雄（ID 1,2,4,5,7,9,12），检查是否在攻击范围内\n    var needTargetCheck = [1, 2, 4, 5, 7, 9, 12];\n    if (needTargetCheck.indexOf(this.info.id) !== -1) {\n      // 检查是否在攻击范围内\n      // 注意：不在这里查找目标，因为updateMovement已经在用大范围查找了\n      // 这里只检查当前是否有目标且在攻击范围内\n      if (!this.currentTarget || this.currentTarget.hp <= 0) {\n        // 如果没有当前目标，用实际攻击范围尝试查找\n        var nearTarget = this.scene.chooseEnemy(this, this.atkRR);\n        if (!nearTarget) {\n          // 没有在攻击范围内的敌人，返回false让英雄继续移动\n          return false;\n        }\n        this.currentTarget = nearTarget;\n      }\n\n      // 检查当前目标是否在攻击范围内\n      var targetPos = this.currentTarget.node.position.add(\n        cc.v2(0, this.currentTarget.centerY)\n      );\n      var distance = targetPos.sub(this.node.position).lengthSqr();\n      if (distance > this.atkRR) {\n        // 目标不在攻击范围内，返回false让英雄继续移动\n        return false;\n      }\n    }\n\n    switch (this.info.id) {\n      case 3:\n        this.playAttAndDo(function () {\n          var t = Math.floor(i.getAtk(i.item.lv));\n          if (i.checkBuff(302)) {\n            t += 1;\n          }\n          if (i.checkBuff(304) && Math.random() < 0.25) {\n            t *= 2;\n          }\n          cc.pvz.runtimeData.addMoney(t);\n          i.scene.showBuffEffect(\n            \"money\",\n            i.node.position,\n            i.scene.getMoneyWPos()\n          );\n        });\n        return !0;\n      case 6:\n        this.playAttAndDo(function () {\n          var t = i.getAtk(i.item.lv) / 100;\n          var e = 0;\n          if (cc.pvz.runtimeData.hasEnableBuff(601)) {\n            e = 0.15;\n          }\n          if (cc.pvz.runtimeData.hasEnableBuff(602)) {\n            e += 0.3;\n          }\n          if (e > 0) {\n            t *= 1 + e;\n          }\n          i.item.crossItems.forEach(function (e) {\n            if (e.hero && e.hero.hp > 0) {\n              e.hero.addShield(e.maxHp * t);\n              i.scene.showBuffEffect(\"shield\", e.hero.node.position);\n            }\n          });\n        });\n        return !0;\n      case 8:\n        var n = this.scene.chooseMinHpHero();\n        return (\n          !!n &&\n          (this.playAttAndDo(function () {\n            var t = i.getAtk(i.item.lv);\n            if (i.checkBuff(802)) {\n              t *= 1.2;\n            }\n            n.addHp(t);\n            i.scene.showBuffEffect(\"HP\", n.node.position);\n          }),\n          !0)\n        );\n      case 10:\n        this.playAttAndDo(function () {\n          var t = i.getAtk(i.item.lv);\n          var e = 0;\n          if (cc.pvz.runtimeData.hasEnableBuff(1001)) {\n            e = 0.1;\n          }\n          if (cc.pvz.runtimeData.hasEnableBuff(1002)) {\n            e += 0.2;\n          }\n          if (e > 0) {\n            t *= 1 + e;\n          }\n          i.scene.showBuffEffect(\n            \"music\",\n            i.node.position.add(cc.v2(0, 50)),\n            i.scene.getAngerBarWPos(),\n            function () {\n              cc.pvz.runtimeData.anger += t;\n              i.scene.updateAnger();\n            }\n          );\n        });\n        return !0;\n      case 11:\n        this.playAttAndDo(function () {\n          var t = 1;\n          if (cc.pvz.runtimeData.hasEnableBuff(1104)) {\n            if (i.lastBulletCount) {\n              if (1 == i.lastBulletCount) {\n                t = 2;\n              } else {\n                t = 1;\n              }\n            }\n            i.lastBulletCount = t;\n          }\n          var e = function () {\n            var t = cc.instantiate(i.landMineNode);\n            var e = cc.v2(\n              i.scene.getHeroesMaxMarginX() + cc.math.randomRange(0, 150),\n              cc.math.randomRange(\n                i.scene.groundAreaLB.y + 120,\n                i.scene.groundAreaTR.y - 120\n              )\n            );\n            t.position = i.node.position;\n            t.active = !0;\n            t.parent = i.scene.objsRoot;\n            t.zIndex = -t.y;\n            var n = t.getComponent(cc.Collider);\n            n.enabled = !1;\n            var o = t.getComponent(sp.Skeleton);\n            var s = o.findBone(\"IK\");\n            s.x = (e.x - t.x) / t.scale;\n            s.y = (e.y - t.y) / t.scale;\n            s.x = Math.max(0, s.x);\n            o.setAnimation(0, \"zd11_1\", !0);\n            o.setCompleteListener(function () {\n              t.position = e;\n              n.enabled = !0;\n              o.setAnimation(0, \"zd11_2\", !1);\n              o.setCompleteListener(null);\n            });\n          };\n          for (var n = 0; n < t; n++) {\n            e();\n          }\n        });\n        return !0;\n      case 12:\n        var o = this.checkBuff(1204) ? 2 : 1,\n          s = this.scene.chooseEnemys(this, this.atkRR, o);\n        if (0 == s.length) {\n          return !1;\n        }\n        var c = this.scene.getHeroesMaxMarginX(),\n          a = 0;\n        this.playAttAndDo(function () {\n          if (1 != a || i.checkBuff(1204)) {\n            var t = s[Math.min(s.length - 1, a)];\n            var e = t.node.position.add(cc.v2(0, t.centerY));\n            var n = cc.v2(Math.min(c, e.x), e.y);\n            var o = i.scene.objsRoot.convertToWorldSpaceAR(n);\n            var r = cc.instantiate(i.zd.node);\n            var h = r.getComponent(\"Bullet\");\n            r.parent = i.scene.bulletsRoot;\n            r.active = !0;\n            r.position = i.node.position;\n            h.spine.setAnimation(0, h.spine.defaultAnimation, !0);\n            var d = h.spine.findBone(\"IK\");\n            var u = h.spine.node.convertToNodeSpaceAR(o);\n            d.x = u.x;\n            d.y = u.y;\n            h.initBy(i.scene, i.item.lv);\n            h.a = i;\n            h.att = i.getAtk(i.item.lv);\n            var p = function (t) {\n              i.scene.setTimeout(function () {\n                i.scene.showJsEffect(cc.v2(n.x + 100 * t, n.y), i.info.id);\n              }, 48 * t);\n            };\n            for (var l = 1; l < 5; l++) {\n              p(l);\n            }\n            cc.butler.playEffectAsync(\"game\", \"sound/gunzi\");\n            a++;\n          }\n        });\n        return !0;\n    }\n    var r = e || this.scene.chooseEnemy(this, this.atkRR);\n    return (\n      !!r &&\n      (this.pushLvAndAtk(t),\n      !this.isAttacking &&\n        ((this.isAttacking = !0),\n        this.playAttAndDo(\n          function () {\n            if (r.isValid) {\n              i.isAttacking = !1;\n              i.checkToShoot(r);\n            }\n          },\n          function () {\n            if (i.item.bulletCount <= 0) {\n              cc.tween(i.IKBone)\n                .to(0.064, {\n                  x: 150,\n                  y: 50,\n                })\n                .start();\n            }\n          }\n        ),\n        this.IKBone || (this.IKBone = this.spine.findBone(\"IK\")),\n        cc\n          .tween(this.IKBone)\n          .to(0.064, {\n            x: (r.node.x - this.node.x) / 0.76,\n            y: (r.node.y + r.centerY - this.node.y) / 0.76,\n          })\n          .start(),\n        !0))\n    );\n  },\n  checkToShoot: function (t) {\n    if (0 != this.lvs.length) {\n      if (this.zd) {\n        var e = this.lvs.shift();\n        var i = t || this.scene.chooseEnemy(this, this.atkRR);\n        if (i) {\n          this.shoot(i, this.item.lv, e.atk);\n        }\n      }\n      if (this.lvs.length > 0) {\n        this.scene.setTimeout(this.checkToShoot.bind(this), 80);\n      }\n    }\n  },\n  getShootAPos: function () {\n    if (this.GPBone) {\n      //\n    } else {\n      this.GPBone = this.spine.findBone(\"GP\");\n    }\n    var t = cc.v2(this.GPBone.worldX, this.GPBone.worldY);\n    return this.spine.node.convertToWorldSpaceAR(t);\n  },\n  shoot: function (t, e, i) {\n    if (4 == this.info.id) {\n      var n;\n      if (this.checkBuff(401)) {\n        n = 9;\n      } else {\n        n = 5;\n      }\n      return this.shootN(n, t, e, i);\n    }\n    if (this.checkBuff(904)) {\n      return this.shootN(3, t, e, i);\n    } else {\n      if (7 == this.info.id) {\n        return this.shootIK(t, e, i);\n      } else {\n        return void this.shoot1(t, e, i);\n      }\n    }\n  },\n  shoot1: function (t, e, i) {\n    var n = this.getShootAPos();\n    var o = this.scene.bulletsRoot.convertToNodeSpaceAR(n);\n    var s = t.node.position.add(cc.v2(0, t.centerY)).sub(o);\n    if (s.x < 0) {\n      s.x = 0;\n    }\n    var c = Math.atan2(s.y, s.x);\n    var a = this.zd;\n    var r = cc.instantiate(a.node);\n    r.parent = this.scene.bulletsRoot;\n    r.active = !0;\n    r.position = o;\n    var h = r.getComponent(\"Bullet\");\n    if (this.checkBuff(104)) {\n      h.hitCount = 2;\n    }\n    if (this.checkBuff(503)) {\n      h.hitCount = 2;\n    }\n    h.initBy(this.scene, e);\n    h.a = this;\n    if (13 == this.info.id && 2 == cc.pvz.runtimeData.mode) {\n      h.att = i / 2;\n    } else {\n      h.att = i;\n    }\n    h.moveByAngle((180 * c) / Math.PI);\n  },\n  shootN: function (t, e, i, n) {\n    var o = this.getShootAPos();\n    var s = this.scene.bulletsRoot.convertToNodeSpaceAR(o);\n    var c = e.node.position.add(cc.v2(0, e.centerY)).sub(s);\n    if (c.x < 0) {\n      c.x = 0;\n    }\n    var a = (180 * Math.atan2(c.y, c.x)) / Math.PI;\n    var r;\n    if (t > 5) {\n      r = [0, -10, -20, -30, 40, 10, 20, 30, 40];\n    } else {\n      r = [0, -15, 15, -30, 30];\n    }\n    for (var h = 0; h < t; h++) {\n      var d = cc.instantiate(this.zd.node);\n      d.parent = this.scene.bulletsRoot;\n      d.active = !0;\n      d.position = s;\n      var u = d.getComponent(\"Bullet\");\n      u.initBy(this.scene, i);\n      u.a = this;\n      u.att = n;\n      u.moveByAngle(a + r[h]);\n    }\n  },\n  shootIK: function (t, e, i) {\n    var n = this;\n    var o = this.getShootAPos();\n    var s = this.scene.bulletsRoot.convertToNodeSpaceAR(o);\n    var c = t.node.convertToWorldSpaceAR(cc.v2(0, t.centerY));\n    var a = cc.instantiate(this.zd.node);\n    var r = a.getComponent(\"Bullet\");\n    a.parent = this.scene.bulletsRoot;\n    a.active = !0;\n    a.position = s;\n    if (this.checkBuff(702)) {\n      a.getComponent(\"EventCollider\").collider.radius *= 1.3;\n    }\n    var h = r.spine.setAnimation(0, r.spine.defaultAnimation, !0);\n    r.spine.setTrackEventListener(h, function () {\n      n.scene.showJsEffect(t.node.position, n.info.id);\n    });\n    var d = r.spine.findBone(\"IK\");\n    var u = r.spine.node.convertToNodeSpaceAR(c);\n    d.x = u.x;\n    d.y = u.y;\n    d.x = Math.max(0, d.x);\n    r.initBy(this.scene, e);\n    r.a = this;\n    r.att = i;\n  },\n  checkHeroBuff: function () {\n    return !1;\n  },\n  checkBuff: function (t) {\n    var e = (t - (t % 100)) / 100;\n    return this.info.id == e && cc.pvz.runtimeData.hasEnableBuff(t);\n  },\n  doBulletAttLogic: function (t, e) {\n    var i = t.att;\n    if (this.checkBuff(101)) {\n      i *= 1.25;\n    }\n    if (this.checkBuff(201)) {\n      i *= 1.25;\n    }\n    if (this.checkBuff(504)) {\n      i *= 1.5;\n    }\n    if (this.checkBuff(701)) {\n      i *= 1.25;\n    }\n    if (this.checkBuff(901)) {\n      i *= 1.25;\n    }\n    if (this.checkBuff(1101)) {\n      i *= 1.25;\n    }\n    if (this.checkBuff(1201)) {\n      i *= 1.25;\n    }\n    if (e.weakNode && this.isPhy) {\n      i *= 1.2;\n    }\n    switch (cc.pvz.runtimeData.actBuff1) {\n      case 1:\n      case 2:\n      case 3:\n        if (this.isPhy) {\n          i *= [1.3, 1.4, 1.5][cc.pvz.runtimeData.actBuff1 - 1];\n        }\n        break;\n      case 4:\n      case 5:\n      case 6:\n        if (this.is3gz) {\n          i *= [1.3, 1.4, 1.5][cc.pvz.runtimeData.actBuff1 - 4];\n        }\n        break;\n      case 10:\n      case 11:\n      case 12:\n        if (this.is2gz) {\n          i *= [1.3, 1.4, 1.5][cc.pvz.runtimeData.actBuff1 - 10];\n        }\n    }\n    var n = 0;\n    if (this.checkCrit(t, e)) {\n      n = 1;\n      i *= this.getCritPlus(t, e);\n    }\n    i *= cc.math.randomRange(0.95, 1.05);\n    e.hurtBy(this, i);\n    this.scene.showEnemyHurtNum(n, e.node.position, i);\n    if (t.jsEffExclusive) {\n      //\n    } else {\n      this.scene.showJsEffect(e.node.position, this.info.id);\n    }\n    cc.pvz.runtimeData.stats[this.info.id] += i;\n    if (t.buffSlow) {\n      e.addBuffSlow();\n    }\n    if (t.buffIce && this.checkBuff(1203) && Math.random() < 0.2) {\n      e.addBuffIce();\n    }\n    if (this.checkBuff(704) && Math.random() < 0.5) {\n      e.addBuffWeak();\n    }\n    if (this.checkBuff(204)) {\n      e.repulse(this.node.position);\n    }\n    if (this.checkBuff(403)) {\n      e.repulse(this.node.position);\n    }\n    if (this.checkBuff(1102)) {\n      e.repulse(this.node.position);\n    }\n  },\n  checkCrit: function () {\n    if (this.checkBuff(501)) {\n      if (this.attCounter) {\n        this.attCounter = this.attCounter + 1;\n      } else {\n        this.attCounter = 1;\n      }\n      var t;\n      if (this.checkBuff(502)) {\n        t = 2;\n      } else {\n        t = 3;\n      }\n      if (this.attCounter >= t) {\n        this.attCounter = 0;\n        return !0;\n      }\n    }\n    var e = 0;\n    if (this.checkBuff(102)) {\n      e += 0.25;\n    }\n    if (this.checkBuff(404)) {\n      e += 0.25;\n    }\n    if (this.checkBuff(903)) {\n      e += 0.1;\n    }\n    return Math.random() < e;\n  },\n  getCritPlus: function () {\n    var t = 1.5;\n    if (this.checkBuff(103)) {\n      t += 0.5;\n    }\n    return t;\n  },\n  doLandMinesLogic: function (t) {\n    var e = t.getComponent(\"Enemy\");\n    if (e && e.hp > 0) {\n      this.doBulletAttLogic(\n        {\n          att: this.getAtk(this.item.lv),\n          lv: this.item.lv,\n          jsEffExclusive: !0,\n        },\n        e\n      );\n    }\n  },\n  onLandminesCollision: function (t, e) {\n    if (e.enabled) {\n      var i = t.getComponent(\"Enemy\");\n      if (i && i.hp > 0) {\n        e.enabled = !1;\n        var n = e.node.getComponent(sp.Skeleton);\n        var o = cc.find(\"range\", e.node).getComponent(cc.Collider);\n        cc.pvz.utils.manuallyCheckCollider(o);\n        this.scene.showJsEffect(e.node.position, this.info.id);\n        n.node.destroy();\n      }\n    }\n  },\n  addHp: function (t) {\n    this.hp = Math.min(this.item.maxHp, this.hp + t);\n    this.item.updateHp(this.hp / this.item.maxHp);\n    this.scene.updateHp(!0);\n  },\n  delHp: function (t) {\n    this.hp = Math.max(0, this.hp - t);\n    this.item.updateHp(this.hp / this.item.maxHp);\n    this.scene.updateHp(!0);\n  },\n  addShield: function (t) {\n    this.shieldValue = Math.min(this.item.maxHp, this.shieldValue + t);\n    this.item.updateShield(this.shieldValue / this.item.maxHp);\n    this.scene.updateShield();\n  },\n  hurtBy: function (t, e, i) {\n    // 受伤\n    var n = this;\n    if (!(this.hasEnded || this.hp <= 0)) {\n      if (this.shieldValue > 0) {\n        var o = Math.min(this.shieldValue, i);\n        i -= o;\n        this.shieldValue -= o;\n        this.item.updateShield(this.shieldValue / this.item.maxHp);\n      }\n      if (i > 0 && (this.delHp(i), this.hp <= 0)) {\n        var s =\n          !cc.pvz.runtimeData.hasUseReborn &&\n          (8 == this.info.id || this.scene.hasHero(8)) &&\n          cc.pvz.runtimeData.hasEnableBuff(803);\n        if (s) {\n          cc.pvz.runtimeData.hasUseReborn = !0;\n        } else {\n          // 血条\n          this.item.barNode.active = !1;\n        }\n        this.setAnimation(0, \"die\", !1, function () {\n          if (s) {\n            n.reborn(cc.pvz.runtimeData.hasEnableBuff(804) ? 1 : 0.3);\n            n.showBuffEffect(\"revive\", !1);\n          } else {\n            n.hasDie = !0;\n            n.scene.checkIsFail();\n            n.spine.setCompleteListener(null);\n          }\n        });\n      }\n    }\n  },\n  reborn: function (t) {\n    // 复活\n    var e = this;\n    this.setAnimation(0, \"fuhuo\", !1, function () {\n      e.hp = e.item.maxHp * t;\n      e.item.updateHp();\n      e.hasDie = !1;\n      e.setAnimation(0, \"stand\", !0, null);\n    });\n  },\n  showBuffEffect: function (t, e) {\n    if (void 0 === e) {\n      e = !1;\n    }\n    if (e) {\n      this.scene.addBuffPrefab\n        .addNodeTo(this.item.spine.node, cc.Vec2.ZERO)\n        .getComponent(sp.Skeleton)\n        .setAnimation(0, t, !1);\n    } else {\n      this.scene.showBuffEffect(t, this.node.position);\n    }\n  },\n  update: function (t) {\n    // 确保初始化完成\n    if (!this.isInitialized || !this.scene) {\n      if (!this.loggedNotInit) {\n        console.warn(\"[Hero Update] ID未知, 未初始化或scene不存在\");\n        this.loggedNotInit = true;\n      }\n      return;\n    }\n    if (\n      !this.scene.timePaused &&\n      !(this.scene.hasEnded || this.hp <= 0 || this.hasDie)\n    ) {\n      var e = t * cc.director.getScheduler().getTimeScale();\n      // 每秒只打印一次日志，避免刷屏\n      if (!this.lastLogTime) {\n        this.lastLogTime = 0;\n      }\n      var currentTime = Date.now();\n      if (currentTime - this.lastLogTime > 1000) {\n        console.log(\n          \"[Hero Update] ID:\" +\n            this.info.id +\n            \", enabled:\" +\n            this.enabled +\n            \", 位置:\" +\n            this.node.position +\n            \", 敌人数:\" +\n            (this.scene.enemys ? this.scene.enemys.length : 0) +\n            \", isMoving:\" +\n            this.isMoving\n        );\n        this.lastLogTime = currentTime;\n      }\n      this.updateMovement(e);\n    }\n  },\n  updateMovement: function (t) {\n    // 检查是否有敌人存在\n    if (!this.scene.enemys || this.scene.enemys.length === 0) {\n      // 没有敌人时，返回初始位置\n      this.returnToInitialPosition(t);\n      return;\n    }\n\n    // 寻找最近的敌人（所有英雄都移动，不区分类型）\n    var e = this.scene.chooseEnemy(this, 999999);\n    if (e && e.hp > 0) {\n      this.currentTarget = e;\n      var i = e.node.position.add(cc.v2(0, e.centerY));\n      var n = i.sub(this.node.position);\n      var o = n.lengthSqr();\n\n      // 检查是否在攻击范围内\n      if (o <= this.atkRR) {\n        // 在攻击范围内，停止移动\n        if (this.isMoving) {\n          this.isMoving = false;\n          this.hasReachedAttackRange = true;\n          console.log(\"[Hero] ID:\" + this.info.id + \" 到达攻击范围\");\n          // 不立即切换动画，让攻击动画控制\n        }\n      } else {\n        // 不在攻击范围内，继续向敌人移动\n        if (!this.isMoving) {\n          this.isMoving = true;\n          this.hasReachedAttackRange = false;\n          console.log(\"[Hero] ID:\" + this.info.id + \" 开始向敌人移动\");\n          // 只在非攻击状态时切换为移动动画\n          if (!this.isAttacking) {\n            this.setAnimation(0, \"walk\", !0, null);\n          }\n        }\n\n        // 计算移动方向和移动\n        var s = Math.atan2(n.y, n.x);\n        var c = cc.v2(\n          this.moveSpeed * Math.cos(s) * t,\n          this.moveSpeed * Math.sin(s) * t\n        );\n\n        // 更新位置\n        var oldPos = this.node.position.clone();\n        this.node.position = this.node.position.add(c);\n        this.node.zIndex = -this.node.y;\n        this.item.barNode.position = this.item.barNode.position.add(c);\n\n        this.updateItemSpinePosition();\n\n        // 调试：打印移动信息（每秒一次）\n        if (!this.lastMoveLogTime) {\n          this.lastMoveLogTime = 0;\n        }\n        var nowTime = Date.now();\n        if (nowTime - this.lastMoveLogTime > 1000) {\n          console.log(\n            \"[Hero Move] ID:\" +\n              this.info.id +\n              \", 从\" +\n              oldPos +\n              \" 移动到\" +\n              this.node.position +\n              \", 移动量:\" +\n              c\n          );\n          this.lastMoveLogTime = nowTime;\n        }\n\n        // 更新position2用于敌人的攻击判断\n        this.position2 = this.node.position.add(this.item.attOffset);\n      }\n    } else {\n      // 没有有效敌人，返回初始位置\n      this.returnToInitialPosition(t);\n    }\n  },\n  updateItemSpinePosition: function () {\n    // 将Hero节点的世界坐标转换为item.spine父节点的本地坐标\n    if (this.item && this.item.spine && this.item.spine.node) {\n      // 获取Hero节点的世界坐标\n      var heroWorldPos = this.node.parent.convertToWorldSpaceAR(\n        this.node.position\n      );\n      // 转换为item.spine父节点的本地坐标\n      var spineLocalPos =\n        this.item.spine.node.parent.convertToNodeSpaceAR(heroWorldPos);\n\n      // 调试：首次移动时打印日志\n      if (!this.loggedSpineUpdate) {\n        console.log(\n          \"[Hero] ID:\" + this.info.id + \" 第一次同步spine位置 - Hero世界坐标:\",\n          heroWorldPos,\n          \"spine本地坐标:\",\n          spineLocalPos\n        );\n        this.loggedSpineUpdate = true;\n      }\n\n      // 更新item.spine的位置\n      this.item.spine.node.position = spineLocalPos;\n    } else {\n      if (!this.loggedSpineError) {\n        console.error(\n          \"[Hero] ID:\" + this.info.id + \" 无法同步spine位置！item:\",\n          !!this.item,\n          \"spine:\",\n          !!(this.item && this.item.spine),\n          \"spine.node:\",\n          !!(this.item && this.item.spine && this.item.spine.node)\n        );\n        this.loggedSpineError = true;\n      }\n    }\n  },\n  returnToInitialPosition: function (t) {\n    var distSqr = this.node.position.sub(this.initialPosition).lengthSqr();\n    if (distSqr > 1) {\n      if (!this.isMoving) {\n        this.isMoving = true;\n        if (!this.isAttacking) {\n          this.setAnimation(0, \"walk\", !0, null);\n        }\n      }\n      var a = this.initialPosition.sub(this.node.position);\n      var r = Math.atan2(a.y, a.x);\n      var h = cc.v2(\n        this.moveSpeed * Math.cos(r) * t,\n        this.moveSpeed * Math.sin(r) * t\n      );\n      if (h.lengthSqr() > a.lengthSqr()) {\n        this.node.position = this.initialPosition.clone();\n      } else {\n        this.node.position = this.node.position.add(h);\n      }\n      this.node.zIndex = -this.node.y;\n\n      // 【关键】同步更新item.spine的显示位置\n      this.updateItemSpinePosition();\n\n      this.position2 = this.node.position.add(this.item.attOffset);\n    } else {\n      if (this.isMoving) {\n        this.isMoving = false;\n        // 返回初始位置后，恢复item.spine到初始位置\n        if (this.item && this.item.spine && this.item.spine.node) {\n          this.item.spine.node.position = this.itemSpineInitialPos.clone();\n        }\n        if (!this.isAttacking) {\n          this.setAnimation(0, \"stand\", !0, null);\n        }\n      }\n    }\n  },\n});\n"]}