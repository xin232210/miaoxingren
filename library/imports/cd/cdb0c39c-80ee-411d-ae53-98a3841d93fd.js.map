{"version":3,"sources":["assets/mainUI/scripts/ActLevelItem.js"],"names":["cc","Class","Component","properties","timeLabel","Label","timePanel","Node","battleTimesLabel","battleBtn","redTip","initActLevelItem","e","actType","stageLevel","pvz","PlayerData","getStageLevel","lockLevel","GameConfig","OpenSysLv","active","t","children","getComponent","Sprite","JsonControl","setSpriteGray","ActType","initActLevelInfo","onCheckActLevelRed","checkAndResetActLevel","ActLevelData","getActLevelData","string","times","lastTime","utils","getTodayLastTimes","formatSeconds3","schedule","refreshLoastTime","ActLevelBoxJson","score","boxStatus","ActBallData","onClickActStart","popupManager","showToast","popup","ad","scale","UIActLevel","initActItemList"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        timeLabel: cc.Label,\n        timePanel: cc.Node,\n        battleTimesLabel: cc.Label,\n        battleBtn: cc.Node,\n        redTip: cc.Node\n    },\n    initActLevelItem: function (e) {\n        this.actType = e;\n        this.stageLevel = cc.pvz.PlayerData.getStageLevel();\n        this.lockLevel = cc.pvz.GameConfig.OpenSysLv[this.actType];\n        this.timePanel.active = this.stageLevel > this.lockLevel;\n        var t = this.battleBtn.children[0].getComponent(cc.Sprite);\n        cc.JsonControl.setSpriteGray(t, this.stageLevel <= this.lockLevel);\n        if (this.actType === cc.pvz.GameConfig.ActType[\"挑战副本\"]) {\n            this.initActLevelInfo();\n        }\n        this.onCheckActLevelRed();\n    },\n    initActLevelInfo: function () {\n        cc.pvz.PlayerData.checkAndResetActLevel();\n        this.ActLevelData = cc.pvz.PlayerData.getActLevelData();\n        this.battleTimesLabel.string = this.ActLevelData.times;\n        this.lastTime = cc.pvz.utils.getTodayLastTimes();\n        this.timeLabel.string = \"\" + cc.pvz.utils.formatSeconds3(this.lastTime);\n        this.schedule(this.refreshLoastTime, 1);\n    },\n    refreshLoastTime: function () {\n        this.lastTime--;\n        this.timeLabel.string = cc.pvz.utils.formatSeconds3(this.lastTime);\n        if (this.lastTime <= 0) {\n            this.lastTime = 86400;\n            this.timeLabel.string = cc.pvz.utils.formatSeconds3(this.lastTime);\n            if (this.actType == cc.pvz.GameConfig.ActType[\"挑战副本\"]) {\n                cc.pvz.PlayerData.checkAndResetActLevel();\n                this.ActLevelData = cc.pvz.PlayerData.getActLevelData();\n                this.battleTimesLabel.string = this.ActLevelData.times;\n            }\n            this.redTip.active = this.stageLevel > this.lockLevel;\n        }\n    },\n    onCheckActLevelRed: function () {\n        if (this.stageLevel <= this.lockLevel) {\n            this.redTip.active = !1;\n        } else {\n            if (this.actType == cc.pvz.GameConfig.ActType[\"挑战副本\"]) {\n                if (this.ActLevelData.times > 0) {\n                    return void (this.redTip.active = !0);\n                }\n                var e = cc.JsonControl.ActLevelBoxJson;\n                for (var t = 0; t < 4; t++) {\n                    if (e[t].score <= this.ActLevelData.score && 0 == this.ActLevelData.boxStatus[t]) {\n                        return void (this.redTip.active = !0);\n                    }\n                }\n            } else if (this.ActBallData.times > 0) {\n                return void (this.redTip.active = !0);\n            }\n            this.redTip.active = !1;\n        }\n    },\n    onClickActStart: function () {\n        if (this.stageLevel <= this.lockLevel) {\n            cc.popupManager.showToast(\"通过关卡第\" + this.lockLevel + \"关解锁！\");\n        } else if (this.actType === cc.pvz.GameConfig.ActType[\"挑战副本\"]) {\n            cc.popupManager.popup(\n                \"mainUI\",\n                \"TiaozhanInfoUI\",\n                \"UIActLevelInfo\",\n                {\n                    ad: !1,\n                    scale: !1\n                },\n                function () {\n                    cc.UIActLevel.initActItemList();\n                }\n            );\n        }\n    }\n});\n"]}