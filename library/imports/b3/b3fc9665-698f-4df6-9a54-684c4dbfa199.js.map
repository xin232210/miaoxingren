{"version":3,"sources":["assets/rank/scripts/WxUserInfoBtn.js"],"names":["cc","Class","Component","properties","onTap","EventHandler","start","sys","platform","WECHAT_GAME","createBtn","e","wxBtn","setVisible","t","wx","getWindowInfo","getSystemInfoSync","n","view","getViewportRect","c","node","getBoundingBoxToWorld","o","getScaleX","x","y","i","getDevicePixelRatio","a","r","getScaleY","s","type","text","style","left","top","windowHeight","height","width","backgroundColor","withCredentials","p","createUserInfoButton","emit","console","log","onDestroy","destroy","show","hide"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        onTap: cc.Component.EventHandler\n    },\n    start: function () {\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\n            this.createBtn();\n        }\n    },\n    createBtn: function () {\n        var e = this;\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\n            if (this.wxBtn) {\n                this.setVisible(!0);\n            } else {\n                var t;\n                if (wx.getWindowInfo) {\n                    t = wx.getWindowInfo();\n                } else {\n                    t = wx.getSystemInfoSync();\n                }\n                var n = cc.view.getViewportRect();\n                var c = this.node.getBoundingBoxToWorld();\n                var o = cc.view.getScaleX();\n                c.x += n.x / o;\n                c.y += n.y / o;\n                var i = cc.view.getDevicePixelRatio();\n                var a = o / i;\n                var r = cc.view.getScaleY() / i;\n                var s = {\n                    type: \"text\",\n                    text: \"\",\n                    style: {\n                        left: c.x * a,\n                        top: t.windowHeight - (c.y + c.height) * r,\n                        width: c.width * a,\n                        height: c.height * r,\n                        backgroundColor: \"#80ff0000\",\n                        withCredentials: !1\n                    }\n                };\n                var p = wx.createUserInfoButton(s);\n                if (this.onTap) {\n                    p.onTap(function (t) {\n                        e.onTap.emit([t]);\n                    });\n                }\n                this.wxBtn = p;\n            }\n        } else {\n            console.log(\"create wechat userinfo btn\");\n        }\n    },\n    onDestroy: function () {\n        if (this.wxBtn) {\n            this.wxBtn.destroy();\n            this.wxBtn = null;\n        }\n    },\n    setVisible: function (e) {\n        if (e) {\n            if (this.wxBtn) {\n                this.wxBtn.show();\n            } else {\n                this.createBtn();\n            }\n        } else {\n            if (this.wxBtn) {\n                this.wxBtn.hide();\n            }\n        }\n    }\n});\n"]}