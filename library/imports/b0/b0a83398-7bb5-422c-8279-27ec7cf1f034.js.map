{"version":3,"sources":["assets/scripts/EnemySpawner2.js"],"names":["$battleGround2Ctrl","require","$role2","i","cc","_decorator","c","ccclass","s","property","r","e","t","apply","arguments","jsonConfig","par","tCount","enemyLivingCount","waveId","ePoint","waveEnemies","waveEnemyRec","__extends","prototype","init","pvz","runtimeData","wave","prepareNewWaveEnemy","waveEnemyHandles","o","json","length","level","a","numb","n","push","spawnNewEnemy","state","node","getComponent","createNewGate","createNewEnemy","baseLineY","rId","config","zIndex","collBody","enabled","winTCount","updateEnemyHandles","Math","floor","shift","start","update","__decorate","JsonAsset","Component","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var $battleGround2Ctrl = require(\"./BattleGround2Ctrl\");\nvar $role2 = require(\"./Role2\");\nvar i = cc._decorator;\nvar c = i.ccclass;\nvar s = i.property;\nvar r = (function (e) {\n    function t() {\n        var t = (null !== e && e.apply(this, arguments)) || this;\n        t.jsonConfig = null;\n        t.par = null;\n        t.tCount = 0;\n        t.enemyLivingCount = [0, 0];\n        t.waveId = 0;\n        t.ePoint = 0;\n        t.waveEnemies = [\n            [[1], [360, 360], [360, 360]],\n            [[1], [360], [360, 360], [360, 360, 360], [360, 360], [360]],\n            [[1], [360], [360, 360], [360, 360, 360], [360, 360, 360, 360]],\n            [[10], [360, 360, 360, 360, 360, 360]]\n        ];\n        t.waveEnemyRec = [];\n        return t;\n    }\n    __extends(t, e);\n    t.prototype.init = function () {\n        cc.pvz.runtimeData.wave = 0;\n        this.prepareNewWaveEnemy();\n    };\n    t.prototype.prepareNewWaveEnemy = function (e) {\n        if (void 0 === e) {\n            e = 1;\n        }\n        this.par.waveEnemyHandles = [[], [], [], [], [], []];\n        var t = 0;\n        for (var o = 0; o < this.jsonConfig.json.length; o++) {\n            if (this.jsonConfig.json[o].level === this.waveId + 1) {\n                t = o;\n                break;\n            }\n        }\n        for (; this.jsonConfig.json[t].level === this.waveId + 1; ) {\n            var a = this.jsonConfig.json[t].numb - 1;\n            if (a > 2) {\n                a = 3;\n            }\n            var n = this.waveEnemies[a][0][0];\n            if (3 === a) {\n                n = this.jsonConfig.json[t].numb;\n            }\n            this.waveEnemyRec = [];\n            for (var i = 0; i < n; i++) {\n                for (o = 1; o < this.waveEnemies[a].length; o++) {\n                    for (var c = 0; c < this.waveEnemies[a][o].length; c++) {\n                        this.waveEnemyRec.push([e, t, this.waveEnemies[a][o][c]]);\n                    }\n                    e += 1;\n                }\n            }\n            t++;\n            if (!this.jsonConfig.json[t]) {\n                break;\n            }\n        }\n        if (t >= this.jsonConfig.json.length) {\n            //\n        } else {\n            this.waveEnemyRec.push([e + 3, t - 1, 99999]);\n        }\n        this.tCount = 0;\n        this.ePoint = 0;\n    };\n    t.prototype.spawnNewEnemy = function (e) {\n        if (10 === this.par.state) {\n            this.tCount += e;\n            for (\n                var t = this.jsonConfig.json;\n                this.ePoint < this.waveEnemyRec.length && this.tCount >= this.waveEnemyRec[this.ePoint][0];\n\n            ) {\n                if (99999 === this.waveEnemyRec[this.ePoint][2]) {\n                    this.node\n                        .getComponent($battleGround2Ctrl.default)\n                        .createNewGate(t[this.waveEnemyRec[this.ePoint][1]]);\n                } else {\n                    var o = this.par.createNewEnemy(this.waveEnemyRec[this.ePoint][2], this.par.baseLineY, {\n                        rId: this.waveEnemyRec[this.ePoint][1],\n                        config: t[this.waveEnemyRec[this.ePoint][1]]\n                    });\n                    o.zIndex = -this.ePoint;\n                    if (t[this.waveEnemyRec[this.ePoint][1]].numb >= 10) {\n                        var i = (this.waveEnemyRec[this.ePoint][2] + 250) / 100;\n                        this.par.waveEnemyHandles[i].push(o);\n                        if (1 === this.par.waveEnemyHandles[i].length) {\n                            o.getComponent($role2.default).collBody.enabled = !0;\n                        } else {\n                            o.getComponent($role2.default).collBody.enabled = !1;\n                        }\n                    } else {\n                        o.getComponent($role2.default).collBody.enabled = !0;\n                    }\n                }\n                this.ePoint++;\n            }\n            if (this.ePoint === this.waveEnemyRec.length) {\n                if (this.waveId + 1 === t[t.length - 1].level) {\n                    -99999999 === this.par.winTCount && (this.par.winTCount = 6);\n                } else {\n                    this.waveId++, cc.pvz.runtimeData.wave++, this.prepareNewWaveEnemy(4);\n                }\n            }\n        }\n    };\n    t.prototype.updateEnemyHandles = function (e) {\n        var t = Math.floor((e + 250) / 100);\n        if (this.par.waveEnemyHandles[t]) {\n            this.par.waveEnemyHandles[t].shift();\n            if (this.par.waveEnemyHandles[t].length >= 1) {\n                this.par.waveEnemyHandles[t][0].getComponent($role2.default).collBody.enabled = !0;\n            }\n        }\n    };\n    t.prototype.start = function () {\n        this.init();\n    };\n    t.prototype.update = function (e) {\n        this.spawnNewEnemy(e);\n    };\n    __decorate([s(cc.JsonAsset)], t.prototype, \"jsonConfig\", void 0);\n    __decorate([s($battleGround2Ctrl.default)], t.prototype, \"par\", void 0);\n    return __decorate([c], t);\n})(cc.Component);\nexports.default = r;"]}