{"version":3,"sources":["assets/mainUI/scripts/ShopCoinItem.js"],"names":["cc","Class","Component","properties","countLabel","Label","priceLabel","finishNode","Node","freeNode","adPanel","adTimesLabel","cdTimeLabel","initShopCoinItem","e","t","shopId","shopJson","i","pvz","PlayerData","getShopTimes","GameConfig","ShopTimesType","isFree","isFinish","active","string","node","priceNum","count","num1","rewardData","utils","getRewardItem","ItemType","onClickBuy","UIShop","isLookAd","onStopShopScroll","popupManager","showToast","updateShopTimes","updateRedTip","popup","ad","scale","UIFromType","AdUtils","showAdRewardVideo","AdType","onAdClose","priceItem"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        countLabel: cc.Label,\n        priceLabel: cc.Label,\n        finishNode: cc.Node,\n        freeNode: cc.Node,\n        adPanel: cc.Node,\n        adTimesLabel: cc.Label,\n        cdTimeLabel: cc.Label\n    },\n    initShopCoinItem: function (e, t) {\n        this.shopId = e;\n        this.shopJson = t;\n        if (7 == this.shopId) {\n            var i = cc.pvz.PlayerData.getShopTimes(cc.pvz.GameConfig.ShopTimesType[\"金币免费\"]);\n            this.isFree = 7 == i;\n            this.isFinish = i <= 0;\n            this.finishNode.active = this.isFinish;\n            this.freeNode.active = this.isFree && !this.isFinish;\n            this.adPanel.active = !this.isFree && !this.isFinish;\n            this.adTimesLabel.string = \"(\" + i + \")\";\n            this.cdTimeLabel.node.active = !1;\n        } else {\n            this.priceLabel.string = this.shopJson.priceNum[0];\n        }\n        this.count = this.shopJson.num1[0];\n        this.countLabel.string = \"x\" + this.count;\n        this.rewardData = cc.pvz.utils.getRewardItem(cc.pvz.GameConfig.ItemType[\"金币\"], this.count);\n    },\n    onClickBuy: function () {\n        var e = this;\n        if (!cc.UIShop.isLookAd) {\n            cc.UIShop.onStopShopScroll();\n            if (7 == this.shopId) {\n                if (this.isFinish) {\n                    return void cc.popupManager.showToast(\"已售罄！\");\n                }\n                if (this.isFree) {\n                    cc.pvz.PlayerData.updateShopTimes(cc.pvz.GameConfig.ShopTimesType[\"金币免费\"]);\n                    cc.UIShop.updateRedTip();\n                    cc.popupManager.popup(\n                        \"mainUI\",\n                        \"getrewardUI\",\n                        \"UIReward\",\n                        {\n                            ad: !1,\n                            scale: !1\n                        },\n                        [this.rewardData],\n                        cc.pvz.GameConfig.UIFromType[\"金币商店\"],\n                        function () {\n                            e.initShopCoinItem(e.shopId, e.shopJson);\n                        }\n                    );\n                } else {\n                    cc.UIShop.isLookAd = !0;\n                    cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType[\"商店金币\"], function (t) {\n                        e.onAdClose(t);\n                    });\n                }\n            } else {\n                cc.popupManager.popup(\n                    \"mainUI\",\n                    \"shopbuyUI\",\n                    \"UIShopBuy\",\n                    {\n                        ad: !1,\n                        scale: !0\n                    },\n                    this.rewardData,\n                    [this.shopJson.priceItem[0], this.shopJson.priceNum[0]],\n                    function () {\n                        cc.pvz.PlayerData.updateShopTimes(cc.pvz.GameConfig.ShopTimesType[\"金币免费\"]);\n                        e.initShopCoinItem(e.shopId, e.shopJson);\n                    },\n                    !1\n                );\n            }\n        }\n    },\n    onAdClose: function (e) {\n        var t = this;\n        cc.UIShop.isLookAd = !1;\n        if (e) {\n            cc.pvz.PlayerData.updateShopTimes(cc.pvz.GameConfig.ShopTimesType[\"金币免费\"]);\n            cc.popupManager.popup(\n                \"mainUI\",\n                \"getrewardUI\",\n                \"UIReward\",\n                {\n                    ad: !1,\n                    scale: !1\n                },\n                [this.rewardData],\n                cc.pvz.GameConfig.UIFromType[\"金币商店\"],\n                function () {\n                    t.initShopCoinItem(t.shopId, t.shopJson);\n                }\n            );\n        }\n    }\n});\n"]}