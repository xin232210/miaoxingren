{"version":3,"sources":["assets/game/scripts/Hero.js"],"names":["$bullet","require","cc","Class","Component","properties","spine","sp","Skeleton","zd","zd2","landMineNode","Node","onLoad","node","active","e","console","error","enabled","start","initBy","t","i","n","scene","info","item","itemSpineInitialPos","position","clone","o","json","range","atkRR","lvs","hp","maxHp","shieldValue","hasDie","setAnimation","isPhy","isMagic","is3gz","some","id","is2gz","butler","on","onLvup","initialPosition","moveSpeed","currentTarget","isMoving","hasReachedAttackRange","isInitialized","log","index","lvup","hub","showLvupEffect","convertToWorldSpaceAR","Vec2","ZERO","setCompleteListener","getAtk","Math","min","lv1","attribute2","length","fightlvup2","pvz","runtimeData","getBuffValue","items","getShield","pushLvAndAtk","lv","push","atk","playAttAndDo","checkToStartReloadTimer","setEventListener","playSound","playEffectAsync","tryShoot","needTargetCheck","indexOf","nearTarget","chooseEnemy","targetPos","add","v2","centerY","distance","sub","lengthSqr","r","isAttacking","isValid","checkToShoot","bulletCount","tween","IKBone","to","x","y","findBone","hasEnableBuff","crossItems","forEach","hero","addShield","showBuffEffect","chooseMinHpHero","checkBuff","addHp","getAngerBarWPos","anger","updateAnger","lastBulletCount","instantiate","getHeroesMaxMarginX","math","randomRange","groundAreaLB","groundAreaTR","parent","objsRoot","zIndex","getComponent","Collider","s","scale","max","chooseEnemys","c","a","h","bulletsRoot","defaultAnimation","d","u","convertToNodeSpaceAR","att","p","setTimeout","showJsEffect","l","shift","shoot","bind","getShootAPos","GPBone","worldX","worldY","shootN","shootIK","shoot1","atan2","hitCount","mode","moveByAngle","PI","collider","radius","setTrackEventListener","checkHeroBuff","doBulletAttLogic","weakNode","actBuff1","checkCrit","getCritPlus","hurtBy","showEnemyHurtNum","jsEffExclusive","stats","buffSlow","addBuffSlow","buffIce","random","addBuffIce","addBuffWeak","repulse","attCounter","doLandMinesLogic","onLandminesCollision","find","utils","manuallyCheckCollider","destroy","updateHp","delHp","updateShield","hasEnded","hasUseReborn","hasHero","barNode","reborn","checkIsFail","addBuffPrefab","addNodeTo","update","loggedNotInit","warn","timePaused","director","getScheduler","getTimeScale","lastLogTime","currentTime","Date","now","enemys","updateMovement","returnToInitialPosition","cos","sin","oldPos","updateItemSpinePosition","lastMoveLogTime","nowTime","position2","attOffset","heroWorldPos","spineLocalPos","loggedSpineUpdate","loggedSpineError","distSqr"],"mappings":"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","sourceRoot":"/","sourcesContent":["var $bullet = require(\"./Bullet\");\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        spine: sp.Skeleton,\n        zd: $bullet,\n        zd2: $bullet,\n        landMineNode: cc.Node\n    },\n    onLoad: function () {\n        try {\n            if (this.zd && this.zd.node) {\n                this.zd.node.active = !1;\n            }\n            if (this.zd2 && this.zd2.node) {\n                this.zd2.node.active = !1;\n            }\n            if (this.landMineNode) {\n                this.landMineNode.active = !1;\n            }\n        } catch (e) {\n            console.error(\"[Hero onLoad] 初始化组件失败:\", e);\n        }\n        // 启用update方法以支持移动逻辑\n        this.enabled = true;\n    },\n    start: function () {},\n    initBy: function (t, e, i) {\n        var n = this;\n        this.scene = t;\n        this.info = i;\n        this.item = e;\n        \n        this.spine = this.item.spine;\n        \n        // 保存item.spine节点的初始位置（相对于其父节点）\n        this.itemSpineInitialPos = this.item.spine.node.position.clone();\n        \n        var o = this.info.json.range;\n        this.atkRR = o * o;\n        this.lvs = [];\n        this.hp = this.item.maxHp;\n        this.shieldValue = 0;\n        this.hasDie = !1;\n        this.setAnimation(0, \"Idle\", !0, null);\n        this.isPhy = !0;\n        this.isMagic = !0;\n        this.is3gz = [2, 5, 9, 10].some(function (t) {\n            return t == n.item.id;\n        });\n        this.is2gz = [2, 4, 8].some(function (t) {\n            return t == n.item.id;\n        });\n        cc.butler.node.on(\"lvup\", this.onLvup, this);\n        \n        // 移动相关的初始化\n        this.initialPosition = this.node.position.clone();\n        this.moveSpeed = 20; // 英雄移动速度\n        this.currentTarget = null;\n        this.isMoving = false;\n        this.hasReachedAttackRange = false;\n        this.isInitialized = true;\n        \n        // 关键：确保Hero组件在初始化后启用，以便update方法能被调用\n        this.enabled = true;\n        \n        // 调试日志，确认初始化完成\n        console.log(\"[Hero] initBy完成，ID:\" + this.info.id + \", enabled:\" + this.enabled + \", 初始位置:\", this.initialPosition);\n    },\n    onLvup: function (t) {\n        if (this.item.index == t) {\n            this.item.lvup(!1);\n            this.scene.hub.showLvupEffect(this.node.convertToWorldSpaceAR(cc.Vec2.ZERO));\n        }\n    },\n    setAnimation: function (t, e, i, n) {\n        // this.spine.setAnimation(t, e + (this.item.lv + 1), i);\n        this.spine.setAnimation(t, e, i);\n        this.spine.setCompleteListener(n);\n    },\n    getAtk: function (t) {\n        var e = Math.min(this.info.lv1, this.info.json.attribute2.length - 1);\n        var i = this.info.json.attribute2[e];\n        if (t > 0) {\n            i *= this.info.json.fightlvup2[t - 1] / 100;\n        }\n        var n = cc.pvz.runtimeData.getBuffValue(2);\n        var o = cc.pvz.runtimeData.getBuffValue(10);\n        if (o > 0) {\n            n += o * cc.pvz.runtimeData.items.length;\n        }\n        if (n > 0) {\n            i *= 1 + 0.01 * n;\n        }\n        return i;\n    },\n    getShield: function (t) {\n        var e = Math.min(this.info.lv1, this.info.json.attribute2.length - 1);\n        var i = this.info.json.attribute2[e];\n        if (t > 0) {\n            i *= this.info.json.fightlvup2[t - 1] / 100;\n        }\n        return i;\n    },\n    pushLvAndAtk: function (t) {\n        var e = this.getAtk(t.lv);\n        this.lvs.push({\n            lv: t.lv,\n            atk: e\n        });\n    },\n    playAttAndDo: function (t, e) {\n        var i = this;\n        this.setAnimation(0, \"Hit\", !1, function () {\n            i.item.checkToStartReloadTimer();\n            i.setAnimation(0, \"Idle\", !0, null);\n            if (e) {\n                e();\n            }\n        });\n        this.spine.setEventListener(function () {\n            if (t) {\n                t();\n            }\n        });\n    },\n    playSound: function () {\n        switch (this.info.id) {\n            case 3:\n            case 12:\n                break;\n            case 6:\n                cc.butler.playEffectAsync(\"game\", \"sound/dun\");\n                break;\n            case 8:\n                cc.butler.playEffectAsync(\"game\", \"sound/hp\");\n                break;\n            case 9:\n                cc.butler.playEffectAsync(\"game\", \"sound/jiguang\");\n                break;\n            case 10:\n                cc.butler.playEffectAsync(\"game\", \"sound/getSunShine\");\n                break;\n            default:\n                cc.butler.playEffectAsync(\"game\", \"sound/shoot\");\n        }\n    },\n    tryShoot: function (t, e) {\n        var i = this;\n        \n        // 对于需要敌人目标的攻击型英雄（ID 1,2,4,5,7,9,12），检查是否在攻击范围内\n        // todo 修改为全部英雄都检测\n        var needTargetCheck = [1, 2, 3, 4, 5, 6, 7, 9, 12];\n        if (needTargetCheck.indexOf(this.info.id) !== -1) {\n            // 检查是否在攻击范围内\n            // 注意：不在这里查找目标，因为updateMovement已经在用大范围查找了\n            // 这里只检查当前是否有目标且在攻击范围内\n            if (!this.currentTarget || this.currentTarget.hp <= 0) {\n                // 如果没有当前目标，用实际攻击范围尝试查找\n                var nearTarget = this.scene.chooseEnemy(this, this.atkRR);\n                if (!nearTarget) {\n                    // 没有在攻击范围内的敌人，返回false让英雄继续移动\n                    return false;\n                }\n                this.currentTarget = nearTarget;\n            }\n            \n            // 检查当前目标是否在攻击范围内\n            var targetPos = this.currentTarget.node.position.add(cc.v2(0, this.currentTarget.centerY));\n            var distance = targetPos.sub(this.node.position).lengthSqr();\n            if (distance > this.atkRR) {\n                // 目标不在攻击范围内，返回false让英雄继续移动\n                return false;\n            }\n        }\n        \n        switch (this.info.id) {\n            case 3:\n                // 3号英雄改为普通攻击型\n                var r = e || this.scene.chooseEnemy(this, this.atkRR);\n                return (\n                    !!r &&\n                    (this.pushLvAndAtk(t),\n                    !this.isAttacking &&\n                        ((this.isAttacking = !0),\n                        this.playAttAndDo(\n                            function () {\n                                if (r.isValid) {\n                                    i.isAttacking = !1;\n                                    i.checkToShoot(r);\n                                }\n                            },\n                            function () {\n                                if (i.item.bulletCount <= 0) {\n                                    cc.tween(i.IKBone)\n                                        .to(0.064, {\n                                            x: 150,\n                                            y: 50\n                                        })\n                                        .start();\n                                }\n                            }\n                        ),\n                        this.IKBone || (this.IKBone = this.spine.findBone(\"IK\")),\n                        cc\n                            .tween(this.IKBone)\n                            .to(0.064, {\n                                x: (r.node.x - this.node.x) / 0.76,\n                                y: (r.node.y + r.centerY - this.node.y) / 0.76\n                            })\n                            .start(),\n                        !0))\n                );\n            case 6:\n                this.playAttAndDo(function () {\n                    var t = i.getAtk(i.item.lv) / 100;\n                    var e = 0;\n                    if (cc.pvz.runtimeData.hasEnableBuff(601)) {\n                        e = 0.15;\n                    }\n                    if (cc.pvz.runtimeData.hasEnableBuff(602)) {\n                        e += 0.3;\n                    }\n                    if (e > 0) {\n                        t *= 1 + e;\n                    }\n                    i.item.crossItems.forEach(function (e) {\n                        if (e.hero && e.hero.hp > 0) {\n                            e.hero.addShield(e.maxHp * t);\n                            i.scene.showBuffEffect(\"shield\", e.hero.node.position);\n                        }\n                    });\n                });\n                return !0;\n            case 8:\n                var n = this.scene.chooseMinHpHero();\n                return (\n                    !!n &&\n                    (this.playAttAndDo(function () {\n                        var t = i.getAtk(i.item.lv);\n                        if (i.checkBuff(802)) {\n                            t *= 1.2;\n                        }\n                        n.addHp(t);\n                        i.scene.showBuffEffect(\"HP\", n.node.position);\n                    }),\n                    !0)\n                );\n            case 10:\n                this.playAttAndDo(function () {\n                    var t = i.getAtk(i.item.lv);\n                    var e = 0;\n                    if (cc.pvz.runtimeData.hasEnableBuff(1001)) {\n                        e = 0.1;\n                    }\n                    if (cc.pvz.runtimeData.hasEnableBuff(1002)) {\n                        e += 0.2;\n                    }\n                    if (e > 0) {\n                        t *= 1 + e;\n                    }\n                    i.scene.showBuffEffect(\n                        \"music\",\n                        i.node.position.add(cc.v2(0, 50)),\n                        i.scene.getAngerBarWPos(),\n                        function () {\n                            cc.pvz.runtimeData.anger += t;\n                            i.scene.updateAnger();\n                        }\n                    );\n                });\n                return !0;\n            case 11:\n                this.playAttAndDo(function () {\n                    var t = 1;\n                    if (cc.pvz.runtimeData.hasEnableBuff(1104)) {\n                        if (i.lastBulletCount) {\n                            if (1 == i.lastBulletCount) {\n                                t = 2;\n                            } else {\n                                t = 1;\n                            }\n                        }\n                        i.lastBulletCount = t;\n                    }\n                    var e = function () {\n                        var t = cc.instantiate(i.landMineNode);\n                        var e = cc.v2(\n                            i.scene.getHeroesMaxMarginX() + cc.math.randomRange(0, 150),\n                            cc.math.randomRange(i.scene.groundAreaLB.y + 120, i.scene.groundAreaTR.y - 120)\n                        );\n                        t.position = i.node.position;\n                        t.active = !0;\n                        t.parent = i.scene.objsRoot;\n                        t.zIndex = -t.y;\n                        var n = t.getComponent(cc.Collider);\n                        n.enabled = !1;\n                        var o = t.getComponent(sp.Skeleton);\n                        var s = o.findBone(\"IK\");\n                        s.x = (e.x - t.x) / t.scale;\n                        s.y = (e.y - t.y) / t.scale;\n                        s.x = Math.max(0, s.x);\n                        o.setAnimation(0, \"zd11_1\", !0);\n                        o.setCompleteListener(function () {\n                            t.position = e;\n                            n.enabled = !0;\n                            o.setAnimation(0, \"zd11_2\", !1);\n                            o.setCompleteListener(null);\n                        });\n                    };\n                    for (var n = 0; n < t; n++) {\n                        e();\n                    }\n                });\n                return !0;\n            case 12:\n                var o = this.checkBuff(1204) ? 2 : 1,\n                    s = this.scene.chooseEnemys(this, this.atkRR, o);\n                if (0 == s.length) {\n                    return !1;\n                }\n                var c = this.scene.getHeroesMaxMarginX(),\n                    a = 0;\n                this.playAttAndDo(function () {\n                    if (1 != a || i.checkBuff(1204)) {\n                        var t = s[Math.min(s.length - 1, a)];\n                        var e = t.node.position.add(cc.v2(0, t.centerY));\n                        var n = cc.v2(Math.min(c, e.x), e.y);\n                        var o = i.scene.objsRoot.convertToWorldSpaceAR(n);\n                        var r = cc.instantiate(i.zd.node);\n                        var h = r.getComponent(\"Bullet\");\n                        r.parent = i.scene.bulletsRoot;\n                        r.active = !0;\n                        r.position = i.node.position;\n                        h.spine.setAnimation(0, h.spine.defaultAnimation, !0);\n                        var d = h.spine.findBone(\"IK\");\n                        var u = h.spine.node.convertToNodeSpaceAR(o);\n                        d.x = u.x;\n                        d.y = u.y;\n                        h.initBy(i.scene, i.item.lv);\n                        h.a = i;\n                        h.att = i.getAtk(i.item.lv);\n                        var p = function (t) {\n                            i.scene.setTimeout(function () {\n                                i.scene.showJsEffect(cc.v2(n.x + 100 * t, n.y), i.info.id);\n                            }, 48 * t);\n                        };\n                        for (var l = 1; l < 5; l++) {\n                            p(l);\n                        }\n                        cc.butler.playEffectAsync(\"game\", \"sound/gunzi\");\n                        a++;\n                    }\n                });\n                return !0;\n        }\n        var r = e || this.scene.chooseEnemy(this, this.atkRR);\n        return (\n            !!r &&\n            (this.pushLvAndAtk(t),\n            !this.isAttacking &&\n                ((this.isAttacking = !0),\n                this.playAttAndDo(\n                    function () {\n                        if (r.isValid) {\n                            i.isAttacking = !1;\n                            i.checkToShoot(r);\n                        }\n                    },\n                    function () {\n                        if (i.item.bulletCount <= 0) {\n                            cc.tween(i.IKBone)\n                                .to(0.064, {\n                                    x: 150,\n                                    y: 50\n                                })\n                                .start();\n                        }\n                    }\n                ),\n                this.IKBone || (this.IKBone = this.spine.findBone(\"IK\")),\n                cc\n                    .tween(this.IKBone)\n                    .to(0.064, {\n                        x: (r.node.x - this.node.x) / 0.76,\n                        y: (r.node.y + r.centerY - this.node.y) / 0.76\n                    })\n                    .start(),\n                !0))\n        );\n    },\n    checkToShoot: function (t) {\n        if (0 != this.lvs.length) {\n            if (this.zd) {\n                var e = this.lvs.shift();\n                var i = t || this.scene.chooseEnemy(this, this.atkRR);\n                if (i) {\n                    this.shoot(i, this.item.lv, e.atk);\n                }\n            }\n            if (this.lvs.length > 0) {\n                this.scene.setTimeout(this.checkToShoot.bind(this), 80);\n            }\n        }\n    },\n    getShootAPos: function () {\n        if (this.GPBone) {\n            //\n        } else {\n            this.GPBone = this.spine.findBone(\"GP\");\n        }\n        var t = cc.v2(this.GPBone.worldX, this.GPBone.worldY);\n        return this.spine.node.convertToWorldSpaceAR(t);\n    },\n    shoot: function (t, e, i) {\n        if (4 == this.info.id) {\n            var n;\n            if (this.checkBuff(401)) {\n                n = 9;\n            } else {\n                n = 5;\n            }\n            return this.shootN(n, t, e, i);\n        }\n        if (this.checkBuff(904)) {\n            return this.shootN(3, t, e, i);\n        } else {\n            if (7 == this.info.id) {\n                return this.shootIK(t, e, i);\n            } else {\n                return void this.shoot1(t, e, i);\n            }\n        }\n    },\n    shoot1: function (t, e, i) {\n        var n = this.getShootAPos();\n        var o = this.scene.bulletsRoot.convertToNodeSpaceAR(n);\n        var s = t.node.position.add(cc.v2(0, t.centerY)).sub(o);\n        if (s.x < 0) {\n            s.x = 0;\n        }\n        var c = Math.atan2(s.y, s.x);\n        var a = this.zd;\n        var r = cc.instantiate(a.node);\n        r.parent = this.scene.bulletsRoot;\n        r.active = !0;\n        r.position = o;\n        var h = r.getComponent(\"Bullet\");\n        if (this.checkBuff(104)) {\n            h.hitCount = 2;\n        }\n        if (this.checkBuff(503)) {\n            h.hitCount = 2;\n        }\n        h.initBy(this.scene, e);\n        h.a = this;\n        if (13 == this.info.id && 2 == cc.pvz.runtimeData.mode) {\n            h.att = i / 2;\n        } else {\n            h.att = i;\n        }\n        h.moveByAngle((180 * c) / Math.PI);\n    },\n    shootN: function (t, e, i, n) {\n        var o = this.getShootAPos();\n        var s = this.scene.bulletsRoot.convertToNodeSpaceAR(o);\n        var c = e.node.position.add(cc.v2(0, e.centerY)).sub(s);\n        if (c.x < 0) {\n            c.x = 0;\n        }\n        var a = (180 * Math.atan2(c.y, c.x)) / Math.PI;\n        var r;\n        if (t > 5) {\n            r = [0, -10, -20, -30, 40, 10, 20, 30, 40];\n        } else {\n            r = [0, -15, 15, -30, 30];\n        }\n        for (var h = 0; h < t; h++) {\n            var d = cc.instantiate(this.zd.node);\n            d.parent = this.scene.bulletsRoot;\n            d.active = !0;\n            d.position = s;\n            var u = d.getComponent(\"Bullet\");\n            u.initBy(this.scene, i);\n            u.a = this;\n            u.att = n;\n            u.moveByAngle(a + r[h]);\n        }\n    },\n    shootIK: function (t, e, i) {\n        var n = this;\n        var o = this.getShootAPos();\n        var s = this.scene.bulletsRoot.convertToNodeSpaceAR(o);\n        var c = t.node.convertToWorldSpaceAR(cc.v2(0, t.centerY));\n        var a = cc.instantiate(this.zd.node);\n        var r = a.getComponent(\"Bullet\");\n        a.parent = this.scene.bulletsRoot;\n        a.active = !0;\n        a.position = s;\n        if (this.checkBuff(702)) {\n            a.getComponent(\"EventCollider\").collider.radius *= 1.3;\n        }\n        var h = r.spine.setAnimation(0, r.spine.defaultAnimation, !0);\n        r.spine.setTrackEventListener(h, function () {\n            n.scene.showJsEffect(t.node.position, n.info.id);\n        });\n        var d = r.spine.findBone(\"IK\");\n        var u = r.spine.node.convertToNodeSpaceAR(c);\n        d.x = u.x;\n        d.y = u.y;\n        d.x = Math.max(0, d.x);\n        r.initBy(this.scene, e);\n        r.a = this;\n        r.att = i;\n    },\n    checkHeroBuff: function () {\n        return !1;\n    },\n    checkBuff: function (t) {\n        var e = (t - (t % 100)) / 100;\n        return this.info.id == e && cc.pvz.runtimeData.hasEnableBuff(t);\n    },\n    doBulletAttLogic: function (t, e) {\n        var i = t.att;\n        if (this.checkBuff(101)) {\n            i *= 1.25;\n        }\n        if (this.checkBuff(201)) {\n            i *= 1.25;\n        }\n        if (this.checkBuff(504)) {\n            i *= 1.5;\n        }\n        if (this.checkBuff(701)) {\n            i *= 1.25;\n        }\n        if (this.checkBuff(901)) {\n            i *= 1.25;\n        }\n        if (this.checkBuff(1101)) {\n            i *= 1.25;\n        }\n        if (this.checkBuff(1201)) {\n            i *= 1.25;\n        }\n        if (e.weakNode && this.isPhy) {\n            i *= 1.2;\n        }\n        switch (cc.pvz.runtimeData.actBuff1) {\n            case 1:\n            case 2:\n            case 3:\n                if (this.isPhy) {\n                    i *= [1.3, 1.4, 1.5][cc.pvz.runtimeData.actBuff1 - 1];\n                }\n                break;\n            case 4:\n            case 5:\n            case 6:\n                if (this.is3gz) {\n                    i *= [1.3, 1.4, 1.5][cc.pvz.runtimeData.actBuff1 - 4];\n                }\n                break;\n            case 10:\n            case 11:\n            case 12:\n                if (this.is2gz) {\n                    i *= [1.3, 1.4, 1.5][cc.pvz.runtimeData.actBuff1 - 10];\n                }\n        }\n        var n = 0;\n        if (this.checkCrit(t, e)) {\n            n = 1;\n            i *= this.getCritPlus(t, e);\n        }\n        i *= cc.math.randomRange(0.95, 1.05);\n        e.hurtBy(this, i);\n        this.scene.showEnemyHurtNum(n, e.node.position, i);\n        if (t.jsEffExclusive) {\n            //\n        } else {\n            this.scene.showJsEffect(e.node.position, this.info.id);\n        }\n        cc.pvz.runtimeData.stats[this.info.id] += i;\n        if (t.buffSlow) {\n            e.addBuffSlow();\n        }\n        if (t.buffIce && this.checkBuff(1203) && Math.random() < 0.2) {\n            e.addBuffIce();\n        }\n        if (this.checkBuff(704) && Math.random() < 0.5) {\n            e.addBuffWeak();\n        }\n        if (this.checkBuff(204)) {\n            e.repulse(this.node.position);\n        }\n        if (this.checkBuff(403)) {\n            e.repulse(this.node.position);\n        }\n        if (this.checkBuff(1102)) {\n            e.repulse(this.node.position);\n        }\n    },\n    checkCrit: function () {\n        if (this.checkBuff(501)) {\n            if (this.attCounter) {\n                this.attCounter = this.attCounter + 1;\n            } else {\n                this.attCounter = 1;\n            }\n            var t;\n            if (this.checkBuff(502)) {\n                t = 2;\n            } else {\n                t = 3;\n            }\n            if (this.attCounter >= t) {\n                this.attCounter = 0;\n                return !0;\n            }\n        }\n        var e = 0;\n        if (this.checkBuff(102)) {\n            e += 0.25;\n        }\n        if (this.checkBuff(404)) {\n            e += 0.25;\n        }\n        if (this.checkBuff(903)) {\n            e += 0.1;\n        }\n        return Math.random() < e;\n    },\n    getCritPlus: function () {\n        var t = 1.5;\n        if (this.checkBuff(103)) {\n            t += 0.5;\n        }\n        return t;\n    },\n    doLandMinesLogic: function (t) {\n        var e = t.getComponent(\"Enemy\");\n        if (e && e.hp > 0) {\n            this.doBulletAttLogic(\n                {\n                    att: this.getAtk(this.item.lv),\n                    lv: this.item.lv,\n                    jsEffExclusive: !0\n                },\n                e\n            );\n        }\n    },\n    onLandminesCollision: function (t, e) {\n        if (e.enabled) {\n            var i = t.getComponent(\"Enemy\");\n            if (i && i.hp > 0) {\n                e.enabled = !1;\n                var n = e.node.getComponent(sp.Skeleton);\n                var o = cc.find(\"range\", e.node).getComponent(cc.Collider);\n                cc.pvz.utils.manuallyCheckCollider(o);\n                this.scene.showJsEffect(e.node.position, this.info.id);\n                n.node.destroy();\n            }\n        }\n    },\n    addHp: function (t) {\n        this.hp = Math.min(this.item.maxHp, this.hp + t);\n        this.item.updateHp(this.hp / this.item.maxHp);\n        this.scene.updateHp(!0);\n    },\n    delHp: function (t) {\n        this.hp = Math.max(0, this.hp - t);\n        this.item.updateHp(this.hp / this.item.maxHp);\n        this.scene.updateHp(!0);\n    },\n    addShield: function (t) {\n        this.shieldValue = Math.min(this.item.maxHp, this.shieldValue + t);\n        this.item.updateShield(this.shieldValue / this.item.maxHp);\n        this.scene.updateShield();\n    },\n    hurtBy: function (t, e, i) {\n        // 受伤\n        var n = this;\n        if (!(this.hasEnded || this.hp <= 0)) {\n            if (this.shieldValue > 0) {\n                var o = Math.min(this.shieldValue, i);\n                i -= o;\n                this.shieldValue -= o;\n                this.item.updateShield(this.shieldValue / this.item.maxHp);\n            }\n            if (i > 0 && (this.delHp(i), this.hp <= 0)) {\n                var s =\n                    !cc.pvz.runtimeData.hasUseReborn &&\n                    (8 == this.info.id || this.scene.hasHero(8)) &&\n                    cc.pvz.runtimeData.hasEnableBuff(803);\n                if (s) {\n                    cc.pvz.runtimeData.hasUseReborn = !0;\n                } else {\n                    // 血条\n                    this.item.barNode.active = !1;\n                }\n                this.setAnimation(0, \"Dead\", !1, function () {\n                    if (s) {\n                        n.reborn(cc.pvz.runtimeData.hasEnableBuff(804) ? 1 : 0.3);\n                        n.showBuffEffect(\"revive\", !1);\n                    } else {\n                        n.hasDie = !0;\n                        n.scene.checkIsFail();\n                        n.spine.setCompleteListener(null);\n                    }\n                });\n            }\n        }\n    },\n    reborn: function (t) {\n        // 复活\n        var e = this;\n        this.setAnimation(0, \"fuhuo\", !1, function () {\n            e.hp = e.item.maxHp * t;\n            e.item.updateHp();\n            e.hasDie = !1;\n            e.setAnimation(0, \"Idle\", !0, null);\n        });\n    },\n    showBuffEffect: function (t, e) {\n        if (void 0 === e) {\n            e = !1;\n        }\n        if (e) {\n            this.scene.addBuffPrefab\n                .addNodeTo(this.item.spine.node, cc.Vec2.ZERO)\n                .getComponent(sp.Skeleton)\n                .setAnimation(0, t, !1);\n        } else {\n            this.scene.showBuffEffect(t, this.node.position);\n        }\n    },\n    update: function (t) {\n        // 确保初始化完成\n        if (!this.isInitialized || !this.scene) {\n            if (!this.loggedNotInit) {\n                console.warn(\"[Hero Update] ID未知, 未初始化或scene不存在\");\n                this.loggedNotInit = true;\n            }\n            return;\n        }\n        if (this.scene && !this.scene.timePaused && !(this.scene.hasEnded || this.hp <= 0 || this.hasDie)) {\n            var e = t * cc.director.getScheduler().getTimeScale();\n            // 每秒只打印一次日志，避免刷屏\n            if (!this.lastLogTime) {\n                this.lastLogTime = 0;\n            }\n            var currentTime = Date.now();\n            if (currentTime - this.lastLogTime > 1000) {\n                console.log(\"[Hero Update] ID:\" + this.info.id + \", enabled:\" + this.enabled + \", 位置:\" + this.node.position + \", 敌人数:\" + (this.scene.enemys ? this.scene.enemys.length : 0) + \", isMoving:\" + this.isMoving);\n                this.lastLogTime = currentTime;\n            }\n            this.updateMovement(e);\n        }\n    },\n    updateMovement: function (t) {\n        // 检查是否有敌人存在\n        if (!this.scene.enemys || this.scene.enemys.length === 0) {\n            // 没有敌人时，返回初始位置\n            this.returnToInitialPosition(t);\n            return;\n        }\n        \n        // 寻找最近的敌人（所有英雄都移动，不区分类型）\n        var e = this.scene.chooseEnemy(this, 999999);\n        if (e && e.hp > 0) {\n            this.currentTarget = e;\n            var i = e.node.position.add(cc.v2(0, e.centerY));\n            var n = i.sub(this.node.position);\n            var o = n.lengthSqr();\n            \n            // 检查是否在攻击范围内\n            if (o <= this.atkRR) {\n                // 在攻击范围内，停止移动\n                if (this.isMoving) {\n                    this.isMoving = false;\n                    this.hasReachedAttackRange = true;\n                    console.log(\"[Hero] ID:\" + this.info.id + \" 到达攻击范围\");\n                    // 不立即切换动画，让攻击动画控制\n                }\n            } else {\n                // 不在攻击范围内，继续向敌人移动\n                if (!this.isMoving) {\n                    this.isMoving = true;\n                    this.hasReachedAttackRange = false;\n                    console.log(\"[Hero] ID:\" + this.info.id + \" 开始向敌人移动\");\n                    // 只在非攻击状态时切换为移动动画\n                    if (!this.isAttacking) {\n                        this.setAnimation(0, \"Walk\", !0, null);\n                    }\n                }\n                \n                // 计算移动方向和移动\n                var s = Math.atan2(n.y, n.x);\n                var c = cc.v2(this.moveSpeed * Math.cos(s) * t, this.moveSpeed * Math.sin(s) * t);\n                \n                // 更新位置\n                var oldPos = this.node.position.clone();\n                this.node.position = this.node.position.add(c);\n                this.node.zIndex = -this.node.y;\n                this.item.barNode.position = this.item.barNode.position.add(c);\n\n                this.updateItemSpinePosition();\n                \n                // 调试：打印移动信息（每秒一次）\n                if (!this.lastMoveLogTime) {\n                    this.lastMoveLogTime = 0;\n                }\n                var nowTime = Date.now();\n                if (nowTime - this.lastMoveLogTime > 1000) {\n                    console.log(\"[Hero Move] ID:\" + this.info.id + \", 从\" + oldPos + \" 移动到\" + this.node.position + \", 移动量:\" + c);\n                    this.lastMoveLogTime = nowTime;\n                }\n                \n                // 更新position2用于敌人的攻击判断\n                this.position2 = this.node.position.add(this.item.attOffset);\n            }\n        } else {\n            // 没有有效敌人，返回初始位置\n            this.returnToInitialPosition(t);\n        }\n    },\n    updateItemSpinePosition: function () {\n        // 将Hero节点的世界坐标转换为item.spine父节点的本地坐标\n        if (this.item && this.item.spine && this.item.spine.node) {\n            // 获取Hero节点的世界坐标\n            var heroWorldPos = this.node.parent.convertToWorldSpaceAR(this.node.position);\n            // 转换为item.spine父节点的本地坐标\n            var spineLocalPos = this.item.spine.node.parent.convertToNodeSpaceAR(heroWorldPos);\n            \n            // 调试：首次移动时打印日志\n            if (!this.loggedSpineUpdate) {\n                console.log(\"[Hero] ID:\" + this.info.id + \" 第一次同步spine位置 - Hero世界坐标:\", heroWorldPos, \"spine本地坐标:\", spineLocalPos);\n                this.loggedSpineUpdate = true;\n            }\n            \n            // 更新item.spine的位置\n            this.item.spine.node.position = spineLocalPos;\n        } else {\n            if (!this.loggedSpineError) {\n                console.error(\"[Hero] ID:\" + this.info.id + \" 无法同步spine位置！item:\", !!this.item, \"spine:\", !!(this.item && this.item.spine), \"spine.node:\", !!(this.item && this.item.spine && this.item.spine.node));\n                this.loggedSpineError = true;\n            }\n        }\n    },\n    returnToInitialPosition: function (t) {\n        var distSqr = this.node.position.sub(this.initialPosition).lengthSqr();\n        if (distSqr > 1) {\n            if (!this.isMoving) {\n                this.isMoving = true;\n                if (!this.isAttacking) {\n                    this.setAnimation(0, \"Walk\", !0, null);\n                }\n            }\n            var a = this.initialPosition.sub(this.node.position);\n            var r = Math.atan2(a.y, a.x);\n            var h = cc.v2(this.moveSpeed * Math.cos(r) * t, this.moveSpeed * Math.sin(r) * t);\n            if (h.lengthSqr() > a.lengthSqr()) {\n                this.node.position = this.initialPosition.clone();\n            } else {\n                this.node.position = this.node.position.add(h);\n            }\n            this.node.zIndex = -this.node.y;\n            \n            // 【关键】同步更新item.spine的显示位置\n            this.updateItemSpinePosition();\n            \n            this.position2 = this.node.position.add(this.item.attOffset);\n        } else {\n            if (this.isMoving) {\n                this.isMoving = false;\n                // 返回初始位置后，恢复item.spine到初始位置\n                if (this.item && this.item.spine && this.item.spine.node) {\n                    this.item.spine.node.position = this.itemSpineInitialPos.clone();\n                }\n                if (!this.isAttacking) {\n                    this.setAnimation(0, \"Idle\", !0, null);\n                }\n            }\n        }\n    },\n});"]}