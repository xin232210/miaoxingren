{"version":3,"sources":["assets/scripts/Role2.js"],"names":["$soundManager","require","$tool","$pool","$battleGround2Ctrl","$enemySpawner2","$num2","l","cc","_decorator","u","ccclass","p","property","d","e","t","apply","arguments","body","bulletSPos","bodySpine","bodySDS","collBody","team","tCount","v","par","bulletConfig","rate","nums","dmg","hp","state","hpY","isDragging","dXYRec","hpNumberHandle","__extends","prototype","init","enabled","JSONManager","ConfigBattle","initDragEvent","skeletonData","rId","setAnimation","config","node","setScale","spineSize","hpy","createNewHpNum","refreshAtk","on","Node","EventType","TOUCH_START","getLocationX","getLocationY","TOUCH_MOVE","o","a","x","TOUCH_END","TOUCH_CANCEL","createNewBullet","Math","floor","y","n","moving","endLineY","height","beHit","remove","createNewDieEff","getComponent","updateEnemyHandles","playEffect2","randomInt","changeHpTo","parent","destroyPoolItem","start","update","__decorate","sp","Skeleton","SkeletonData","BoxCollider","Component","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var $soundManager = require(\"./SoundManager\");\nvar $tool = require(\"./Tool\");\nvar $pool = require(\"./Pool\");\nvar $battleGround2Ctrl = require(\"./BattleGround2Ctrl\");\nvar $enemySpawner2 = require(\"./EnemySpawner2\");\nvar $num2 = require(\"./Num2\");\nvar l = cc._decorator;\nvar u = l.ccclass;\nvar p = l.property;\nvar d = (function (e) {\n    function t() {\n        var t = (null !== e && e.apply(this, arguments)) || this;\n        t.body = null;\n        t.bulletSPos = null;\n        t.bodySpine = null;\n        t.bodySDS = [];\n        t.collBody = null;\n        t.team = 0;\n        t.tCount = 0;\n        t.v = 50;\n        t.par = null;\n        t.bulletConfig = {\n            rate: 0,\n            nums: 0,\n            dmg: 0\n        };\n        t.hp = 100;\n        t.state = 0;\n        t.hpY = 0;\n        t.isDragging = !1;\n        t.dXYRec = [0, 0];\n        t.hpNumberHandle = null;\n        return t;\n    }\n    __extends(t, e);\n    t.prototype.init = function (e) {\n        if (void 0 === e) {\n            e = {};\n        }\n        this.team = e.team;\n        this.par = e.par;\n        if (0 === this.team) {\n            this.collBody.enabled = !1;\n            this.bulletConfig = {\n                rate: $battleGround2Ctrl.default.JSONManager.ConfigBattle[6].v[5],\n                nums: $battleGround2Ctrl.default.JSONManager.ConfigBattle[6].v[3],\n                dmg: $battleGround2Ctrl.default.JSONManager.ConfigBattle[6].v[4]\n            };\n            this.initDragEvent();\n        } else {\n            this.bodySpine.skeletonData = this.bodySDS[e.rId];\n            this.bodySpine.setAnimation(0, \"Walk\", !0);\n            this.hp = e.config.hp;\n            this.bodySpine.node.setScale(e.config.spineSize);\n            this.hpY = e.config.hpy;\n            this.v = $battleGround2Ctrl.default.JSONManager.ConfigBattle[6].v[2];\n            this.createNewHpNum();\n        }\n        this.par.refreshAtk();\n    };\n    t.prototype.initDragEvent = function () {\n        var e = this;\n        this.body.on(cc.Node.EventType.TOUCH_START, function (t) {\n            e.isDragging = !0;\n            e.dXYRec[0] = t.getLocationX();\n            e.dXYRec[1] = t.getLocationY();\n        });\n        this.body.on(cc.Node.EventType.TOUCH_MOVE, function (t) {\n            var o = t.getLocationX();\n            var a = t.getLocationY();\n            e.node.x += o - e.dXYRec[0];\n            if (e.node.x < -300) {\n                e.node.x = -300;\n            } else {\n                if (e.node.x > 300) {\n                    e.node.x = 300;\n                }\n            }\n            e.dXYRec[0] = o;\n            e.dXYRec[1] = a;\n        });\n        this.body.on(cc.Node.EventType.TOUCH_END, function () {\n            e.isDragging = !1;\n        });\n        this.body.on(cc.Node.EventType.TOUCH_CANCEL, function () {\n            e.isDragging = !1;\n        });\n    };\n    t.prototype.createNewBullet = function (e) {\n        if (10 === this.par.state && ((this.tCount += e), !(this.tCount < this.bulletConfig.rate))) {\n            this.tCount -= this.bulletConfig.rate;\n            var t = $battleGround2Ctrl.default.JSONManager.ConfigBattle[6].v[7];\n            var o = this.node.x + this.bulletSPos.x - Math.floor(this.bulletConfig.nums / 2) * t;\n            var a = this.node.y + this.bulletSPos.y;\n            for (var n = 0; n < this.bulletConfig.nums; n++) {\n                this.par.createNewBullet(o, a, {\n                    dmg: this.bulletConfig.dmg\n                });\n                o += t;\n            }\n            this.bodySpine.setAnimation(1, \"atk\", !1);\n        }\n    };\n    t.prototype.createNewHpNum = function () {\n        this.hpNumberHandle = this.par.createNewHpNum(this);\n    };\n    t.prototype.moving = function (e) {\n        if (10 === this.par.state) {\n            this.node.y -= this.v * e;\n            if (this.node.y < this.par.endLineY + this.node.height / 2) {\n                this.par.beHit();\n                this.remove();\n            }\n        }\n    };\n    t.prototype.beHit = function (e) {\n        this.hp -= e.dmg;\n        if (this.hp <= 0) {\n            this.par.createNewDieEff(this.node);\n            this.par.node.getComponent($enemySpawner2.default).updateEnemyHandles(this.node.x);\n            this.remove();\n            $soundManager.default.playEffect2($tool.default.randomInt(3, 5));\n        } else {\n            this.hpNumberHandle.getComponent($num2.default).changeHpTo();\n        }\n    };\n    t.prototype.remove = function () {\n        this.hpNumberHandle.parent.getComponent($pool.default).destroyPoolItem(this.hpNumberHandle);\n        this.node.parent.getComponent($pool.default).destroyPoolItem(this.node);\n    };\n    t.prototype.start = function () {};\n    t.prototype.update = function (e) {\n        if (0 === this.team) {\n            this.createNewBullet(e);\n        } else {\n            this.moving(e);\n        }\n    };\n    __decorate([p(cc.Node)], t.prototype, \"body\", void 0);\n    __decorate([p(cc.Node)], t.prototype, \"bulletSPos\", void 0);\n    __decorate([p(sp.Skeleton)], t.prototype, \"bodySpine\", void 0);\n    __decorate([p(sp.SkeletonData)], t.prototype, \"bodySDS\", void 0);\n    __decorate([p(cc.BoxCollider)], t.prototype, \"collBody\", void 0);\n    return __decorate([u], t);\n})(cc.Component);\nexports.default = d;\n"]}