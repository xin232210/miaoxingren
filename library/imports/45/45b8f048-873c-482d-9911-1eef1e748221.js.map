{"version":3,"sources":["assets/scripts/RewardItem.js"],"names":["cc","Class","Component","properties","iconSprite","Sprite","spine","sp","Skeleton","fragNode","Node","qualitySprite","countLabel","Label","initBoxRewardItem","e","RewardData","itemId","count","string","pvz","utils","formatItemNum","t","JsonControl","getItemJson","getItemIcon","Icon","getQualityBgIcon","Quality","onClickShopBox","popupManager","popup","ad","scale","initShopBoxToolItem","o","a","n","getToolJson","quality","i","PlayerData","getToolData","c","getLevelInterval","lv","node","useBundleAsset","SkeletonData","skeletonData","setAnimation","active","s","childrenCount","children","getComponent","setMaterial","materialList","initRewardItem","toolId","GameConfig","ItemType","onSaveReward","addPower","updateActLevelScore","updateToolFragCount","changeItemNum"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        iconSprite: cc.Sprite,\n        spine: sp.Skeleton,\n        fragNode: cc.Node,\n        qualitySprite: cc.Sprite,\n        countLabel: cc.Label\n    },\n    initBoxRewardItem: function (e) {\n        this.RewardData = e;\n        this.itemId = this.RewardData.itemId;\n        this.count = this.RewardData.count;\n        this.countLabel.string = \"x\" + cc.pvz.utils.formatItemNum(this.count);\n        var t = cc.JsonControl.getItemJson(this.itemId);\n        cc.JsonControl.getItemIcon(this.iconSprite, t.Icon);\n        cc.JsonControl.getQualityBgIcon(this.qualitySprite, t.Quality);\n    },\n    onClickShopBox: function () {\n        if (this.itemId >= 5 && this.itemId <= 7) {\n            cc.popupManager.popup(\n                \"mainUI\",\n                \"shopboxList\",\n                \"UIShopBoxDetail\",\n                {\n                    ad: !1,\n                    scale: !0\n                },\n                this.itemId\n            );\n        }\n    },\n    initShopBoxToolItem: function (e, t) {\n        var o = this;\n        var a = e;\n        var n = cc.JsonControl.getToolJson(a);\n        cc.JsonControl.getQualityBgIcon(this.qualitySprite, n.quality);\n        var i = cc.pvz.PlayerData.getToolData(a);\n        var c = cc.pvz.utils.getLevelInterval(i.lv);\n        this.spine.node.scale = n.scale;\n        cc.pvz.utils.useBundleAsset(\"actors\", \"character/Characters\", sp.SkeletonData, function (e) {\n            o.spine.skeletonData = e;\n            o.spine.setAnimation(0, \"Idle\", !0);\n        });\n        this.fragNode.active = t;\n        if (t) {\n            for (var s = 0; s < this.node.childrenCount; s++) {\n                this.node.children[s].getComponent(cc.Sprite).setMaterial(0, cc.JsonControl.materialList[t ? 1 : 0]);\n            }\n        }\n    },\n    initRewardItem: function (e, t) {\n        var o = this;\n        if (void 0 === t) {\n            t = !0;\n        }\n        this.RewardData = e;\n        this.itemId = this.RewardData.itemId;\n        this.count = this.RewardData.count;\n        this.toolId = this.RewardData.toolId;\n        this.countLabel.string = \"x\" + this.count;\n        var a = cc.JsonControl.getItemJson(this.itemId);\n        if (this.spine) {\n            this.spine.node.active = this.itemId == cc.pvz.GameConfig.ItemType[\"固定碎片\"];\n        }\n        if (this.iconSprite) {\n            this.iconSprite.node.active = this.itemId != cc.pvz.GameConfig.ItemType[\"固定碎片\"];\n        }\n        if (this.itemId === cc.pvz.GameConfig.ItemType[\"固定碎片\"]) {\n            if (this.fragNode) {\n                this.fragNode.active = !0;\n            }\n            var n = cc.JsonControl.getToolJson(this.toolId);\n            cc.JsonControl.getQualityBgIcon(this.qualitySprite, n.quality);\n            var i = cc.pvz.PlayerData.getToolData(this.toolId);\n            var c = cc.pvz.utils.getLevelInterval(i.lv);\n            this.spine.node.scale = n.scale;\n            cc.pvz.utils.useBundleAsset(\"actors\", \"character/Characters\", this.toolId, sp.SkeletonData, function (e) {\n                o.spine.skeletonData = e;\n                o.spine.setAnimation(0, \"Idle\", !0);\n            });\n        } else {\n            cc.JsonControl.getItemIcon(this.iconSprite, a.Icon);\n            cc.JsonControl.getQualityBgIcon(this.qualitySprite, a.Quality);\n            this.fragNode && (this.fragNode.active = !1);\n        }\n        if (t) {\n            this.onSaveReward();\n        }\n    },\n    onSaveReward: function () {\n        switch (this.itemId) {\n            case cc.pvz.GameConfig.ItemType[\"体力\"]:\n                cc.pvz.PlayerData.addPower(this.count, !0);\n                break;\n            case cc.pvz.GameConfig.ItemType[\"荣誉\"]:\n                cc.pvz.PlayerData.updateActLevelScore(this.count);\n                break;\n            case cc.pvz.GameConfig.ItemType[\"固定碎片\"]:\n                cc.pvz.PlayerData.updateToolFragCount(this.toolId, this.count);\n                break;\n            default:\n                cc.pvz.PlayerData.changeItemNum(this.itemId, this.count);\n        }\n    }\n});"]}