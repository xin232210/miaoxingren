{"version":3,"sources":["assets/game/scripts/Item.js"],"names":["i","cc","Class","Component","properties","xys","Vec2","offset","id","id0Type","lv","lvSp","Sprite","bgSp","hasAd","adAni","adSupOffset","spine","sp","Skeleton","righMargin","barPos","v2","attOffset","onLoad","enabled","setSelfListenEvent","t","node","on","Node","EventType","TOUCH_START","onClickBegan","TOUCH_MOVE","onClickMoved","TOUCH_END","onClickEnded","TOUCH_CANCEL","off","updateLvBlocks","pvz","utils","setSpriteFrame","json","lattice2","cantDrag","defaultAnimation","setAnimation","lvup","checkToUpdateMaxHp","showLvupEffect","convertToWorldSpaceAR","ZERO","itemRoot","scene","hub","initBy","e","n","heroJsonFile","near6","forEach","put","myBlocks","o","position","add","zIndex","y","canUse","setBgSpParent","hero","angerEff","lineIKBones","getMaxLv","PlayerData","getToolData","showUnderBuffEffect","buffNode","active","buffEffect","addNodeTo","hideUnderBuffEffect","updateLv5Effect","hideLv5Effect","lv5FlagNode","setCanDrag","opacity","updatePreviewByPos","blockRoot","testBlock","testItem","lockByAd","getComponent","find","unlockAd","isValid","TAUtils","track","message","stack","pickupFromBoard","hasMoved","clickWPos","removeFromBlock","getLocation","pickup","initSameIDLvLine","parent","convertToNodeSpaceAR","updateLineIKBones","pick","length","undoTryPlace","Set","item","s","size","c","values","next","value","every","resetBlocksPreview","putdown","tryPlace","a","blockItemsRootNode","resetPosesPreview","runtimeData","guide","startGuide6","childrenCount","startGuide2","updateMoveFinger","startGuide4","hideMoveFinger","startGuide8","r","sub","Math","abs","x","popupManager","popup","scale","hideLines","layoutChildren","getSwitchAd","AdUtils","showAdRewardVideo","GameConfig","AdType","saveRuntimeData","onItemChanged","initHeroNodes","mul","barNode","barPrefab","addNode","hpBar","ProgressBar","cdBar","shieldBar","progress","lv1","cdMs","cd","reloadMs","Array","isArray","bulletcd","near10","hasEnableBuff","inCoolDown","bulletCount","startReloadTimer","onReloadReady","startHeroLogic","showGame1st","crossItems","self","getCrossItems","push","reloadT1","reloadT2","bullet","onCDReady","stopHeroLogic","hp","reborn","showBuffEffect","maxHp","characterSpine","console","log","spineActive","removeFromParent","spineInitialPos","clone","characterSpineInitialPos","itemSpineInitialPos","error","heroNode","destroy","checkToStartReloadTimer","checkBuff","time","startAngerMode","timeScale","accBuffPrefab","stopAngerMode","update","timePaused","hasEnded","hasDie","isAngerPressed","tryShoot","playSound","setTimeout","bind","getMaxHp","attribute1","fightlvup1","getBuffValue","updateMaxHp","updateHp","updateShield","linePrefab","findBone","IKBone","wPos","children","boardItemBgsRoot"],"mappings":"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","sourceRoot":"/","sourcesContent":["var i = [\"bai_\", \"lv_\", \"lan_\", \"zi_\", \"cheng_\"];\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        xys: [cc.Vec2],\n        offset: cc.Vec2,\n        id: 1,\n        id0Type: 0,\n        lv: 0,\n        lvSp: cc.Sprite,\n        bgSp: cc.Sprite,\n        hasAd: !1,\n        adAni: \"\",\n        adSupOffset: cc.Vec2,\n        spine: sp.Skeleton,\n        righMargin: 53,\n        barPos: {\n            default: cc.v2(0, 120)\n        },\n        attOffset: cc.Vec2\n    },\n    onLoad: function () {\n        this.enabled = !1;\n    },\n    setSelfListenEvent: function (t) {\n        if (t) {\n            this.node.on(cc.Node.EventType.TOUCH_START, this.onClickBegan, this);\n            this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onClickMoved, this);\n            this.node.on(cc.Node.EventType.TOUCH_END, this.onClickEnded, this);\n            this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onClickEnded, this);\n        } else {\n            this.node.off(cc.Node.EventType.TOUCH_START, this.onClickBegan, this);\n            this.node.off(cc.Node.EventType.TOUCH_MOVE, this.onClickMoved, this);\n            this.node.off(cc.Node.EventType.TOUCH_END, this.onClickEnded, this);\n            this.node.off(cc.Node.EventType.TOUCH_CANCEL, this.onClickEnded, this);\n        }\n    },\n    updateLvBlocks: function () {\n        if (this.bgSp) {\n            cc.pvz.utils.setSpriteFrame(this.bgSp, \"uiImage\", \"gezi/\" + i[this.lv] + this.json.lattice2);\n        }\n        if (this.lvSp) {\n            cc.pvz.utils.setSpriteFrame(this.lvSp, \"uiImage\", \"item/\" + (this.lv + 1));\n        }\n        if (this.spine) {\n            var t = this.cantDrag ? (\"black_\" + (this.lv + 1)) : \"Idle\";\n            this.spine.defaultAnimation = t;\n            this.spine.setAnimation(0, t, !0);\n        }\n    },\n    lvup: function (t) {\n        if (void 0 === t) {\n            t = !0;\n        }\n        this.lv++;\n        this.updateLvBlocks();\n        this.checkToUpdateMaxHp();\n        if (t) {\n            this.showLvupEffect();\n        }\n    },\n    showLvupEffect: function () {\n        var t = this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);\n        this.itemRoot.scene.hub.showLvupEffect(t);\n    },\n    initBy: function (t, e, i) {\n        var n = this;\n        this.itemRoot = t;\n        this.json = this.itemRoot.scene.heroJsonFile.json[this.id - 1];\n        this.near6 = !1;\n        this.lv = e;\n        this.updateLvBlocks();\n        if (i) {\n            i.forEach(function (t) {\n                t.put(n);\n            });\n            this.myBlocks = i;\n            var o = i[0].node.position.add(this.offset);\n            this.node.position = o;\n            this.node.zIndex = -(o.y + this.spine.node.y);\n            this.canUse = !0;\n        } else {\n            this.myBlocks = [];\n            this.canUse = !this.hasAd;\n            this.setSelfListenEvent(!0);\n            this.setBgSpParent(!0);\n        }\n        this.hero = null;\n        this.angerEff = null;\n        this.lineIKBones = [];\n    },\n    getMaxLv: function () {\n        if (cc.pvz.PlayerData.getToolData(this.id).lv >= 5) {\n            return 4;\n        } else {\n            return 3;\n        }\n    },\n    showUnderBuffEffect: function () {\n        if (this.buffNode) {\n            this.buffNode.active = !0;\n        } else {\n            var t = this.itemRoot.buffEffect.addNodeTo(this.node, this.spine.position);\n            this.buffNode = t;\n        }\n    },\n    hideUnderBuffEffect: function () {\n        if (this.buffNode) {\n            this.buffNode.active = !1;\n        }\n    },\n    updateLv5Effect: function () {\n        this.lv;\n    },\n    hideLv5Effect: function () {\n        if (this.lv5FlagNode) {\n            this.lv5FlagNode.active = !1;\n        }\n    },\n    setCanDrag: function (t) {\n        if (this.spine) {\n            this.spine.setAnimation(0, t ? \"Idle\" : (\"black_\" + (this.lv + 1)), !0);\n        } else {\n            if (t) {\n                this.node.opacity = 255;\n            } else {\n                this.node.opacity = 100;\n            }\n        }\n        this.cantDrag = !t;\n    },\n    updatePreviewByPos: function (t, e) {\n        if (0 == this.id) {\n            return this.itemRoot.blockRoot.testBlock(this, t, e);\n        } else {\n            return this.itemRoot.blockRoot.testItem(this, t, e);\n        }\n    },\n    lockByAd: function (t) {\n        var e = t.addNodeTo(this.node);\n        e.getComponent(sp.Skeleton).setAnimation(0, this.adAni, !0);\n        cc.find(\"ad\", e).position = this.adSupOffset;\n        this.hasAd = !0;\n        this.canUse = !1;\n    },\n    unlockAd: function () {\n        if (this.isValid) {\n            var t = cc.find(\"ad\", this.node);\n            if (t) {\n                t.active = !1;\n                this.canUse = !0;\n            } else {\n                cc.pvz.TAUtils.track(\"error\", {\n                    message: \"unlockAd\",\n                    stack: \"noAdNode, id:\" + this.id + \",lv:\" + this.lv\n                });\n            }\n        }\n    },\n    pickupFromBoard: function (t) {\n        if (this.cantDrag) {\n            //\n        } else {\n            this.hasMoved = !1;\n            this.clickWPos = t;\n            this.removeFromBlock();\n            this.itemRoot.pickupFromBoard(this, t);\n            this.updatePreviewByPos(t);\n        }\n    },\n    onClickBegan: function (t) {\n        if (!this.cantDrag) {\n            var e = t.getLocation();\n            this.hasMoved = !1;\n            this.clickWPos = e;\n            this.itemRoot.pickup(this, e);\n            this.updatePreviewByPos(e);\n            this.initSameIDLvLine();\n        }\n    },\n    onClickMoved: function (t) {\n        if (this.cantDrag) {\n            //\n        } else {\n            this.hasMoved = !0;\n            this.node.position = this.node.parent.convertToNodeSpaceAR(t.getLocation());\n            this.updatePreviewByPos(t.getLocation());\n            this.updateLineIKBones();\n        }\n    },\n    removeFromBlock: function () {\n        this.myBlocks.forEach(function (t) {\n            return t.pick();\n        });\n        this.myBlocks.length = 0;\n        if (0 == this.id) {\n            this.itemRoot.blockRoot.undoTryPlace(this);\n        } else {\n            this.hideUnderBuffEffect();\n        }\n        this.checkToUpdateMaxHp();\n    },\n    onClickEnded: function (t) {\n        var e = this;\n        if (!this.cantDrag) {\n            if (this.canUse) {\n                var i = [];\n                if (this.updatePreviewByPos(t.getLocation(), i)) {\n                    var n = i[0].node.position.add(this.offset);\n                    var o = new Set();\n                    i.forEach(function (t) {\n                        if (t.item) {\n                            o.add(t.item);\n                        }\n                    });\n                    var s = !1;\n                    if (0 != this.id && this.lv < this.getMaxLv() && 1 == o.size) {\n                        var c = o.values().next().value;\n                        if (\n                            c.id == this.id &&\n                            c.lv == this.lv &&\n                            i.every(function (t) {\n                                return t.item == c;\n                            })\n                        ) {\n                            s = !0;\n                            c.lvup();\n                            this.setBgSpParent(!0);\n                            this.node.parent = null;\n                            this.itemRoot.blockRoot.resetBlocksPreview();\n                        }\n                    }\n                    if (!s) {\n                        o.forEach(function (t) {\n                            if (t != e) {\n                                t.hideLv5Effect();\n                                t.removeFromBlock();\n                                t.itemRoot.putdown(t, t.node.convertToWorldSpaceAR(cc.Vec2.ZERO));\n                            }\n                        });\n                        i.forEach(function (t) {\n                            t.put(e);\n                        });\n                        this.myBlocks = i;\n                        if (0 == this.id) {\n                            this.itemRoot.blockRoot.tryPlace(this);\n                            var a = this.itemRoot.blockItemsRootNode.convertToWorldSpaceAR(n);\n                            this.node.position = this.node.parent.convertToNodeSpaceAR(a);\n                        } else {\n                            if (-1 == i[0].i) {\n                                this.node.parent = i[0].node;\n                                this.node.position = cc.Vec2.ZERO;\n                            } else {\n                                this.node.parent = this.itemRoot.blockItemsRootNode;\n                                this.node.position = n;\n                                this.node.zIndex = -(n.y + this.spine.node.y);\n                            }\n                        }\n                        this.setSelfListenEvent(!1);\n                        this.checkToUpdateMaxHp();\n                        if (0 == this.id) {\n                            this.itemRoot.blockRoot.resetPosesPreview();\n                            6 == cc.pvz.runtimeData.guide && this.itemRoot.scene.startGuide6();\n                        } else {\n                            this.itemRoot.blockRoot.resetBlocksPreview();\n                        }\n                    }\n                    if (1 == cc.pvz.runtimeData.guide) {\n                        if (0 == this.itemRoot.node.childrenCount) {\n                            this.itemRoot.scene.startGuide2();\n                        } else {\n                            this.itemRoot.scene.updateMoveFinger();\n                        }\n                    }\n                    if (3 == cc.pvz.runtimeData.guide) {\n                        if (0 == this.itemRoot.node.childrenCount) {\n                            this.itemRoot.scene.startGuide4();\n                        } else {\n                            this.itemRoot.scene.updateMoveFinger();\n                        }\n                    }\n                    if (6 == cc.pvz.runtimeData.guide) {\n                        if (0 == this.id) {\n                            this.itemRoot.scene.hideMoveFinger();\n                        } else {\n                            this.itemRoot.scene.updateMoveFinger();\n                        }\n                    }\n                    if (7 == cc.pvz.runtimeData.guide) {\n                        if (0 == this.itemRoot.node.childrenCount) {\n                            this.itemRoot.scene.startGuide8();\n                        } else {\n                            this.itemRoot.scene.updateMoveFinger();\n                        }\n                    }\n                } else {\n                    this.hideLv5Effect();\n                    this.removeFromBlock();\n                    this.itemRoot.putdown(this, t.getLocation());\n                    if (0 == this.id) {\n                        this.itemRoot.blockRoot.resetPosesPreview();\n                    } else {\n                        this.itemRoot.blockRoot.resetBlocksPreview();\n                    }\n                    1 == cc.pvz.runtimeData.guide && this.itemRoot.scene.updateMoveFinger();\n                    3 == cc.pvz.runtimeData.guide && this.itemRoot.scene.updateMoveFinger();\n                    6 == cc.pvz.runtimeData.guide && this.itemRoot.scene.updateMoveFinger();\n                    7 == cc.pvz.runtimeData.guide && this.itemRoot.scene.updateMoveFinger();\n                }\n                if (0 != this.id) {\n                    var r = t.getLocation().sub(this.clickWPos);\n                    if (Math.abs(r.x) < 16 && Math.abs(r.y) < 16) {\n                        cc.popupManager.popup(\n                            \"game\",\n                            \"plantInfo2\",\n                            \"UIGameToolInfo\",\n                            {\n                                scale: !1\n                            },\n                            this.id,\n                            this.lv\n                        );\n                    }\n                }\n                this.hideLines();\n                this.itemRoot.layoutChildren();\n            } else {\n                if (cc.pvz.TAUtils.getSwitchAd()) {\n                    this.hideLines();\n                    cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType[\"广告格子\"], function (i) {\n                        if (i) {\n                            e.unlockAd();\n                            e.onClickEnded(t);\n                            e.itemRoot.scene.saveRuntimeData();\n                        } else {\n                            e.removeFromBlock();\n                            e.itemRoot.putdown(e, t.getLocation());\n                            if (0 == e.id) {\n                                e.itemRoot.blockRoot.resetPosesPreview();\n                            } else {\n                                e.itemRoot.blockRoot.resetBlocksPreview();\n                            }\n                        }\n                    });\n                } else {\n                    cc.popupManager.popup(\n                        \"game\",\n                        \"bagbuyUI\",\n                        \"UIBuyBlock\",\n                        {\n                            scale: !1\n                        },\n                        this\n                    );\n                }\n            }\n        }\n    },\n    checkToUpdateMaxHp: function () {\n        this.itemRoot.scene.onItemChanged();\n    },\n    initHeroNodes: function () {\n        var t = this.hero.node.position.add(this.barPos.mul(0.82));\n        if (this.barNode) {\n            //\n        } else {\n            this.barNode = this.barPrefab.addNode(t);\n            this.hpBar = cc.find(\"hp\", this.barNode).getComponent(cc.ProgressBar);\n            this.cdBar = cc.find(\"cd\", this.barNode).getComponent(cc.ProgressBar);\n            this.shieldBar = cc.find(\"dun\", this.barNode).getComponent(cc.ProgressBar);\n        }\n        this.barNode.active = !0;\n        this.barNode.position = t;\n        this.hpBar.progress = 1;\n        this.shieldBar.progress = 0;\n        this.angerEff = null;\n        this.lv1 = cc.pvz.PlayerData.getToolData(this.id).lv - 1;\n        this.cdMs = 1e3 * this.json.cd;\n        this.reloadMs = 1e3 * (Array.isArray(this.json.bulletcd) ? this.json.bulletcd[this.lv1] : this.json.bulletcd);\n        if (this.near10 && cc.pvz.runtimeData.hasEnableBuff(1004)) {\n            this.cdMs *= 0.8;\n        }\n        this.hpBar.progress = 1;\n        this.shieldBar.progress = 0;\n        this.enabled = !0;\n        if (3 == this.id || 6 == this.id || 8 == this.id || 10 == this.id) {\n            this.inCoolDown = !0;\n            this.bulletCount = 0;\n            this.cdBar.progress = 0;\n            this.startReloadTimer();\n        } else {\n            this.onReloadReady();\n        }\n    },\n    startHeroLogic: function (t, e) {\n        this.barPrefab = t;\n        this.scene = e;\n        \n        // 隐藏格子和等级显示（非新手引导状态）\n        if (!cc.pvz.runtimeData.showGame1st) {\n            if (this.bgSp && this.bgSp.node) {\n                this.bgSp.node.active = false;\n            }\n            if (this.lvSp && this.lvSp.node) {\n                this.lvSp.node.active = false;\n            }\n        }\n        \n        if (6 == this.id) {\n            var n = this.myBlocks[0].i;\n            this.crossItems = [];\n            var self = this;\n            this.itemRoot.blockRoot.getCrossItems(this.id, n, function (t) {\n                self.crossItems.push(t);\n            });\n        }\n    },\n    onReloadReady: function () {\n        this.inCoolDown = !1;\n        this.cdBar.progress = 1;\n        this.reloadT1 = -1;\n        this.reloadT2 = -1;\n        this.bulletCount = this.json.bullet;\n        if (2 == this.id && cc.pvz.runtimeData.hasEnableBuff(203)) {\n            this.bulletCount += this.json.bullet / 2;\n        }\n    },\n    onCDReady: function () {\n        this.inCoolDown = !1;\n    },\n    stopHeroLogic: function () {\n        if (this.barNode) {\n            this.barNode.parent = null;\n            this.barNode = null;\n        }\n        this.enabled = !1;\n        \n        // 恢复格子和等级显示（非新手引导状态）\n        if (!cc.pvz.runtimeData.showGame1st) {\n            if (this.bgSp && this.bgSp.node) {\n                this.bgSp.node.active = true;\n            }\n            if (this.lvSp && this.lvSp.node) {\n                this.lvSp.node.active = true;\n            }\n        }\n        \n        if (this.hero.hp <= 0) {\n            this.hero.reborn();\n            this.hero.showBuffEffect(\"revive\", !0);\n        } else {\n            if (this.hero.hp < this.maxHp) {\n                this.hero.showBuffEffect(\"HP\", !0);\n            }\n        }\n        this.hero.setAnimation(0, \"Idle\", !0, null);\n        \n        // 【关键修复】在销毁Hero之前，将spine节点移回到Item节点下\n        // 使用更安全的方式，不依赖可能已经失效的节点\n        if (this.hero.characterSpine && this.hero.characterSpine.node && this.node && this.node.isValid) {\n            try {\n                console.log(\"[Item stopHeroLogic] 将spine移回Item节点，ID:\" + this.id);\n                \n                // 保存spine当前的active状态\n                var spineActive = this.hero.characterSpine.node.active;\n                \n                // 直接将spine移回Item节点，使用原始位置（如果有保存的话）\n                this.hero.characterSpine.node.removeFromParent(false);\n                this.hero.characterSpine.node.parent = this.node;\n                \n                // 恢复到保存在Item上的spine初始位置\n                if (this.spineInitialPos) {\n                    this.hero.characterSpine.node.position = this.spineInitialPos.clone();\n                    console.log(\"[Item stopHeroLogic] 恢复spine到初始位置 - ID:\" + this.id + \", x:\" + this.spineInitialPos.x + \", y:\" + this.spineInitialPos.y);\n                } else if (this.hero.characterSpineInitialPos) {\n                    // 回退方案1：使用Hero保存的character spine初始位置\n                    this.hero.characterSpine.node.position = this.hero.characterSpineInitialPos.clone();\n                    console.log(\"[Item stopHeroLogic] 使用Hero保存的character spine初始位置:\", this.hero.characterSpineInitialPos);\n                } else if (this.hero.itemSpineInitialPos) {\n                    // 回退方案2：使用plant spine的初始位置\n                    this.hero.characterSpine.node.position = this.hero.itemSpineInitialPos.clone();\n                    console.log(\"[Item stopHeroLogic] 使用plant spine初始位置:\", this.hero.itemSpineInitialPos);\n                } else {\n                    // 最后回退：使用(0,0)\n                    this.hero.characterSpine.node.position = cc.Vec2.ZERO;\n                    console.log(\"[Item stopHeroLogic] spine位置设为(0,0)\");\n                }\n                \n                // 确保spine可见\n                this.hero.characterSpine.node.active = true;\n                console.log(\"[Item stopHeroLogic] spine移回完成，ID:\" + this.id);\n            } catch (e) {\n                console.error(\"[Item stopHeroLogic] 移动spine失败，ID:\" + this.id + \", 错误:\", e);\n            }\n        } else {\n            console.log(\"[Item stopHeroLogic] 无法移动spine，ID:\" + this.id + \n                        \", characterSpine:\" + !!this.hero.characterSpine + \n                        \", spine.node:\" + !!(this.hero.characterSpine && this.hero.characterSpine.node) +\n                        \", Item.node有效:\" + !!(this.node && this.node.isValid));\n        }\n        \n        // 保存Hero节点引用\n        var heroNode = this.hero.node;\n        \n        // 销毁Hero组件\n        this.hero.destroy();\n        this.hero = null;\n        \n        // 【关键修复】销毁Hero节点\n        if (heroNode && heroNode.isValid) {\n            console.log(\"[Item stopHeroLogic] 销毁Hero节点，ID:\" + this.id);\n            heroNode.destroy();\n        }\n    },\n    checkToStartReloadTimer: function () {\n        if (this.bulletCount <= 0) {\n            this.startReloadTimer();\n        }\n    },\n    startReloadTimer: function () {\n        var t = this.reloadMs;\n        if (this.checkBuff(202)) {\n            t /= 2;\n        }\n        if (this.checkBuff(301)) {\n            t *= 0.8;\n        }\n        if (this.checkBuff(603)) {\n            t *= 0.8;\n        }\n        if (this.checkBuff(801)) {\n            t *= 0.8;\n        }\n        if (this.checkBuff(1003)) {\n            t *= 0.8;\n        }\n        if (this.checkBuff(703)) {\n            t *= 0.7;\n        }\n        if (this.checkBuff(902)) {\n            t *= 0.8;\n        }\n        if (this.checkBuff(1103)) {\n            t *= 0.8;\n        }\n        if (this.checkBuff(1202)) {\n            t *= 0.8;\n        }\n        this.reloadT1 = cc.pvz.time;\n        this.reloadT2 = cc.pvz.time + t;\n    },\n    startAngerMode: function () {\n        this.spine.timeScale = 2;\n        if (-1 != this.reloadT1) {\n            var t = cc.pvz.time - this.reloadT1;\n            this.reloadT1 += t / 2;\n            this.reloadT2 += t / 2;\n        }\n        if (this.hero.hp > 0) {\n            if (this.angerEff) {\n                this.angerEff.node.position = this.hero.node.position;\n                this.angerEff.node.active = !0;\n            } else {\n                var e = this.scene.accBuffPrefab.addNode(this.hero.node.position);\n                this.angerEff = e.getComponent(sp.Skeleton);\n                this.angerEff.setAnimation(0, \"accelerate\", !0);\n            }\n        }\n    },\n    stopAngerMode: function () {\n        this.spine.timeScale = 1;\n        if (-1 != this.reloadT1) {\n            var t = cc.pvz.time - this.reloadT1;\n            this.reloadT1 -= t;\n            this.reloadT2 -= t;\n        }\n        if (this.angerEff) {\n            this.angerEff.node.active = !1;\n        }\n    },\n    update: function () {\n        if (\n            this.hero &&\n            this.hero.scene &&\n            !this.hero.scene.timePaused &&\n            !this.hero.scene.hasEnded &&\n            !(this.hasDie || this.hero.hp <= 0)\n        ) {\n            var t = this.hero.scene.isAngerPressed;\n            if (this.inCoolDown) {\n                if (-1 != this.reloadT1) {\n                    var e = cc.pvz.time - this.reloadT1;\n                    if (t) {\n                        e *= 2;\n                    }\n                    if (this.reloadT1 + e >= this.reloadT2) {\n                        this.onReloadReady();\n                    } else {\n                        this.cdBar.progress = e / (this.reloadT2 - this.reloadT1);\n                    }\n                }\n            } else if (\n                this.hero.tryShoot({\n                    lv: this.lv\n                }) &&\n                (this.hero.playSound(),\n                (this.inCoolDown = !0),\n                (t && 1 != this.json.bullet) ||\n                    (this.bulletCount--, (this.cdBar.progress = this.bulletCount / this.json.bullet)),\n                this.bulletCount > 0)\n            ) {\n                var i;\n                if (t) {\n                    i = this.cdMs / 2;\n                } else {\n                    i = this.cdMs;\n                }\n                this.scene.setTimeout(this.onCDReady.bind(this), i);\n            }\n        }\n    },\n    getMaxHp: function () {\n        var t = cc.pvz.PlayerData.getToolData(this.id).lv;\n        var e = this.json.attribute1[t - 1];\n        if (this.lv > 0) {\n            e *= this.json.fightlvup1[this.lv - 1] / 100;\n        }\n        e *= 1 + 0.01 * cc.pvz.runtimeData.getBuffValue(1);\n        if (this.near6 && cc.pvz.runtimeData.hasEnableBuff(604)) {\n            e *= 1.1;\n        }\n        if (this.checkBuff(402)) {\n            e *= 1.3;\n        }\n        return e;\n    },\n    updateMaxHp: function () {\n        var t = this.getMaxHp();\n        var e = t - this.maxHp;\n        this.maxHp = t;\n        if (this.hero) {\n            this.hero.hp += e;\n        }\n    },\n    updateHp: function (t) {\n        this.hpBar.progress = t;\n    },\n    updateShield: function (t) {\n        this.shieldBar.progress = t;\n        this.scene.updateShield();\n    },\n    checkBuff: function (t) {\n        var e = (t - (t % 100)) / 100;\n        return this.id == e && cc.pvz.runtimeData.hasEnableBuff(t);\n    },\n    initSameIDLvLine: function () {\n        var t = this;\n        this.setBgSpParent(!0);\n        if (0 != this.id && this.lv < this.getMaxLv()) {\n            var e = function (e) {\n                var i = e.getComponent(\"Item\");\n                if (i && i != t && i.id == t.id && i.lv == t.lv) {\n                    var n = t.itemRoot.linePrefab\n                        .addNodeTo(t.node, t.spine.node.position.add(cc.v2(0, 45)))\n                        .getComponent(sp.Skeleton);\n                    var o = n.findBone(\"IK\");\n                    var s = i.spine.node.convertToWorldSpaceAR(cc.v2(0, 45));\n                    t.lineIKBones.push({\n                        spine: n,\n                        IKBone: o,\n                        wPos: s\n                    });\n                }\n            };\n            this.lineIKBones.length = 0;\n            this.itemRoot.blockItemsRootNode.children.forEach(function (t) {\n                return e(t);\n            });\n            this.itemRoot.node.children.forEach(function (t) {\n                return e(t);\n            });\n            this.updateLineIKBones();\n        }\n    },\n    updateLineIKBones: function () {\n        if (0 != this.id) {\n            this.lineIKBones.forEach(function (t) {\n                var e = t.spine.node.convertToNodeSpaceAR(t.wPos);\n                t.IKBone.x = e.x;\n                t.IKBone.y = e.y;\n            });\n        }\n    },\n    hideLines: function () {\n        this.setBgSpParent(!(this.myBlocks.length > 0));\n        if (0 != this.id) {\n            this.lineIKBones.forEach(function (t) {\n                t.spine.node.parent = null;\n            });\n            this.lineIKBones.length = 0;\n        }\n    },\n    setBgSpParent: function (t) {\n        if (this.bgSp) {\n            if (t) {\n                if (this.bgSp.node.parent != this.node) {\n                    this.bgSp.node.zIndex = -1;\n                    this.bgSp.node.position = cc.Vec2.ZERO;\n                    this.bgSp.node.parent = this.node;\n                }\n            } else if (this.node.parent && this.bgSp.node.parent == this.node) {\n                var e = this.bgSp.node.convertToWorldSpaceAR(cc.Vec2.ZERO);\n                this.bgSp.node.parent = this.itemRoot.blockRoot.boardItemBgsRoot;\n                this.bgSp.node.position = this.bgSp.node.parent.convertToNodeSpaceAR(e);\n            }\n        }\n    }\n});"]}