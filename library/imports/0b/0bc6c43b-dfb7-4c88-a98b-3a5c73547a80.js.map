{"version":3,"sources":["assets/mainUI/scripts/UISign.js"],"names":["cc","Class","Component","properties","signJsonFile","JsonAsset","baseSignItem","Node","sevenSignItem","signPanel","signBtnPanel","finishBtn","initBy","UISign","signJson","json","isLookAd","pvz","PlayerData","checkAndResetSign","SignData","getSignData","refreshSignBtn","initUIInfo","e","signItemList","getComponent","t","i","instantiate","parent","children","push","o","signDay","a","useSignDay","c","s","find","ID","initSignItem","isRewardSign","isReward","active","onSignLogic","finishSignReward","onGetSignReward","onClickSign","UIRoot","showToast","onClickSignAd","AdUtils","showAdRewardVideo","GameConfig","AdType","onAdClose","onClickEndSign","popupManager","onCloseUI","removePopup"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        signJsonFile: cc.JsonAsset,\n        baseSignItem: cc.Node,\n        sevenSignItem: cc.Node,\n        signPanel: cc.Node,\n        signBtnPanel: cc.Node,\n        finishBtn: cc.Node\n    },\n    initBy: function () {\n        cc.UISign = this;\n        this.signJson = this.signJsonFile.json;\n        this.isLookAd = !1;\n        cc.pvz.PlayerData.checkAndResetSign();\n        this.SignData = cc.pvz.PlayerData.getSignData();\n        this.refreshSignBtn();\n        this.initUIInfo();\n    },\n    initUIInfo: function () {\n        var e = this;\n        this.signItemList = [this.baseSignItem.getComponent(\"SignItem\")];\n        for (var t = 0; t < 5; t++) {\n            var i = cc.instantiate(this.baseSignItem);\n            i.parent = this.signPanel.children[t + 1];\n            this.signItemList.push(i.getComponent(\"SignItem\"));\n        }\n        this.signItemList.push(this.sevenSignItem.getComponent(\"SignItem\"));\n        var o = this.SignData.signDay;\n        var a = o % 7;\n        if (0 == a) {\n            this.useSignDay = 7;\n        } else {\n            this.useSignDay = a;\n        }\n        var c = function () {\n            var t = s + 1;\n            var i;\n            if (o <= 7) {\n                i = t;\n            } else {\n                i = 100 + t;\n            }\n            var a = e.signJson.find(function (e) {\n                return e.ID == i;\n            });\n            e.signItemList[s].initSignItem(t, a, e.useSignDay);\n        };\n        for (var s = 0; s < 7; s++) {\n            c();\n        }\n    },\n    refreshSignBtn: function () {\n        this.isRewardSign = this.SignData.isReward;\n        this.signBtnPanel.active = !this.isRewardSign;\n        this.finishBtn.active = this.isRewardSign;\n    },\n    onSignLogic: function (e) {\n        if (void 0 === e) {\n            e = !1;\n        }\n        cc.pvz.PlayerData.finishSignReward();\n        this.signItemList[this.useSignDay - 1].onGetSignReward(e);\n        this.refreshSignBtn();\n    },\n    onClickSign: function () {\n        if (this.isLookAd) {\n            //\n        } else {\n            if (this.isRewardSign) {\n                cc.UIRoot.showToast(\"今日已签到\");\n            } else {\n                this.onSignLogic(!1);\n            }\n        }\n    },\n    onClickSignAd: function () {\n        var e = this;\n        if (this.isLookAd) {\n            //\n        } else {\n            if (this.isRewardSign) {\n                cc.UIRoot.showToast(\"今日已签到\");\n            } else {\n                (this.isLookAd = !0),\n                    cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType[\"双倍签到\"], function (t) {\n                        e.onAdClose(t);\n                    });\n            }\n        }\n    },\n    onAdClose: function (e) {\n        this.isLookAd = !1;\n        if (e) {\n            this.onSignLogic(!0);\n        }\n    },\n    onClickEndSign: function () {\n        cc.popupManager.showToast(\"今日已签到\");\n    },\n    onCloseUI: function () {\n        if (this.isLookAd) {\n            //\n        } else {\n            cc.popupManager.removePopup(this);\n        }\n    }\n});\n"]}