{"version":3,"sources":["assets/mainUI/scripts/ToolCard.js"],"names":["cc","Class","Component","properties","spine","sp","Skeleton","qualitySprite","Sprite","typeSprite","nameLabel","Label","levelLabel","fragLabel","lvProgressBar","ProgressBar","maxFragLine","Node","lvTipNode","fragTipNode","initToolCardItem","e","t","i","ui","toolId","stageLevel","pvz","PlayerData","getStageLevel","toolJson","JsonControl","getToolJson","string","name","getToolTypeIcon","lattice","node","scale","utils","useBundleAsset","SkeletonData","skeletonData","refreshToolSpineShow","onLvUpRefreshCard","getToolData","lv","getLevelInterval","setAnimation","toolData","toollvJson","getToolLvUpJson","getQualityCardIcon","quality","GameConfig","ToolLockLevel","isMaxLv","MaxToolLv","isEnoughFrag","c","progress","active","onClickCard"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        spine: sp.Skeleton,\n        qualitySprite: cc.Sprite,\n        typeSprite: cc.Sprite,\n        nameLabel: cc.Label,\n        levelLabel: cc.Label,\n        fragLabel: cc.Label,\n        lvProgressBar: cc.ProgressBar,\n        maxFragLine: cc.Node,\n        lvTipNode: cc.Node,\n        fragTipNode: cc.Node\n    },\n    initToolCardItem: function (e, t) {\n        var i = this;\n        this.ui = e;\n        this.toolId = t;\n        this.stageLevel = cc.pvz.PlayerData.getStageLevel();\n        this.toolJson = cc.JsonControl.getToolJson(this.toolId);\n        this.nameLabel.string = this.toolJson.name;\n        cc.JsonControl.getToolTypeIcon(this.typeSprite, this.toolJson.lattice);\n        this.spine.node.scale = this.toolJson.scale;\n        cc.pvz.utils.useBundleAsset(\"actors\", \"character/Characters\", sp.SkeletonData, function (e) {\n            i.spine.skeletonData = e;\n            i.refreshToolSpineShow();\n        });\n        this.onLvUpRefreshCard(!1);\n    },\n    refreshToolSpineShow: function () {\n        var e = cc.pvz.PlayerData.getToolData(this.toolId).lv;\n        var t = cc.pvz.utils.getLevelInterval(e);\n        this.spine.setAnimation(0, \"Idle\", !0);\n    },\n    onLvUpRefreshCard: function (e) {\n        if (void 0 === e) {\n            e = !0;\n        }\n        this.toolData = cc.pvz.PlayerData.getToolData(this.toolId);\n        this.toollvJson = cc.JsonControl.getToolLvUpJson(this.toolData.lv);\n        if (e) {\n            this.refreshToolSpineShow();\n        }\n        cc.JsonControl.getQualityCardIcon(this.qualitySprite, this.toolJson.quality);\n        this.toolJson.quality;\n        var t = this.stageLevel <= cc.pvz.GameConfig.ToolLockLevel[this.toolId - 1];\n        if (t) {\n            this.levelLabel.string = \"未解锁\";\n        } else {\n            this.levelLabel.string = \"等级\" + this.toolData.lv;\n        }\n        this.isMaxLv = this.toolData.lv >= cc.pvz.GameConfig.MaxToolLv;\n        var i = this.toollvJson[\"sp\" + this.toolJson.quality];\n        this.isEnoughFrag = this.toolData.c >= i;\n        if (this.isMaxLv) {\n            this.fragLabel.string = \"已满级\";\n        } else {\n            this.fragLabel.string = this.toolData.c + \"/\" + i;\n        }\n        this.lvProgressBar.progress = this.toolData.c / i;\n        this.lvProgressBar.node.active = !this.isEnoughFrag || !this.isMaxLv;\n        this.maxFragLine.active = this.isEnoughFrag || this.isMaxLv;\n        this.lvTipNode.active = this.isEnoughFrag && !this.isMaxLv;\n        this.fragTipNode.active = !this.isEnoughFrag || this.isMaxLv;\n    },\n    onClickCard: function () {\n        this.ui.onClickCard(this);\n    }\n});"]}