{"version":3,"sources":["assets/mainUI/scripts/MainControl.js"],"names":["cc","UIPage","Enum","Shop","Rank","Battle","Tool","Fuben","Class","Component","properties","bgMusic","AudioClip","lvUpSound","rewardSound","coinLabel","Label","diamondLabel","powerPanel","Node","btnNodeList","mainPagePanel","spineList","sp","Skeleton","getItemEffectPos","e","pvz","GameConfig","ItemType","node","convertToWorldSpaceAR","v2","powerInfo","powerLabel","onLoad","MainControl","clearUICatch","UIShop","UITool","UIActLevel","UIRankMode","start","console","log","RedControl","refreshAllRedTip","getComponent","updatePowerInfo","updateItemInfo","initMainControl","butler","playMusic","player","guide1","tempGuideIndex","t","guideManager","showGuide","tip","focus","btn","name","PlayerData","getStageLevel","OpenSysLv","cloud","myRank","i","tmpScore","info","score","rankLastWeek","rankWeek","utils","getStartOfWeek","popupManager","popup","ad","scale","onRankRewardShown","hasPopupType","runtimeData","hasPreGame","checkAndResetSign","getSignData","isReward","hasPastOneDay","isShare","adTimes","MainUI","onClickShareUI","isChangeCard","curStatus","lastStatus","onShopOpenStatus","isLockRank","initBtnStatus","onChangePage","onClickPageBtn","parseInt","showToast","onHidePageUI","onShowPageUI","onChangeBtnAni","initBy","onShopToCoin","onShopToDiamond","onLoadMainPageUI","TAUtils","trackSystemUI","showMainUI","assetManager","getBundle","load","Prefab","o","a","c","instantiate","s","parent","position","onCloseUI","onClickClose","hideMainUI","setAnimation","setSiblingIndex","Math","min","max","setCompleteListener","addAnimation","active","getItemNum","string","formatItemNum","checkPowerInfo","checkPowerShow","onClickBuyPower","UIFromType","onClickBuyCoin","onClickBuyDiamond","onAutoChangePage"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.UIPage = cc.Enum({\n    Shop: 1,\n    Rank: 2,\n    Battle: 3,\n    Tool: 4,\n    Fuben: 5\n});\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        bgMusic: cc.AudioClip,\n        lvUpSound: cc.AudioClip,\n        rewardSound: cc.AudioClip,\n        coinLabel: cc.Label,\n        diamondLabel: cc.Label,\n        powerPanel: cc.Node,\n        btnNodeList: [cc.Node],\n        mainPagePanel: cc.Node,\n        spineList: [sp.Skeleton]\n    },\n    getItemEffectPos: function (e) {\n        switch (e) {\n            case cc.pvz.GameConfig.ItemType[\"钻石\"]:\n                return this.diamondLabel.node.convertToWorldSpaceAR(cc.v2());\n            case cc.pvz.GameConfig.ItemType[\"体力\"]:\n                return this.powerInfo.powerLabel.node.convertToWorldSpaceAR(cc.v2());\n            default:\n                return this.coinLabel.node.convertToWorldSpaceAR(cc.v2());\n        }\n    },\n    onLoad: function () {\n        cc.MainControl = this;\n    },\n    clearUICatch: function () {\n        cc.UIShop = null;\n        cc.UITool = null;\n        cc.UIActLevel = null;\n        cc.UIRankMode = null;\n    },\n    start: function () {\n        var e = this;\n        console.log(\"  Start MainControl \");\n        cc.RedControl.refreshAllRedTip();\n        this.powerInfo = this.powerPanel.getComponent(\"PowerInfo\");\n        this.updatePowerInfo();\n        this.updateItemInfo();\n        this.clearUICatch();\n        this.initMainControl();\n        cc.butler.playMusic(this.bgMusic);\n        if (1 != cc.player.guide1) {\n            cc.tempGuideIndex = 0;\n            var t = this.btnNodeList[3];\n            cc.guideManager.showGuide(\n                0,\n                [\n                    {\n                        tip: \"进入角色升级拥有的卡皮巴拉\",\n                        focus: t,\n                        btn: t.name\n                    }\n                ],\n                function (e) {\n                    if (e) {\n                        cc.tempGuideIndex = 1;\n                    }\n                }\n            );\n        } else {\n            if (cc.pvz.PlayerData.getStageLevel() > cc.pvz.GameConfig.OpenSysLv[1]) {\n                cc.pvz.cloud.myRank(function (t, i) {\n                    if (t) {\n                        cc.tmpScore = i.info.score;\n                        if (\n                            -1 != i.info.rankLastWeek &&\n                            (!cc.player.rankWeek || cc.pvz.utils.getStartOfWeek() > cc.player.rankWeek)\n                        ) {\n                            cc.popupManager.popup(\n                                \"rank\",\n                                \"RankReward\",\n                                \"UIRankReward\",\n                                {\n                                    ad: !1,\n                                    scale: !0\n                                },\n                                i.info.rankLastWeek,\n                                function () {\n                                    e.updateItemInfo();\n                                    e.onRankRewardShown();\n                                }\n                            );\n                        } else {\n                            e.onRankRewardShown();\n                        }\n                    } else {\n                        e.onRankRewardShown();\n                    }\n                });\n            } else {\n                this.onRankRewardShown();\n            }\n        }\n    },\n    onRankRewardShown: function () {\n        var e = this;\n        if (cc.hasPopupType) {\n            //\n        } else {\n            if (cc.pvz.runtimeData.hasPreGame()) {\n                cc.popupManager.popup(\n                    \"mainUI\",\n                    \"leveltipUI\",\n                    \"UIPreGame\",\n                    {\n                        ad: !1,\n                        scale: !0\n                    },\n                    function () {\n                        e.onRankRewardShown();\n                    }\n                );\n            } else {\n                cc.pvz.PlayerData.checkAndResetSign(),\n                    cc.pvz.PlayerData.getSignData().isReward\n                        ? cc.pvz.PlayerData.hasPastOneDay() &&\n                          !cc.player.isShare &&\n                          cc.player.adTimes >= 5 &&\n                          cc.MainUI.onClickShareUI()\n                        : cc.popupManager.popup(\"mainUI\", \"signUI\", \"UISign\", {\n                              ad: !1,\n                              scale: !0\n                          });\n            }\n        }\n    },\n    initMainControl: function () {\n        this.isChangeCard = !1;\n        this.curStatus = cc.UIPage.Battle;\n        this.lastStatus = this.curStatus;\n        this.onShopOpenStatus = 0;\n        this.isLockRank = cc.pvz.PlayerData.getStageLevel() <= cc.pvz.GameConfig.OpenSysLv[1];\n        this.initBtnStatus();\n        if (cc.hasPopupType == cc.UIPage.Rank) {\n            this.isChangeCard = !0;\n            this.curStatus = cc.UIPage.Rank;\n            this.onChangePage();\n        } else {\n            if (cc.hasPopupType == cc.UIPage.Fuben) {\n                this.isChangeCard = !0;\n                this.curStatus = cc.UIPage.Fuben;\n                this.onChangePage();\n            }\n        }\n    },\n    onClickPageBtn: function (e, t) {\n        if (!this.isChangeCard) {\n            var i = parseInt(t);\n            if (i == cc.UIPage.Rank && cc.pvz.PlayerData.getStageLevel() <= cc.pvz.GameConfig.OpenSysLv[1]) {\n                cc.popupManager.showToast(\"通过关卡第\" + cc.pvz.GameConfig.OpenSysLv[1] + \"关解锁\");\n            } else {\n                if (i != this.curStatus) {\n                    this.onShopOpenStatus = 0;\n                    this.isChangeCard = !0;\n                    this.curStatus = i;\n                    this.onChangePage();\n                }\n            }\n        }\n    },\n    onChangePage: function () {\n        this.onHidePageUI();\n        this.onShowPageUI();\n        this.onChangeBtnAni();\n    },\n    onShowPageUI: function () {\n        switch (this.curStatus) {\n            case cc.UIPage.Shop:\n                if (cc.UIShop) {\n                    cc.UIShop.initBy();\n                    if (1 == this.onShopOpenStatus) {\n                        cc.UIShop.onShopToCoin();\n                    } else {\n                        2 == this.onShopOpenStatus && cc.UIShop.onShopToDiamond();\n                    }\n                } else {\n                    this.onLoadMainPageUI(\"shop\", \"UIShop\");\n                }\n                cc.pvz.TAUtils.trackSystemUI(1);\n                break;\n            case cc.UIPage.Rank:\n                if (cc.UIRankMode) {\n                    cc.UIRankMode.initBy();\n                } else {\n                    this.onLoadMainPageUI(\"Rank\", \"UIRankMode\");\n                }\n                break;\n            case cc.UIPage.Battle:\n                cc.MainUI.showMainUI();\n                break;\n            case cc.UIPage.Tool:\n                if (cc.UITool) {\n                    cc.UITool.initBy();\n                } else {\n                    this.onLoadMainPageUI(\"plant\", \"UITool\");\n                }\n                cc.pvz.TAUtils.trackSystemUI(2);\n                break;\n            case cc.UIPage.Fuben:\n                if (cc.UIActLevel) {\n                    cc.UIActLevel.initBy();\n                } else {\n                    this.onLoadMainPageUI(\"TiaozhanUI\", \"UIActLevel\");\n                }\n                cc.pvz.TAUtils.trackSystemUI(3);\n        }\n    },\n    onLoadMainPageUI: function (e, t) {\n        var i = this;\n        cc.assetManager.getBundle(\"mainUI\").load(e, cc.Prefab, function (o, a) {\n            if (o) {\n                console.log(\"prefabName load error: \", e, o);\n            } else {\n                var c = cc.instantiate(a);\n                var s = c.getComponent(t);\n                c.parent = i.mainPagePanel;\n                c.position = cc.v2(0, 0);\n                s.initBy();\n                if (\"UIShop\" == t && cc.UIShop) {\n                    if (1 == i.onShopOpenStatus) {\n                        cc.UIShop.onShopToCoin();\n                    } else {\n                        2 == i.onShopOpenStatus && cc.UIShop.onShopToDiamond();\n                    }\n                }\n            }\n        });\n    },\n    onHidePageUI: function () {\n        switch (this.lastStatus) {\n            case cc.UIPage.Shop:\n                cc.UIShop.onCloseUI();\n                break;\n            case cc.UIPage.Rank:\n                cc.UIRankMode.onClickClose();\n                break;\n            case cc.UIPage.Battle:\n                cc.MainUI.hideMainUI();\n                break;\n            case cc.UIPage.Tool:\n                cc.UITool.onCloseUI();\n                break;\n            case cc.UIPage.Fuben:\n                cc.UIActLevel.onCloseUI();\n        }\n    },\n    initBtnStatus: function () {\n        for (var e = 0; e < 5; e++) {\n            var t = \"\";\n            var i = e + 1;\n            if (i < this.curStatus) {\n                t = \"_4_R\";\n                i == cc.UIPage.Rank && this.isLockRank && (t = \"_5_R\");\n                this.spineList[e].setAnimation(0, \"anniu\" + i + t, !1);\n            } else {\n                if (i > this.curStatus) {\n                    (t = \"_4_L\"),\n                        i == cc.UIPage.Rank && this.isLockRank && (t = \"_5_L\"),\n                        this.spineList[e].setAnimation(0, \"anniu\" + i + t, !1);\n                } else {\n                    this.spineList[e].setAnimation(0, \"anniu\" + i + \"_3\", !0),\n                        this.spineList[e].node.setSiblingIndex(6);\n                }\n            }\n        }\n    },\n    onChangeBtnAni: function () {\n        var e = this;\n        var t = function (t) {\n            if (t < Math.min(e.lastStatus, e.curStatus) || t > Math.max(e.lastStatus, e.curStatus)) {\n                return \"continue\";\n            }\n            if (t === e.curStatus) {\n                var i = e.spineList[t - 1];\n                var o;\n                if (e.curStatus < e.lastStatus) {\n                    o = \"R\";\n                } else {\n                    o = \"L\";\n                }\n                i.setAnimation(0, \"anniu\" + t + \"_1_\" + o, !1);\n                i.setCompleteListener(function () {\n                    i.setAnimation(0, \"anniu\" + t + \"_3\", !0);\n                    e.isChangeCard = !1;\n                    i.setCompleteListener(null);\n                });\n                i.node.setSiblingIndex(6);\n            } else if (t === e.lastStatus) {\n                var a;\n                if (e.curStatus > e.lastStatus) {\n                    a = \"R\";\n                } else {\n                    a = \"L\";\n                }\n                e.spineList[t - 1].setAnimation(0, \"anniu\" + t + \"_2_\" + a, !1);\n                e.spineList[t - 1].addAnimation(0, \"anniu\" + t + \"_4_\" + a, !1);\n            } else {\n                var c;\n                if (e.curStatus > e.lastStatus) {\n                    c = \"R\";\n                } else {\n                    c = \"L\";\n                }\n                if (e.isLockRank && t == cc.UIPage.Rank) {\n                    e.spineList[t - 1].setAnimation(0, \"anniu\" + t + \"_5_\" + c, !1);\n                } else {\n                    e.spineList[t - 1].setAnimation(0, \"anniu\" + t + \"_4_\" + c, !1);\n                }\n            }\n        };\n        for (var i = 1; i <= 5; i++) {\n            t(i);\n        }\n        this.lastStatus = this.curStatus;\n        for (var o = 0; o < 5; o++) {\n            this.btnNodeList[o].active = o !== this.curStatus - 1;\n            this.btnNodeList[o + 5].active = o === this.curStatus - 1;\n        }\n    },\n    updateItemInfo: function () {\n        var e = cc.pvz.PlayerData.getItemNum(cc.pvz.GameConfig.ItemType[\"金币\"]);\n        this.coinLabel.string = cc.pvz.utils.formatItemNum(e);\n        var t = cc.pvz.PlayerData.getItemNum(cc.pvz.GameConfig.ItemType[\"钻石\"]);\n        this.diamondLabel.string = cc.pvz.utils.formatItemNum(t);\n    },\n    updatePowerInfo: function () {\n        this.powerInfo.updatePowerInfo();\n    },\n    checkPowerInfo: function () {\n        this.powerInfo.checkPowerShow();\n    },\n    onClickBuyPower: function () {\n        cc.popupManager.popup(\n            \"mainUI\",\n            \"powerbuy\",\n            \"UIPowerBuy\",\n            {\n                ad: !1,\n                scale: !0\n            },\n            cc.pvz.GameConfig.UIFromType[\"主界面\"]\n        );\n    },\n    onClickBuyCoin: function () {\n        if (this.curStatus != cc.UIPage.Shop) {\n            this.onShopOpenStatus = 1;\n            this.isChangeCard = !0;\n            this.curStatus = cc.UIPage.Shop;\n            this.onChangePage();\n        } else {\n            if (cc.UIShop) {\n                cc.UIShop.onShopToCoin();\n            }\n        }\n    },\n    onClickBuyDiamond: function () {\n        if (this.curStatus != cc.UIPage.Shop) {\n            this.onShopOpenStatus = 2;\n            this.isChangeCard = !0;\n            this.curStatus = cc.UIPage.Shop;\n            this.onChangePage();\n        } else {\n            if (cc.UIShop) {\n                cc.UIShop.onShopToDiamond();\n            }\n        }\n    },\n    onAutoChangePage: function (e) {\n        this.onShopOpenStatus = 0;\n        this.isChangeCard = !0;\n        this.curStatus = e;\n        this.onChangePage();\n    }\n});\n"]}