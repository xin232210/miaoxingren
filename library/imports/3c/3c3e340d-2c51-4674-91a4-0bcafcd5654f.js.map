{"version":3,"sources":["assets/game/scripts/UIGameBuff.js"],"names":["i","cc","Class","name","properties","bgSp","Sprite","qualitySp","iconSp","nameLabel","Label","descLabel","RichText","Component","heroJsonFile","JsonAsset","buffJsonFile","buffNodes","refreshNode","Node","refreshTimesLabel","getAllNode","getAllTimesLabel","btnsLayout","Layout","onLoad","forEach","t","enabled","initBy","e","scene","buffPool","json","pvz","runtimeData","buffs","filter","id","length","gettimes","push","Math","floor","n","PlayerData","getToolData","pos","lv","locklevel","o","parseInt","frontskill","some","getStageLevel","guide","mode","findIndex","splice","refresh","checkAndResetAdData","active","getAdCount","string","getAdMaxCount","updateRefreshTimes","TAUtils","trackAdUIShow","GameConfig","AdType","buffRefreshCount","buffAllCount","getAdBuffTimes","useAdCount","updateAdBuffTimes","updateLayout","showGame1st","hasEnableBuff","math","randomRangeInt","s","c","find","utils","setSpriteFrame","quality","icon","desc","a","timePaused","butler","resumeDirector","r","node","parent","guideManager","showGuide","tip","focus","btn","y","hideFinger","onClickClose","popupManager","removePopup","checkIsSucc","onClickBuff","addBuff","onClickRefresh","AdUtils","showAdRewardVideo","onClickGetAll"],"mappings":";;;;;;AAAA,IAAIA,CAAC,GAAGC,EAAE,CAACC,KAAH,CAAS;EACbC,IAAI,EAAE,UADO;EAEbC,UAAU,EAAE;IACRC,IAAI,EAAEJ,EAAE,CAACK,MADD;IAERC,SAAS,EAAEN,EAAE,CAACK,MAFN;IAGRE,MAAM,EAAEP,EAAE,CAACK,MAHH;IAIRG,SAAS,EAAER,EAAE,CAACS,KAJN;IAKRC,SAAS,EAAEV,EAAE,CAACW;EALN;AAFC,CAAT,CAAR;AAUAX,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACY,SADP;EAELT,UAAU,EAAE;IACRU,YAAY,EAAEb,EAAE,CAACc,SADT;IAERC,YAAY,EAAEf,EAAE,CAACc,SAFT;IAGRE,SAAS,EAAE,CAACjB,CAAD,CAHH;IAIRkB,WAAW,EAAEjB,EAAE,CAACkB,IAJR;IAKRC,iBAAiB,EAAEnB,EAAE,CAACS,KALd;IAMRW,UAAU,EAAEpB,EAAE,CAACkB,IANP;IAORG,gBAAgB,EAAErB,EAAE,CAACS,KAPb;IAQRa,UAAU,EAAEtB,EAAE,CAACuB;EARP,CAFP;EAYLC,MAAM,EAAE,kBAAY;IAChB,KAAKR,SAAL,CAAeS,OAAf,CAAuB,UAAUC,CAAV,EAAa;MAChC,OAAQA,CAAC,CAAChB,SAAF,CAAYiB,OAAZ,GAAsB,CAAC,CAA/B;IACH,CAFD;EAGH,CAhBI;EAiBLC,MAAM,EAAE,gBAAUF,CAAV,EAAa;IACjB,IAAIG,CAAC,GAAG,IAAR;IACA,KAAKC,KAAL,GAAaJ,CAAb;IACA,KAAKK,QAAL,GAAgB,EAAhB;IACA,KAAKhB,YAAL,CAAkBiB,IAAlB,CAAuBP,OAAvB,CAA+B,UAAUC,CAAV,EAAa;MACxC,IACI,EACI1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBC,KAAnB,CAAyBC,MAAzB,CAAgC,UAAUP,CAAV,EAAa;QACzC,OAAOA,CAAC,IAAIH,CAAC,CAACW,EAAd;MACH,CAFD,EAEGC,MAFH,IAEaZ,CAAC,CAACa,QAHnB,CADJ,EAME;QACE,IAAIb,CAAC,CAACW,EAAF,GAAO,GAAX,EAAgB;UACZR,CAAC,CAACE,QAAF,CAAWS,IAAX,CAAgBd,CAAC,CAACW,EAAlB;QACH,CAFD,MAEO;UACH,IAAItC,CAAC,GAAG0C,IAAI,CAACC,KAAL,CAAWhB,CAAC,CAACW,EAAF,GAAO,GAAlB,CAAR;UACA,IAAIM,CAAC,GAAG3C,EAAE,CAACiC,GAAH,CAAOW,UAAP,CAAkBC,WAAlB,CAA8B9C,CAA9B,CAAR;;UACA,IAAI4C,CAAC,CAACG,GAAF,IAAS,CAAT,IAAcH,CAAC,CAACI,EAAF,IAAQrB,CAAC,CAACsB,SAA5B,EAAuC;YACnC,IAAIC,CAAC,GAAGC,QAAQ,CAACxB,CAAC,CAACyB,UAAH,CAAhB;;YACA,IACI,MAAMzB,CAAC,CAACyB,UAAR,IACAnD,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBC,KAAnB,CAAyBiB,IAAzB,CAA8B,UAAU1B,CAAV,EAAa;cACvC,OAAOA,CAAC,IAAIuB,CAAZ;YACH,CAFD,CAFJ,EAKE;cACEpB,CAAC,CAACE,QAAF,CAAWS,IAAX,CAAgBd,CAAC,CAACW,EAAlB;YACH;UACJ;QACJ;MACJ;IACJ,CA1BD;IA2BA,IAAItC,CAAC,GAAG,EAAR;;IACA,IAAI,KAAKC,EAAE,CAACiC,GAAH,CAAOW,UAAP,CAAkBS,aAAlB,EAAL,IAA0CrD,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBoB,KAAnB,GAA2B,CAAzE,EAA4E;MACxEvD,CAAC,CAACyC,IAAF,CAAO,EAAP;IACH;;IACD,IAAI,KAAKxC,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBqB,IAA5B,EAAkC;MAC9BxD,CAAC,CAACyC,IAAF,CAAO,EAAP,EAAW,EAAX,EAAe,EAAf,EAAmB,EAAnB,EAAuB,EAAvB,EAA2B,EAA3B,EAA+B,EAA/B,EAAmC,EAAnC,EAAuC,EAAvC,EAA2C,EAA3C;IACH;;IACDzC,CAAC,CAAC0B,OAAF,CAAU,UAAUC,CAAV,EAAa;MACnB,IAAI3B,CAAC,GAAG8B,CAAC,CAACE,QAAF,CAAWyB,SAAX,CAAqB,UAAU3B,CAAV,EAAa;QACtC,OAAOA,CAAC,IAAIH,CAAZ;MACH,CAFO,CAAR;;MAGA,IAAI,CAAC,CAAD,IAAM3B,CAAV,EAAa;QACT8B,CAAC,CAACE,QAAF,CAAW0B,MAAX,CAAkB1D,CAAlB,EAAqB,CAArB;MACH;IACJ,CAPD;IAQA,KAAK2D,OAAL,CAAa,CAAC,CAAd;IACA1D,EAAE,CAACiC,GAAH,CAAOW,UAAP,CAAkBe,mBAAlB;IACA,KAAKvC,UAAL,CAAgBwC,MAAhB,GAAyB,KAAKC,UAAL,CAAgB,CAAhB,IAAqB,CAA9C;IACA,KAAKxC,gBAAL,CAAsByC,MAAtB,GAA+B,KAAKD,UAAL,CAAgB,CAAhB,IAAqB,GAArB,GAA2B,KAAKE,aAAL,CAAmB,CAAnB,CAA1D;IACA,KAAKC,kBAAL;;IACA,IAAI,KAAK5C,UAAL,CAAgBwC,MAApB,EAA4B;MACxB5D,EAAE,CAACiC,GAAH,CAAOgC,OAAP,CAAeC,aAAf,CAA6BlE,EAAE,CAACiC,GAAH,CAAOkC,UAAP,CAAkBC,MAAlB,CAAyB,QAAzB,CAA7B;IACH;EACJ,CAvEI;EAwELL,aAAa,EAAE,uBAAUrC,CAAV,EAAa;IACxB,IAAI,KAAK1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBqB,IAA5B,EAAkC;MAC9B,IAAI,KAAK7B,CAAT,EAAY;QACR,OAAO,CAAP;MACH,CAFD,MAEO;QACH,OAAO,CAAP;MACH;IACJ,CAND,MAMO;MACH,IAAI,KAAKA,CAAT,EAAY;QACR,OAAO,EAAP;MACH,CAFD,MAEO;QACH,OAAO,CAAP;MACH;IACJ;EACJ,CAtFI;EAuFLmC,UAAU,EAAE,oBAAUnC,CAAV,EAAa;IACrB,IAAI,KAAK1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBqB,IAA5B,EAAkC;MAC9B,IAAI,KAAK7B,CAAT,EAAY;QACR,OAAO1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBmC,gBAA1B;MACH,CAFD,MAEO;QACH,OAAOrE,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBoC,YAA1B;MACH;IACJ,CAND,MAMO;MACH,OAAOtE,EAAE,CAACiC,GAAH,CAAOW,UAAP,CAAkB2B,cAAlB,CAAiC7C,CAAjC,CAAP;IACH;EACJ,CAjGI;EAkGL8C,UAAU,EAAE,oBAAU9C,CAAV,EAAa;IACrB,IAAI,KAAK1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBqB,IAA5B,EAAkC;MAC9B,IAAI,KAAK7B,CAAT,EAAY;QACR1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBmC,gBAAnB;MACH,CAFD,MAEO;QACHrE,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBoC,YAAnB;MACH;IACJ,CAND,MAMO;MACHtE,EAAE,CAACiC,GAAH,CAAOW,UAAP,CAAkB6B,iBAAlB,CAAoC/C,CAApC;IACH;EACJ,CA5GI;EA6GLsC,kBAAkB,EAAE,8BAAY;IAC5B,KAAK/C,WAAL,CAAiB2C,MAAjB,GAA0B,KAAKC,UAAL,CAAgB,CAAhB,IAAqB,CAA/C;IACA,KAAK1C,iBAAL,CAAuB2C,MAAvB,GAAgC,KAAKD,UAAL,CAAgB,CAAhB,IAAqB,GAArB,GAA2B,KAAKE,aAAL,CAAmB,CAAnB,CAA3D;IACA,KAAKzC,UAAL,CAAgBoD,YAAhB;;IACA,IAAI,KAAKzD,WAAL,CAAiB2C,MAArB,EAA6B;MACzB5D,EAAE,CAACiC,GAAH,CAAOgC,OAAP,CAAeC,aAAf,CAA6BlE,EAAE,CAACiC,GAAH,CAAOkC,UAAP,CAAkBC,MAAlB,CAAyB,QAAzB,CAA7B;IACH;EACJ,CApHI;EAqHLV,OAAO,EAAE,iBAAUhC,CAAV,EAAa;IAClB,IAAIG,CAAC,GAAG,IAAR;IACA,KAAKM,KAAL,GAAa,EAAb;;IACA,IAAIT,CAAC,IAAI1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmByC,WAA5B,EAAyC;MACrC,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgBlD,OAAhB,CAAwB,UAAUC,CAAV,EAAa;QACjC,IAAI1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmB0C,aAAnB,CAAiClD,CAAjC,CAAJ,EAAyC,CACrC;QACH,CAFD,MAEO;UACHG,CAAC,CAACM,KAAF,CAAQK,IAAR,CAAad,CAAb;QACH;MACJ,CAND;IAOH;;IACD,IAAI3B,CAAC,GAAG2B,CAAC,IAAI,KAAK1B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBoB,KAArC;;IACA,IAAIvD,CAAJ,EAAO;MACH,KAAKoC,KAAL,CAAWK,IAAX,CAAgB,GAAhB;IACH;;IACD,IAAIG,CAAC,GAAG,SAAJA,CAAI,GAAY;MAChB,KACI,IAAIjB,CAAC,GAAGG,CAAC,CAACE,QAAF,CAAW/B,EAAE,CAAC6E,IAAH,CAAQC,cAAR,CAAuB,CAAvB,EAA0BjD,CAAC,CAACE,QAAF,CAAWO,MAArC,CAAX,CADZ,EAEIT,CAAC,CAACM,KAAF,CAAQiB,IAAR,CAAa,UAAUvB,CAAV,EAAa;QACtB,OAAOA,CAAC,IAAIH,CAAZ;MACH,CAFD,CAFJ;QAOIA,CAAC,GAAGG,CAAC,CAACE,QAAF,CAAW/B,EAAE,CAAC6E,IAAH,CAAQC,cAAR,CAAuB,CAAvB,EAA0BjD,CAAC,CAACE,QAAF,CAAWO,MAArC,CAAX,CAAJ;MAPJ;;MAQAT,CAAC,CAACM,KAAF,CAAQK,IAAR,CAAad,CAAb;IACH,CAVD;;IAWA,KAAK,IAAIuB,CAAC,GAAG,KAAKd,KAAL,CAAWG,MAAxB,EAAgCW,CAAC,GAAG,KAAKjC,SAAL,CAAesB,MAAnD,EAA2DW,CAAC,EAA5D,EAAgE;MAC5DN,CAAC;IACJ;;IACD,IAAIoC,CAAC,GAAG,SAAJA,CAAI,GAAY;MAChB,IAAIrD,CAAC,GAAGG,CAAC,CAACM,KAAF,CAAQ6C,CAAR,CAAR;MACA,IAAIjF,CAAC,GAAG8B,CAAC,CAACd,YAAF,CAAeiB,IAAf,CAAoBiD,IAApB,CAAyB,UAAUpD,CAAV,EAAa;QAC1C,OAAOA,CAAC,CAACQ,EAAF,IAAQX,CAAf;MACH,CAFO,CAAR;MAGA,IAAIiB,CAAC,GAAGd,CAAC,CAACb,SAAF,CAAYgE,CAAZ,CAAR;MACAhF,EAAE,CAACiC,GAAH,CAAOiD,KAAP,CAAaC,cAAb,CAA4BxC,CAAC,CAACvC,IAA9B,EAAoC,SAApC,EAA+C,iBAAiBL,CAAC,CAACqF,OAAlE;MACApF,EAAE,CAACiC,GAAH,CAAOiD,KAAP,CAAaC,cAAb,CAA4BxC,CAAC,CAACrC,SAA9B,EAAyC,SAAzC,EAAoD,aAAaP,CAAC,CAACqF,OAAnE;MACApF,EAAE,CAACiC,GAAH,CAAOiD,KAAP,CAAaC,cAAb,CAA4BxC,CAAC,CAACpC,MAA9B,EAAsC,SAAtC,EAAiD,gBAAgBR,CAAC,CAACsF,IAAnE;MACA1C,CAAC,CAACnC,SAAF,CAAYsD,MAAZ,GAAqB/D,CAAC,CAACG,IAAvB;MACAyC,CAAC,CAACjC,SAAF,CAAYoD,MAAZ,GAAqB/D,CAAC,CAACuF,IAAvB;MACA3C,CAAC,CAACjC,SAAF,CAAYiB,OAAZ,GAAsB,CAAC,CAAvB;IACH,CAZD;;IAaA,KAAK,IAAIqD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKhE,SAAL,CAAesB,MAAnC,EAA2C0C,CAAC,EAA5C,EAAgD;MAC5CD,CAAC;IACJ;;IACD,IAAIhF,CAAJ,EAAO;MACH,IAAIwF,CAAC,GAAG,KAAKzD,KAAb;MACAyD,CAAC,CAACC,UAAF,GAAe,CAAC,CAAhB;MACAxF,EAAE,CAACyF,MAAH,CAAUC,cAAV,CAAyB,CAAzB;MACA,IAAIC,CAAC,GAAG,KAAK3E,SAAL,CAAe,CAAf,EAAkBZ,IAAlB,CAAuBwF,IAAvB,CAA4BC,MAApC;MACA7F,EAAE,CAAC8F,YAAH,CAAgBC,SAAhB,CACI,CADJ,EAEI,CACI;QACIC,GAAG,EAAE,qBADT;QAEIC,KAAK,EAAEN,CAFX;QAGIO,GAAG,EAAEP,CAAC,CAACzF,IAHX;QAIIiG,CAAC,EAAE,CAAC;MAJR,CADJ,EAOI;QACIC,UAAU,EAAE,CAAC,CADjB;QAEIJ,GAAG,EAAE;MAFT,CAPJ,CAFJ,EAcI,UAAUtE,CAAV,EAAa;QACT,IAAIA,CAAJ,EAAO;UACH6D,CAAC,CAACC,UAAF,GAAe,CAAC,CAAhB;QACH;MACJ,CAlBL;IAoBH;EACJ,CA7LI;EA8LLa,YAAY,EAAE,wBAAY;IACtBrG,EAAE,CAACsG,YAAH,CAAgBC,WAAhB,CAA4B,IAA5B;IACA,KAAKzE,KAAL,CAAW0E,WAAX;EACH,CAjMI;EAkMLC,WAAW,EAAE,qBAAU/E,CAAV,EAAaG,CAAb,EAAgB;IACzB,IAAI9B,CAAC,GAAG,KAAKoC,KAAL,CAAWe,QAAQ,CAACrB,CAAD,CAAnB,CAAR;IACA7B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBwE,OAAnB,CAA2B3G,CAA3B,EAA8B,KAAKc,YAAL,CAAkBmB,IAAhD;IACA,KAAKqE,YAAL;EACH,CAtMI;EAuMLM,cAAc,EAAE,0BAAY;IACxB,IAAIjF,CAAC,GAAG,IAAR;;IACA,IAAI,KAAKmC,UAAL,CAAgB,CAAhB,KAAsB,CAA1B,EAA6B,CACzB;IACH,CAFD,MAEO;MACH7D,EAAE,CAACiC,GAAH,CAAO2E,OAAP,CAAeC,iBAAf,CAAiC7G,EAAE,CAACiC,GAAH,CAAOkC,UAAP,CAAkBC,MAAlB,CAAyB,QAAzB,CAAjC,EAAqE,UAAUvC,CAAV,EAAa;QAC9E,IAAIA,CAAJ,EAAO;UACHH,CAAC,CAAC8C,UAAF,CAAa,CAAb;UACA9C,CAAC,CAACsC,kBAAF;UACAtC,CAAC,CAACgC,OAAF,CAAU,CAAC,CAAX;QACH;MACJ,CAND;IAOH;EACJ,CApNI;EAqNLoD,aAAa,EAAE,yBAAY;IACvB,IAAIpF,CAAC,GAAG,IAAR;;IACA,IAAI,KAAKmC,UAAL,CAAgB,CAAhB,KAAsB,CAA1B,EAA6B,CACzB;IACH,CAFD,MAEO;MACH7D,EAAE,CAACiC,GAAH,CAAO2E,OAAP,CAAeC,iBAAf,CAAiC7G,EAAE,CAACiC,GAAH,CAAOkC,UAAP,CAAkBC,MAAlB,CAAyB,QAAzB,CAAjC,EAAqE,UAAUvC,CAAV,EAAa;QAC9E,IAAIA,CAAJ,EAAO;UACHH,CAAC,CAAC8C,UAAF,CAAa,CAAb;UACA9C,CAAC,CAACS,KAAF,CAAQV,OAAR,CAAgB,UAAUI,CAAV,EAAa;YACzB7B,EAAE,CAACiC,GAAH,CAAOC,WAAP,CAAmBwE,OAAnB,CAA2B7E,CAA3B,EAA8BH,CAAC,CAACb,YAAF,CAAemB,IAA7C;UACH,CAFD;UAGAN,CAAC,CAAC2E,YAAF;QACH;MACJ,CARD;IASH;EACJ;AApOI,CAAT","sourceRoot":"/","sourcesContent":["var i = cc.Class({\n    name: \"BuffNode\",\n    properties: {\n        bgSp: cc.Sprite,\n        qualitySp: cc.Sprite,\n        iconSp: cc.Sprite,\n        nameLabel: cc.Label,\n        descLabel: cc.RichText\n    }\n});\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        heroJsonFile: cc.JsonAsset,\n        buffJsonFile: cc.JsonAsset,\n        buffNodes: [i],\n        refreshNode: cc.Node,\n        refreshTimesLabel: cc.Label,\n        getAllNode: cc.Node,\n        getAllTimesLabel: cc.Label,\n        btnsLayout: cc.Layout\n    },\n    onLoad: function () {\n        this.buffNodes.forEach(function (t) {\n            return (t.descLabel.enabled = !1);\n        });\n    },\n    initBy: function (t) {\n        var e = this;\n        this.scene = t;\n        this.buffPool = [];\n        this.buffJsonFile.json.forEach(function (t) {\n            if (\n                !(\n                    cc.pvz.runtimeData.buffs.filter(function (e) {\n                        return e == t.id;\n                    }).length >= t.gettimes\n                )\n            ) {\n                if (t.id < 100) {\n                    e.buffPool.push(t.id);\n                } else {\n                    var i = Math.floor(t.id / 100);\n                    var n = cc.pvz.PlayerData.getToolData(i);\n                    if (n.pos >= 0 && n.lv >= t.locklevel) {\n                        var o = parseInt(t.frontskill);\n                        if (\n                            \"\" == t.frontskill ||\n                            cc.pvz.runtimeData.buffs.some(function (t) {\n                                return t == o;\n                            })\n                        ) {\n                            e.buffPool.push(t.id);\n                        }\n                    }\n                }\n            }\n        });\n        var i = [];\n        if (1 == cc.pvz.PlayerData.getStageLevel() && cc.pvz.runtimeData.guide < 9) {\n            i.push(24);\n        }\n        if (2 == cc.pvz.runtimeData.mode) {\n            i.push(13, 14, 15, 16, 17, 18, 22, 23, 24, 31);\n        }\n        i.forEach(function (t) {\n            var i = e.buffPool.findIndex(function (e) {\n                return e == t;\n            });\n            if (-1 != i) {\n                e.buffPool.splice(i, 1);\n            }\n        });\n        this.refresh(!0);\n        cc.pvz.PlayerData.checkAndResetAdData();\n        this.getAllNode.active = this.getAdCount(1) > 0;\n        this.getAllTimesLabel.string = this.getAdCount(1) + \"/\" + this.getAdMaxCount(1);\n        this.updateRefreshTimes();\n        if (this.getAllNode.active) {\n            cc.pvz.TAUtils.trackAdUIShow(cc.pvz.GameConfig.AdType[\"buff全部\"]);\n        }\n    },\n    getAdMaxCount: function (t) {\n        if (2 == cc.pvz.runtimeData.mode) {\n            if (0 == t) {\n                return 3;\n            } else {\n                return 1;\n            }\n        } else {\n            if (0 == t) {\n                return 10;\n            } else {\n                return 3;\n            }\n        }\n    },\n    getAdCount: function (t) {\n        if (2 == cc.pvz.runtimeData.mode) {\n            if (0 == t) {\n                return cc.pvz.runtimeData.buffRefreshCount;\n            } else {\n                return cc.pvz.runtimeData.buffAllCount;\n            }\n        } else {\n            return cc.pvz.PlayerData.getAdBuffTimes(t);\n        }\n    },\n    useAdCount: function (t) {\n        if (2 == cc.pvz.runtimeData.mode) {\n            if (0 == t) {\n                cc.pvz.runtimeData.buffRefreshCount--;\n            } else {\n                cc.pvz.runtimeData.buffAllCount--;\n            }\n        } else {\n            cc.pvz.PlayerData.updateAdBuffTimes(t);\n        }\n    },\n    updateRefreshTimes: function () {\n        this.refreshNode.active = this.getAdCount(0) > 0;\n        this.refreshTimesLabel.string = this.getAdCount(0) + \"/\" + this.getAdMaxCount(0);\n        this.btnsLayout.updateLayout();\n        if (this.refreshNode.active) {\n            cc.pvz.TAUtils.trackAdUIShow(cc.pvz.GameConfig.AdType[\"buff刷新\"]);\n        }\n    },\n    refresh: function (t) {\n        var e = this;\n        this.buffs = [];\n        if (t && cc.pvz.runtimeData.showGame1st) {\n            [301, 501, 801].forEach(function (t) {\n                if (cc.pvz.runtimeData.hasEnableBuff(t)) {\n                    //\n                } else {\n                    e.buffs.push(t);\n                }\n            });\n        }\n        var i = t && 5 == cc.pvz.runtimeData.guide;\n        if (i) {\n            this.buffs.push(201);\n        }\n        var n = function () {\n            for (\n                var t = e.buffPool[cc.math.randomRangeInt(0, e.buffPool.length)];\n                e.buffs.some(function (e) {\n                    return e == t;\n                });\n\n            )\n                t = e.buffPool[cc.math.randomRangeInt(0, e.buffPool.length)];\n            e.buffs.push(t);\n        };\n        for (var o = this.buffs.length; o < this.buffNodes.length; o++) {\n            n();\n        }\n        var s = function () {\n            var t = e.buffs[c];\n            var i = e.buffJsonFile.json.find(function (e) {\n                return e.id == t;\n            });\n            var n = e.buffNodes[c];\n            cc.pvz.utils.setSpriteFrame(n.bgSp, \"uiImage\", \"game/buff_di\" + i.quality);\n            cc.pvz.utils.setSpriteFrame(n.qualitySp, \"uiImage\", \"item/pz_\" + i.quality);\n            cc.pvz.utils.setSpriteFrame(n.iconSp, \"uiImage\", \"skill/skill\" + i.icon);\n            n.nameLabel.string = i.name;\n            n.descLabel.string = i.desc;\n            n.descLabel.enabled = !0;\n        };\n        for (var c = 0; c < this.buffNodes.length; c++) {\n            s();\n        }\n        if (i) {\n            var a = this.scene;\n            a.timePaused = !0;\n            cc.butler.resumeDirector(1);\n            var r = this.buffNodes[0].bgSp.node.parent;\n            cc.guideManager.showGuide(\n                0,\n                [\n                    {\n                        tip: \"击败怪物提升等级，能获得卡皮巴拉的强化\",\n                        focus: r,\n                        btn: r.name,\n                        y: -450\n                    },\n                    {\n                        hideFinger: !0,\n                        tip: \"尽量击败怪物们变得更强吧！\"\n                    }\n                ],\n                function (t) {\n                    if (t) {\n                        a.timePaused = !1;\n                    }\n                }\n            );\n        }\n    },\n    onClickClose: function () {\n        cc.popupManager.removePopup(this);\n        this.scene.checkIsSucc();\n    },\n    onClickBuff: function (t, e) {\n        var i = this.buffs[parseInt(e)];\n        cc.pvz.runtimeData.addBuff(i, this.heroJsonFile.json);\n        this.onClickClose();\n    },\n    onClickRefresh: function () {\n        var t = this;\n        if (this.getAdCount(0) <= 0) {\n            //\n        } else {\n            cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType[\"buff刷新\"], function (e) {\n                if (e) {\n                    t.useAdCount(0);\n                    t.updateRefreshTimes();\n                    t.refresh(!1);\n                }\n            });\n        }\n    },\n    onClickGetAll: function () {\n        var t = this;\n        if (this.getAdCount(1) <= 0) {\n            //\n        } else {\n            cc.pvz.AdUtils.showAdRewardVideo(cc.pvz.GameConfig.AdType[\"buff全部\"], function (e) {\n                if (e) {\n                    t.useAdCount(1);\n                    t.buffs.forEach(function (e) {\n                        cc.pvz.runtimeData.addBuff(e, t.heroJsonFile.json);\n                    });\n                    t.onClickClose();\n                }\n            });\n        }\n    }\n});\n"]}