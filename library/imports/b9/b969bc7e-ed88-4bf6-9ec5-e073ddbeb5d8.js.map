{"version":3,"sources":["assets/scripts/PrefabInfo.js"],"names":["cc","Class","Component","properties","prefab","Node","prefabAsset","Prefab","clazz","count","root","onLoad","init","hasHackNode","_BaseNode","prototype","_onSetParent","e","__pool","__poolCounter","__isInPool","put","onDestroy","hasInit","t","pool","size","get","destroy","lazyInit","active","position","Vec2","ZERO","length","NodePool","o","instantiate","newNode","addNodeByWorldPos","addNode","convertToNodeSpaceAR","addNodeTo","parent","_calculWorldMatrix","addEffectNode","a","getComponent","initEffect","addBattleEffectNode"],"mappings":";;;;;;AAAAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAELC,UAAU,EAAE;IACRC,MAAM,EAAEJ,EAAE,CAACK,IADH;IAERC,WAAW,EAAEN,EAAE,CAACO,MAFR;IAGRC,KAAK,EAAE,EAHC;IAIRC,KAAK,EAAE,CAJC;IAKRC,IAAI,EAAEV,EAAE,CAACK;EALD,CAFP;EASLM,MAAM,EAAE,kBAAY;IAChB,KAAKC,IAAL;;IACA,IAAIZ,EAAE,CAACa,WAAP,EAAoB,CAChB;IACH,CAFD,MAEO;MACHb,EAAE,CAACa,WAAH,GAAiB,CAAC,CAAlB;;MACAb,EAAE,CAACc,SAAH,CAAaC,SAAb,CAAuBC,YAAvB,GAAsC,UAAUC,CAAV,EAAa;QAC/C,IAAI,QAAQA,CAAR,IAAa,KAAKC,MAAtB,EAA8B;UAC1B,KAAKC,aAAL;UACA,KAAKC,UAAL,GAAkB,CAAC,CAAnB;;UACA,KAAKF,MAAL,CAAYG,GAAZ,CAAgB,IAAhB;QACH;MACJ,CAND;IAOH;EACJ,CAvBI;EAwBLC,SAAS,EAAE,qBAAY;IACnB,IAAI,KAAKC,OAAT,EAAkB;MACd,IAAIN,CAAC,GAAG,CAAR;;MACA,KAAK,IAAIO,CAAC,GAAG,KAAKC,IAAL,CAAUC,IAAV,EAAb,EAA+BT,CAAC,GAAGO,CAAnC,EAAsCP,CAAC,EAAvC,EAA2C;QACvC,KAAKQ,IAAL,CAAUE,GAAV,GAAgBC,OAAhB;MACH;IACJ;EACJ,CA/BI;EAgCLC,QAAQ,EAAE,oBAAY;IAClB,IAAI,KAAKN,OAAT,EAAkB,CACd;IACH,CAFD,MAEO;MACH,KAAKA,OAAL,GAAe,CAAC,CAAhB;;MACA,IAAI,KAAKnB,MAAT,EAAiB;QACb,KAAKA,MAAL,CAAYgB,UAAZ,GAAyB,CAAC,CAA1B;QACA,KAAKhB,MAAL,CAAY0B,MAAZ,GAAqB,CAAC,CAAtB;QACA,KAAK1B,MAAL,CAAY2B,QAAZ,GAAuB/B,EAAE,CAACgC,IAAH,CAAQC,IAA/B;MACH;;MACD,IAAI,KAAKzB,KAAL,CAAW0B,MAAX,GAAoB,CAAxB,EAA2B;QACvB,KAAKT,IAAL,GAAY,IAAIzB,EAAE,CAACmC,QAAP,CAAgB,KAAK3B,KAArB,CAAZ;MACH,CAFD,MAEO;QACH,KAAKiB,IAAL,GAAY,IAAIzB,EAAE,CAACmC,QAAP,EAAZ;MACH;IACJ;EACJ,CAhDI;EAiDLvB,IAAI,EAAE,gBAAY;IACd,IAAI,KAAKH,KAAL,IAAc,CAAlB,EAAqB;MACjB,KAAKoB,QAAL;MACA,IAAIZ,CAAC,GAAG,KAAKb,MAAL,IAAe,KAAKE,WAA5B;;MACA,KAAK,IAAIkB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKf,KAAzB,EAAgCe,CAAC,EAAjC,EAAqC;QACjC,IAAIY,CAAC,GAAGpC,EAAE,CAACqC,WAAH,CAAepB,CAAf,CAAR;QACAmB,CAAC,CAACjB,aAAF,GAAkB,CAAlB;QACAiB,CAAC,CAAChB,UAAF,GAAe,CAAC,CAAhB;QACAgB,CAAC,CAAClB,MAAF,GAAW,KAAKO,IAAhB;QACA,KAAKA,IAAL,CAAUJ,GAAV,CAAce,CAAd;MACH;IACJ;EACJ,CA7DI;EA8DLE,OAAO,EAAE,mBAAY;IACjB,KAAKT,QAAL;IACA,IAAIZ,CAAC,GAAG,IAAR;;IACA,IAAI,KAAKQ,IAAL,IAAa,KAAKA,IAAL,CAAUC,IAAV,KAAmB,CAApC,EAAuC;MACnCT,CAAC,GAAG,KAAKQ,IAAL,CAAUE,GAAV,EAAJ;IACH,CAFD,MAEO;MACH,CAACV,CAAC,GAAGjB,EAAE,CAACqC,WAAH,CAAe,KAAKjC,MAAL,IAAe,KAAKE,WAAnC,CAAL,EAAsDa,aAAtD,GAAsE,CAAtE;IACH;;IACDF,CAAC,CAACG,UAAF,GAAe,CAAC,CAAhB;IACAH,CAAC,CAACC,MAAF,GAAW,KAAKO,IAAhB;IACA,OAAOR,CAAP;EACH,CAzEI;EA0ELsB,iBAAiB,EAAE,2BAAUtB,CAAV,EAAa;IAC5B,OAAO,KAAKuB,OAAL,CAAa,KAAK9B,IAAL,CAAU+B,oBAAV,CAA+BxB,CAA/B,CAAb,CAAP;EACH,CA5EI;EA6ELuB,OAAO,EAAE,iBAAUvB,CAAV,EAAa;IAClB,OAAO,KAAKyB,SAAL,CAAe,KAAKhC,IAApB,EAA0BO,CAA1B,CAAP;EACH,CA/EI;EAgFLyB,SAAS,EAAE,mBAAUzB,CAAV,EAAaO,CAAb,EAAgB;IACvB,IAAIY,CAAC,GAAG,KAAKE,OAAL,EAAR;;IACA,IAAId,CAAJ,EAAO;MACHY,CAAC,CAACL,QAAF,GAAaP,CAAb;IACH;;IACDY,CAAC,CAACO,MAAF,GAAW1B,CAAX;IACAmB,CAAC,CAACN,MAAF,GAAW,CAAC,CAAZ;;IACAM,CAAC,CAACQ,kBAAF;;IACA,OAAOR,CAAP;EACH,CAzFI;EA0FLS,aAAa,EAAE,uBAAU5B,CAAV,EAAaO,CAAb,EAAgBY,CAAhB,EAAmB;IAC9B,IAAI,KAAK,CAAL,KAAWA,CAAf,EAAkB;MACdA,CAAC,GAAG,CAAJ;IACH;;IACD,IAAIU,CAAC,GAAG,KAAKR,OAAL,EAAR;IACAQ,CAAC,CAACH,MAAF,GAAW,KAAKjC,IAAhB;IACAoC,CAAC,CAAChB,MAAF,GAAW,CAAC,CAAZ;IACAgB,CAAC,CAACC,YAAF,CAAe,WAAf,EAA4BC,UAA5B,CAAuC/B,CAAvC,EAA0CO,CAA1C,EAA6CY,CAA7C;;IACAU,CAAC,CAACF,kBAAF;;IACA,OAAOE,CAAP;EACH,CApGI;EAqGLG,mBAAmB,EAAE,6BAAUhC,CAAV,EAAaO,CAAb,EAAgB;IACjC,IAAIY,CAAC,GAAG,KAAKE,OAAL,EAAR;IACAF,CAAC,CAACO,MAAF,GAAW,KAAKjC,IAAhB;IACA0B,CAAC,CAACN,MAAF,GAAW,CAAC,CAAZ;IACAM,CAAC,CAACW,YAAF,CAAe,iBAAf,EAAkCC,UAAlC,CAA6C/B,CAA7C,EAAgDO,CAAhD;;IACAY,CAAC,CAACQ,kBAAF;;IACA,OAAOR,CAAP;EACH;AA5GI,CAAT","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        prefab: cc.Node,\n        prefabAsset: cc.Prefab,\n        clazz: \"\",\n        count: 0,\n        root: cc.Node\n    },\n    onLoad: function () {\n        this.init();\n        if (cc.hasHackNode) {\n            //\n        } else {\n            cc.hasHackNode = !0;\n            cc._BaseNode.prototype._onSetParent = function (e) {\n                if (null == e && this.__pool) {\n                    this.__poolCounter++;\n                    this.__isInPool = !0;\n                    this.__pool.put(this);\n                }\n            };\n        }\n    },\n    onDestroy: function () {\n        if (this.hasInit) {\n            var e = 0;\n            for (var t = this.pool.size(); e < t; e++) {\n                this.pool.get().destroy();\n            }\n        }\n    },\n    lazyInit: function () {\n        if (this.hasInit) {\n            //\n        } else {\n            this.hasInit = !0;\n            if (this.prefab) {\n                this.prefab.__isInPool = !1;\n                this.prefab.active = !1;\n                this.prefab.position = cc.Vec2.ZERO;\n            }\n            if (this.clazz.length > 0) {\n                this.pool = new cc.NodePool(this.clazz);\n            } else {\n                this.pool = new cc.NodePool();\n            }\n        }\n    },\n    init: function () {\n        if (this.count >= 0) {\n            this.lazyInit();\n            var e = this.prefab || this.prefabAsset;\n            for (var t = 0; t < this.count; t++) {\n                var o = cc.instantiate(e);\n                o.__poolCounter = 0;\n                o.__isInPool = !0;\n                o.__pool = this.pool;\n                this.pool.put(o);\n            }\n        }\n    },\n    newNode: function () {\n        this.lazyInit();\n        var e = null;\n        if (this.pool && this.pool.size() > 0) {\n            e = this.pool.get();\n        } else {\n            (e = cc.instantiate(this.prefab || this.prefabAsset)).__poolCounter = 0;\n        }\n        e.__isInPool = !1;\n        e.__pool = this.pool;\n        return e;\n    },\n    addNodeByWorldPos: function (e) {\n        return this.addNode(this.root.convertToNodeSpaceAR(e));\n    },\n    addNode: function (e) {\n        return this.addNodeTo(this.root, e);\n    },\n    addNodeTo: function (e, t) {\n        var o = this.newNode();\n        if (t) {\n            o.position = t;\n        }\n        o.parent = e;\n        o.active = !0;\n        o._calculWorldMatrix();\n        return o;\n    },\n    addEffectNode: function (e, t, o) {\n        if (void 0 === o) {\n            o = 1;\n        }\n        var a = this.newNode();\n        a.parent = this.root;\n        a.active = !0;\n        a.getComponent(\"EffectFly\").initEffect(e, t, o);\n        a._calculWorldMatrix();\n        return a;\n    },\n    addBattleEffectNode: function (e, t) {\n        var o = this.newNode();\n        o.parent = this.root;\n        o.active = !0;\n        o.getComponent(\"EffectBattleNum\").initEffect(e, t);\n        o._calculWorldMatrix();\n        return o;\n    }\n});\n"]}